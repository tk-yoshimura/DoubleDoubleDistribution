using DoubleDouble;
using DoubleDoubleDistribution;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleDistributionTest.ContinuousDistribution {
    [TestClass()]
    public class BurrDistributionTests {
        readonly BurrDistribution dist_a1b1 = new(c: 1, k: 1);
        readonly BurrDistribution dist_a2b1 = new(c: 2, k: 1);
        readonly BurrDistribution dist_a1b2 = new(c: 1, k: 2);
        readonly BurrDistribution dist_a2b2 = new(c: 2, k: 2);
        readonly BurrDistribution dist_a3b4 = new(c: 3, k: 4);

        BurrDistribution[] Dists => new[]{
            dist_a1b1,
            dist_a2b1,
            dist_a1b2,
            dist_a2b2,
            dist_a3b4,
        };

        [TestMethod()]
        public void InfoTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"C={dist.C}");
                Console.WriteLine($"K={dist.K}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                /* TODO: implement entropy */
                //Console.WriteLine($"Entropy={dist.Entropy}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (BurrDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                1.000000000000000000e+00,
                4.444444444444444198e-01,
                2.500000000000000000e-01,
                1.599999999999999756e-01,
                1.111111111111110911e-01,
                8.163265306122448328e-02,
                6.250000000000000000e-02,
                4.938271604938270637e-02,
                4.000000000000000777e-02,
                3.305785123966942241e-02,
                2.777777777777777971e-02,
                2.366863905325444078e-02,
                2.040816326530612429e-02,
                1.777777777777778123e-02,
                1.562500000000000694e-02,
                1.384083044982699004e-02,
                1.234567901234567486e-02,
                1.108033240997229572e-02,
                9.999999999999995004e-03,
                9.070294784580500841e-03,
                8.264462809917353867e-03,
                7.561436672967865834e-03,
                6.944444444444444059e-03,
                6.399999999999997705e-03,
                5.917159763313609329e-03,
                5.486968449931413361e-03,
                5.102040816326532807e-03,
                4.756242568370986495e-03,
                4.444444444444444441e-03,
                4.162330905306972292e-03,
                3.906250000000000867e-03,
                3.673094582185492101e-03,
                3.460207612456746643e-03,
                3.265306122448978412e-03,
                3.086419753086420883e-03,
                2.921840759678598441e-03,
                2.770083102493076099e-03,
                2.629848783694938540e-03,
                2.500000000000000486e-03,
                2.379535990481855719e-03,
                2.267573696145124777e-03,
                2.163331530557058464e-03,
                2.066115702479338033e-03,
                1.975308641975309556e-03,
                1.890359168241966025e-03,
                1.810774105930284530e-03,
                1.736111111111110581e-03,
                1.665972511453560215e-03,
                1.600000000000000510e-03,
                1.537870049980777105e-03,
                1.479289940828402115e-03,
                1.423994304022783769e-03,
                1.371742112482853123e-03,
                1.322314049586776523e-03,
                1.275510204081632985e-03,
                1.231148045552477640e-03,
                1.189060642092746407e-03,
                1.149095087618500063e-03,
                1.111111111111110893e-03,
                1.074979844127922505e-03,
                1.040582726326742856e-03,
                1.007810531620055745e-03,
                9.765625000000000000e-04,
                9.467455621301773972e-04,
                9.182736455463728084e-04,
                8.910670527957228158e-04,
                8.650519031141865522e-04,
                8.401596303297622801e-04,
                8.163265306122451451e-04,
                7.934933544931562248e-04,
                7.716049382716051123e-04,
                7.506098705197970442e-04,
                7.304601899196495017e-04,
                7.111111111111110368e-04,
                6.925207756232688080e-04,
                6.746500252993757130e-04,
                6.574621959237345265e-04,
                6.409229290177857015e-04,
                6.250000000000000130e-04,
                6.096631611034905541e-04,
                5.948839976204638213e-04,
                5.806357961968358107e-04,
                5.668934240362810857e-04,
                5.536332179930794151e-04,
                5.408328826392645077e-04,
                5.284713964856653469e-04,
                5.165289256198348335e-04,
                5.049867440979672901e-04,
                4.938271604938272805e-04,
                4.830334500664170316e-04,
                4.725897920604914520e-04,
                4.624812117007748497e-04,
                4.526935264825714578e-04,
                4.432132963988921108e-04,
                4.340277777777775911e-04,
                4.251248804336274566e-04,
                4.164931278633903790e-04,
                4.081216202428321967e-04,
                4.000000000000000734e-04,
                3.921184197627682207e-04,
                3.844675124951941678e-04,
                3.770383636535017385e-04,
                3.698224852071004746e-04,
                3.628117913832199079e-04,
                3.559985760056958879e-04,
                3.493754913092846732e-04,
                3.429355281207132266e-04,
                3.366719973066239244e-04,
                3.305785123966940224e-04,
                3.246489732976221574e-04,
                3.188775510204079210e-04,
                3.132586733495182482e-04,
                3.077870113881193558e-04,
                3.024574669187145293e-04,
                2.972651605231868186e-04,
                2.922054204105485760e-04,
                2.872737719046249616e-04,
                2.824659275474895263e-04,
                2.777777777777779402e-04,
                2.732053821460281979e-04,
                2.687449610319805719e-04,
                2.643928878313171575e-04,
                2.601456815816856599e-04,
                2.559999999999998258e-04,
                2.519526329050139363e-04,
                2.480004960009920796e-04,
                2.441406250000001626e-04,
                2.403701700618954512e-04,
                2.366863905325445390e-04,
                2.330866499621232096e-04,
                2.295684113865933647e-04,
                2.261292328565775965e-04,
                2.227667631989308666e-04,
                2.194787379972564878e-04,
                2.162629757785466109e-04,
                2.131173743939474301e-04,
                2.100399075824405429e-04,
                2.070286217069511358e-04,
                2.040816326530610694e-04,
                2.011971228811427798e-04,
                1.983733386232890291e-04,
                1.956085872169789825e-04,
                1.929012345679012239e-04,
                1.902497027348395856e-04,
                1.876524676299493966e-04,
                1.851080568281735861e-04,
                1.826150474799121857e-04,
                1.801720643214269643e-04,
                1.777777777777778947e-04,
                1.754309021534143566e-04,
                1.731301939058171749e-04,
                1.708744499978641709e-04,
                1.686625063248439011e-04,
                1.664932362122788559e-04,
                1.643655489809336045e-04,
                1.622783885756012953e-04,
                1.602307322544463983e-04,
                1.582215893358649144e-04,
                1.562500000000001388e-04,
                1.543150341422013026e-04,
                1.524157902758724759e-04,
                1.505513944822914124e-04,
                1.487209994051159282e-04,
                1.469237832874197643e-04,
                1.451589490492087900e-04,
                1.434257234034923582e-04,
                1.417233560090703527e-04,
                1.400511186583103143e-04,
                1.384083044982698267e-04,
                1.367942272836085514e-04,
                1.352082206598162353e-04,
                1.336496374753582881e-04,
                1.321178491214163096e-04,
                1.306122448979590920e-04,
                1.291322314049585728e-04,
                1.276772319576112717e-04,
                1.262466860244919038e-04,
                1.248400486876190176e-04,
                1.234567901234567930e-04,
                1.220963951039344918e-04,
                1.207583625166043528e-04,
                1.194422049031024327e-04,
                1.181474480151228359e-04,
                1.168736303871438156e-04,
                1.156203029251935905e-04,
                1.143870285109668225e-04,
                1.131733816206428373e-04,
                1.119789479577839160e-04,
                1.108033240997230006e-04,
                1.096461171568762009e-04,
                1.085069444444444791e-04,
                1.073854331659910481e-04,
                1.062812201084068506e-04,
                1.051939513477975172e-04,
                1.041232819658474863e-04,
                1.030688757762374965e-04,
                1.020304050607081169e-04,
                1.010075503143860514e-04,
                9.999999999999990992e-05,
                9.900745031063590306e-05,
                9.802960494069204163e-05,
                9.706617486471406681e-05,
                9.611687812379860970e-05,
                9.518143961927420706e-05,
                9.425959091337542106e-05,
                9.335107003664036779e-05,
                9.245562130177518642e-05,
                9.157299512373803416e-05,
                9.070294784580504473e-05,
                8.984524157139326479e-05,
                8.899964400142403975e-05,
                8.816592827701729958e-05,
                8.734387282732123607e-05,
                8.653326122228239116e-05,
                8.573388203017829310e-05,
                8.494552867973409937e-05,
                8.416799932665604885e-05,
                8.340109672442191186e-05,
                8.264462809917349204e-05,
                8.189840502856199377e-05,
                8.116224332440552579e-05,
                8.043596291902108792e-05,
                7.971938775510210222e-05,
                7.901234567901236001e-05,
                7.831466833737954849e-05,
                7.762619107686931157e-05,
                7.694675284702982539e-05,
                7.627619610610014895e-05,
                7.561436672967861876e-05,
                7.496111392215293681e-05,
                7.431629013079669110e-05,
                7.367975096244168312e-05,
                7.305135510263713046e-05,
                7.243096423721142078e-05,
                7.181844297615622684e-05,
                7.121365877975393069e-05,
                7.061648188687236801e-05,
                7.002678524535631104e-05,
                6.944444444444447149e-05,
                6.886933764914519613e-05,
                6.830134553650703592e-05,
                6.774035123372118322e-05,
                6.718624025799514298e-05,
                6.663890045814239776e-05,
                6.609822195782939780e-05,
                6.556409710042778013e-05,
                6.503642039542141496e-05,
                6.451508846631509911e-05,
                6.399999999999995645e-05,
                6.349105569752855859e-05,
                6.298815822625347053e-05,
                6.249121217328812991e-05,
                6.200012400024800636e-05,
                6.151480199923101751e-05,
                6.103515625000002711e-05,
                6.056109857832818374e-05,

            ];
            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                6.400000000000000133e-01,
                5.000000000000000000e-01,
                2.840236686390532062e-01,
                1.600000000000000311e-01,
                9.512485136741975766e-02,
                5.999999999999997002e-02,
                3.987184051263795853e-02,
                2.768166089965396967e-02,
                1.993079584775086718e-02,
                1.479289940828402462e-02,
                1.126399999999999624e-02,
                8.765522279035799225e-03,
                6.949781148718628919e-03,
                5.599999999999997341e-03,
                4.576571766366012081e-03,
                3.786982248520713926e-03,
                3.168353737376089496e-03,
                2.676977989292088876e-03,
                2.281854006380184402e-03,
                1.960592098813841375e-03,
                1.696755460169170658e-03,
                1.478097285675893362e-03,
                1.295368704877695575e-03,
                1.141498216409036863e-03,
                1.011017563902628707e-03,
                8.996539792387534939e-04,
                8.040365613291921643e-04,
                7.214821304336625296e-04,
                6.498371905745601532e-04,
                5.873600125303468644e-04,
                5.326317485033155250e-04,
                4.844887886266256325e-04,
                4.419708215551175273e-04,
                4.042806183115340516e-04,
                3.707526477366542613e-04,
                3.408284023668639996e-04,
                3.140368643206910412e-04,
                2.899789383718442927e-04,
                2.683149690943291096e-04,
                2.487546719236818525e-04,
                2.310489658269421329e-04,
                2.149833131999754742e-04,
                2.003722613728005039e-04,
                1.870549473907960505e-04,
                1.748913790938246536e-04,
                1.637593449626201843e-04,
                1.535518356897347598e-04,
                1.441748841344549985e-04,
                1.355457488513622311e-04,
                1.275913809470343666e-04,
                1.202471255263575401e-04,
                1.134556181258440655e-04,
                1.071658438191783441e-04,
                1.013323325201726497e-04,
                9.591446870850418199e-05,
                9.087589760233672322e-05,
                8.618401288450990613e-05,
                8.180951360012632498e-05,
                7.772601989670843399e-05,
                7.390973896312034964e-05,
                7.033917391108513676e-05,
                6.699486948967192852e-05,
                6.385918947357293934e-05,
                6.091612135633539223e-05,
                5.815110463894274654e-05,
                5.555087955559294508e-05,
                5.310335354117379718e-05,
                5.079748313411510020e-05,
                4.862316933657350262e-05,
                4.657116473152383718e-05,
                4.463299089168732862e-05,
                4.280086481525180382e-05,
                4.106763329374125802e-05,
                3.942671426288023079e-05,
                3.787204431180670529e-05,
                3.639803163276299783e-05,
                3.499951378516363956e-05,
                3.367171972696546809e-05,
                3.241023563446431596e-05,
                3.121097409059999799e-05,
                3.007014627293182139e-05,
                2.898423681676732288e-05,
                2.794998106746576064e-05,
                2.696434446950059707e-05,
                2.602450386914527714e-05,
                2.512783053323594008e-05,
                2.427187470886172030e-05,
                2.345435156846976694e-05,
                2.267312840211367026e-05,
                2.192621293373703517e-05,
                2.121174265173735864e-05,
                2.052797505583273127e-05,
                1.987327873265749354e-05,
                1.924612518171207436e-05,
                1.864508132144218329e-05,
                1.806880261244770208e-05,
                1.751602674123949179e-05,
                1.698556781366624443e-05,
                1.647631101221393410e-05,
                1.598720767590601778e-05,
                1.551727076557229379e-05,
                1.506557068086337365e-05,
                1.463123139861547485e-05,
                1.421342690506046356e-05,
                1.381137789696630015e-05,
                1.342434872911942783e-05,
                1.305164458764729047e-05,
                1.269260887055877199e-05,
                1.234662075857028251e-05,
                1.201309296080802210e-05,
                1.169146962135206376e-05,
                1.138122437382687757e-05,
                1.108185853236511490e-05,
                1.079289940828405335e-05,
                1.051389874273253964e-05,
                1.024443124639844659e-05,
                9.984093238118709208e-06,
                9.732501374922010291e-06,
                9.489291466652488216e-06,
                9.254117368890924024e-06,
                9.026649948403312650e-06,
                8.806576115814856241e-06,
                8.593597920635750163e-06,
                8.387431704153624001e-06,
                8.187807306063168980e-06,
                7.994467321028620192e-06,
                7.807166401671892755e-06,
                7.625670604749616732e-06,
                7.449756777532635104e-06,
                7.279211981627712252e-06,
                7.113832951691703376e-06,
                6.953425586678165551e-06,
                6.797804471434139295e-06,
                6.646792426624866253e-06,
                6.500220085113706496e-06,
                6.357925493060626997e-06,
                6.219753734128605255e-06,
                6.085556575302753653e-06,
                5.955192132934136742e-06,
                5.828524557718037673e-06,
                5.705423737407872267e-06,
                5.585765016149151592e-06,
                5.469428929395458408e-06,
                5.356300953440169389e-06,
                5.246271268663556744e-06,
                5.139234535656079833e-06,
                5.035089683435407366e-06,
                4.933739709027364911e-06,
                4.835091487729150334e-06,
                4.739055593418847027e-06,
                4.645546128316579697e-06,
                4.554480561641760733e-06,
                4.465779576646983360e-06,
                4.379366925542235905e-06,
                4.295169291854795649e-06,
                4.213116159798632862e-06,
                4.133139690254311535e-06,
                4.055174602985574218e-06,
                3.979158064741786009e-06,
                3.905029582917695652e-06,
                3.832730904461629607e-06,
                3.762205919742768839e-06,
                3.693400571105378659e-06,
                3.626262765854544269e-06,
                3.560742293433191344e-06,
                3.496790746564829753e-06,
                3.434361446149409631e-06,
                3.373409369712795765e-06,
                3.313891083221707586e-06,
                3.255764676087041106e-06,
                3.198989699188860607e-06,
                3.143527105766104474e-06,
                3.089339195022604549e-06,
                3.036389558310017743e-06,
                2.984643027755946510e-06,
                2.934065627212798321e-06,
                2.884624525410385989e-06,
                2.836287991201262241e-06,
                2.789025350794312506e-06,
                2.742806946877813509e-06,
                2.697604099538524021e-06,
                2.653389068888450343e-06,
                2.610135019316057939e-06,
                2.567815985282505891e-06,
                2.526406838588644376e-06,
                2.485883257041667171e-06,
                2.446221694454617513e-06,
                2.407399351915292261e-06,
                2.369394150264371989e-06,
                2.332184703725880531e-06,
                2.295750294636001473e-06,
                2.260070849218912486e-06,
                2.225126914361331228e-06,
                2.190899635339434170e-06,
                2.157370734454624834e-06,
                2.124522490536524858e-06,
                2.092337719273912235e-06,
                2.060799754336015414e-06,
                2.029892429248739481e-06,
                1.999600059991998600e-06,
                1.969907428286008962e-06,
                1.940799765536015164e-06,
                1.912262737406496327e-06,
                1.884282428997076683e-06,
                1.856845330593966245e-06,
                1.829938323971922706e-06,
                1.803548669222888689e-06,
                1.777663992088574420e-06,
                1.752272271775545735e-06,
                1.727361829232087763e-06,
                1.702921315867376095e-06,
                1.678939702694148743e-06,
                1.655406269877187575e-06,
                1.632310596670542755e-06,
                1.609642551727388162e-06,
                1.587392283766950745e-06,
                1.565550212583889789e-06,
                1.544107020385980437e-06,
                1.523053643446727032e-06,
                1.502381264060025853e-06,
                1.482081302784673011e-06,
                1.462145410967054683e-06,
                1.442565463530776612e-06,
                1.423333552022602169e-06,
                1.404441977904492029e-06,
                1.385883246081966679e-06,
                1.367650058659520333e-06,
                1.349735308914065376e-06,
                1.332132075478046669e-06,
                1.314833616723807510e-06,
                1.297833365341698490e-06,
                1.281124923104200502e-06,
                1.264702055809051228e-06,
                1.248558688394433872e-06,
                1.232688900219786245e-06,
                1.217086920505785554e-06,
                1.201747123927646784e-06,
                1.186664026355827483e-06,
                1.171832280738716641e-06,
                1.157246673121948728e-06,
                1.142902118799293698e-06,
                1.128793658590221418e-06,
                1.114916455239471658e-06,
                1.101265789934226980e-06,
                1.087837058934427849e-06,
                1.074625770312284044e-06,
                1.061627540796894401e-06,
                1.048838092720240083e-06,
                1.036253251060875271e-06,
                1.023868940581838620e-06,
                1.011681183059373642e-06,
                9.996860945992892495e-07,
                9.878798830378217961e-07,
                9.762588454240164090e-07,
                9.648193655807513113e-07,

            ];
            ddouble[] expected_dist_a1b2 = [
                2.000000000000000000e+00,
                5.925925925925925597e-01,
                2.500000000000000555e-01,
                1.280000000000000027e-01,
                7.407407407407406996e-02,
                4.664723032069970077e-02,
                3.125000000000001388e-02,
                2.194787379972565691e-02,
                1.600000000000001074e-02,
                1.202103681442524309e-02,
                9.259259259259257011e-03,
                7.282658170232133958e-03,
                5.830903790087466933e-03,
                4.740740740740744148e-03,
                3.906250000000004337e-03,
                3.256665988194586223e-03,
                2.743484224965706247e-03,
                2.332701559994166448e-03,
                1.999999999999998741e-03,
                1.727675197062951808e-03,
                1.502629601803155170e-03,
                1.315032464863976789e-03,
                1.157407407407406909e-03,
                1.023999999999999520e-03,
                9.103322712790165279e-04,
                8.128842148046539276e-04,
                7.288629737609338003e-04,
                6.560334577063432976e-04,
                5.925925925925929101e-04,
                5.370749555234808834e-04,
                4.882812500000004337e-04,
                4.452235857194534780e-04,
                4.070832485243227900e-04,
                3.731778425655971347e-04,
                3.429355281207138229e-04,
                3.158746767220106276e-04,
                2.915876949992712397e-04,
                2.697280803789679163e-04,
                2.500000000000000052e-04,
                2.321498527299369443e-04,
                2.159593996328689218e-04,
                2.012401423774007401e-04,
                1.878287002253943420e-04,
                1.755829903978053529e-04,
                1.643790581079970716e-04,
                1.541084345472583069e-04,
                1.446759259259258095e-04,
                1.359977560370253082e-04,
                1.280000000000001297e-04,
                1.206172588220218124e-04,
                1.137915339098770389e-04,
                1.074712682281346783e-04,
                1.016105268505817138e-04,
                9.616829451540183089e-05,
                9.110787172011669793e-05,
                8.639635407385815513e-05,
                8.200418221329289865e-05,
                7.790475170294921333e-05,
                7.407407407407410021e-05,
                7.049048158215892785e-05,
                6.713436944043497489e-05,
                6.398797026159080720e-05,
                6.103515625000002711e-05,
                5.826126536185709812e-05,
                5.565294821493166442e-05,
                5.319803300272974816e-05,
                5.088540606554042329e-05,
                4.870490610607312783e-05,
                4.664723032069971638e-05,
                4.470385095736096112e-05,
                4.286694101508913978e-05,
                4.112930797368748523e-05,
                3.948433459025131489e-05,
                3.792592592592590488e-05,
                3.644846187490889141e-05,
                3.504675456100652835e-05,
                3.371601004737103698e-05,
                3.245179387431824415e-05,
                3.124999999999999387e-05,
                3.010682277054273605e-05,
                2.901873159124216208e-05,
                2.798244800948608080e-05,
                2.699492495410860845e-05,
                2.605332790555668019e-05,
                2.515501779717508574e-05,
                2.429753547060530669e-05,
                2.347858752817432663e-05,
                2.269603344260526012e-05,
                2.194787379972566233e-05,
                2.123223956335898042e-05,
                2.054738226349962717e-05,
                1.989166501938817986e-05,
                1.926355431840731547e-05,
                1.866161247995334091e-05,
                1.808449074074072280e-05,
                1.753092290447948610e-05,
                1.699971950462819063e-05,
                1.648976243405382976e-05,
                1.600000000000001283e-05,
                1.552944236684232140e-05,
                1.507715735275272146e-05,
                1.464226654965055441e-05,
                1.422394173873462478e-05,
                1.382140157650362306e-05,
                1.343390852851683139e-05,
                1.306076603025364081e-05,
                1.270131585632271084e-05,
                1.235493568097702022e-05,
                1.202103681442524750e-05,
                1.169906210081522738e-05,
                1.138848396501456352e-05,
                1.108880259644312372e-05,
                1.079954425923224737e-05,
                1.052025971891182047e-05,
                1.025052277666160894e-05,
                9.989928902924737078e-06,
                9.738093962868633031e-06,
                9.494653026806360523e-06,
                9.259259259259276079e-06,
                9.031582880860435341e-06,
                8.811310197769847347e-06,
                8.598142693701367492e-06,
                8.391796180054383720e-06,
                8.191999999999985264e-06,
                7.998496282698862759e-06,
                7.811039244125737700e-06,
                7.629394531250015247e-06,
                7.453338606570396998e-06,
                7.282658170232135571e-06,
                7.117149617164059166e-06,
                6.956618526866469063e-06,
                6.800879183656470813e-06,
                6.649754125341216826e-06,
                6.503073718437234382e-06,
                6.360675758192540206e-06,
                6.222405091794091553e-06,
                6.088113263259150297e-06,
                5.957658178617301790e-06,
                5.830903790087452689e-06,
                5.707719798046603363e-06,
                5.587981369670108282e-06,
                5.471568873202211653e-06,
                5.358367626886150942e-06,
                5.248267661650748848e-06,
                5.141163496710944124e-06,
                5.036953927297242985e-06,
                4.935541823781404197e-06,
                4.836833941514822592e-06,
                4.740740740740745734e-06,
                4.647176215984483486e-06,
                4.556057734363610579e-06,
                4.467305882297103942e-06,
                4.380844320125814349e-06,
                4.296599644187841897e-06,
                4.214501255921371152e-06,
                4.134481237594939414e-06,
                4.056474234289786448e-06,
                3.980417341782765328e-06,
                3.906250000000005164e-06,
                3.833913891731708919e-06,
                3.763352846317841159e-06,
                3.694512748031688802e-06,
                3.627341448905263061e-06,
                3.561788685755635837e-06,
                3.497806001185752900e-06,
                3.435346668347118599e-06,
                3.374365619263581138e-06,
                3.314819376528058119e-06,
                3.256665988194584177e-06,
                3.199864965698444653e-06,
                3.144377224646890376e-06,
                3.090165028331980011e-06,
                3.037191933825662489e-06,
                2.985422740524778569e-06,
                2.934823441021784900e-06,
                2.885361174183304197e-06,
                2.837004180325661750e-06,
                2.789721758382548978e-06,
                2.743484224965706945e-06,
                2.698262875225069117e-06,
                2.654029945419876788e-06,
                2.610758577116992230e-06,
                2.568422782937452973e-06,
                2.526997413776081599e-06,
                2.486458127423517400e-06,
                2.446781358523352382e-06,
                2.407944289800909775e-06,
                2.369924824503363104e-06,
                2.332701559994171002e-06,
                2.296253762447669326e-06,
                2.260561342592593738e-06,
                2.225604832455773264e-06,
                2.191365363059935339e-06,
                2.157824643031744296e-06,
                2.124964938078519593e-06,
                2.092769051294164554e-06,
                2.061220304256732108e-06,
                2.030302518882132184e-06,
                1.999999999999997368e-06,
                1.970297518619620381e-06,
                1.941180295855285940e-06,
                1.912633987482053073e-06,
                1.884644669094089759e-06,
                1.857198821839496517e-06,
                1.830283318706318878e-06,
                1.803885411336048164e-06,
                1.777992717341830850e-06,
                1.752593208109819399e-06,
                1.727675197062952247e-06,
                1.703227328367643303e-06,
                1.679238566064606465e-06,
                1.655698183605958433e-06,
                1.632595753781707431e-06,
                1.609921139019209604e-06,
                1.587664482040338432e-06,
                1.565816196861456853e-06,
                1.544366960122129857e-06,
                1.523307702729168817e-06,
                1.502629601803152761e-06,
                1.482324072915148639e-06,
                1.462382762601900457e-06,
                1.442797541148360629e-06,
                1.423560495626822770e-06,
                1.404663923182440914e-06,
                1.386100324555390042e-06,
                1.367862397830294869e-06,
                1.349943032404033039e-06,
                1.332335303163320220e-06,
                1.315032464863974806e-06,
                1.298027946703947745e-06,
                1.281315347082703024e-06,
                1.264888428539771012e-06,
                1.248741112865591711e-06,
                1.232867476378067072e-06,
                1.217261745358580823e-06,
                1.201918291641416176e-06,
                1.186831628350796971e-06,
                1.171996405780021783e-06,
                1.157407407407407181e-06,
                1.143059546043904167e-06,
                1.128947860107554206e-06,
                1.115067510020103280e-06,
                1.101413774721232612e-06,
                1.087982048296203077e-06,
                1.074767836712672631e-06,
                1.061766754662797182e-06,
                1.048974522506795847e-06,
                1.036386963314299171e-06,
                1.023999999999999852e-06,
                1.011809652550254692e-06,
                9.998120353373559390e-07,
                9.880033545183894543e-07,
                9.763799055157167890e-07,
                9.649380705761733012e-07,
                9.536743164062500000e-07,
                9.425851918805950900e-07,

            ];
            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                1.023999999999999799e+00,
                5.000000000000001110e-01,
                1.747837960855712358e-01,
                6.400000000000001521e-02,
                2.624133830825374145e-02,
                1.199999999999999852e-02,
                6.018391020775544151e-03,
                3.256665988194583188e-03,
                1.875839609200080811e-03,
                1.137915339098769657e-03,
                7.208960000000003837e-04,
                4.738120150830156161e-04,
                3.213771629465264667e-04,
                2.240000000000002406e-04,
                1.598802363795985332e-04,
                1.165225307237140065e-04,
                8.650795187374988270e-05,
                6.529214608029466817e-05,
                5.001323849600410460e-05,
                3.882360591710576624e-05,
                3.050346894686153251e-05,
                2.423110304386712213e-05,
                1.944268224957141063e-05,
                1.574480298495223977e-05,
                1.285872895265664219e-05,
                1.058416446163239138e-05,
                8.775296713006195103e-06,
                7.324691679529563656e-06,
                6.152304762836050811e-06,
                5.197876217082704558e-06,
                4.415599987592261291e-06,
                3.770340767522374431e-06,
                3.234919096469292637e-06,
                2.788142195251951961e-06,
                2.413361417325658080e-06,
                2.097405553026854069e-06,
                1.829785079800092305e-06,
                1.602093582164883743e-06,
                1.407553936232547243e-06,
                1.240671680417365755e-06,
                1.096968383748094436e-06,
                9.727751728505690607e-07,
                8.650718245992477016e-07,
                7.713606077970964091e-07,
                6.895667978070971186e-07,
                6.179597923117744008e-07,
                5.550902329497862203e-07,
                4.997396330483712382e-07,
                4.508798298590012976e-07,
                4.076401947189586324e-07,
                3.692809996970660347e-07,
                3.351716931339556169e-07,
                3.047731071999383054e-07,
                2.776228288223905969e-07,
                2.533231263347745838e-07,
                2.315309493053163717e-07,
                2.119496166849310628e-07,
                1.943218850359299111e-07,
                1.784241489737925041e-07,
                1.640615737250168882e-07,
                1.510639976613910368e-07,
                1.392824729515007840e-07,
                1.285863367200057310e-07,
                1.188607245977274466e-07,
                1.100044542708779099e-07,
                1.019282193680603778e-07,
                9.455304436443178353e-08,
                8.780895960953351069e-08,
                8.163386247483488189e-08,
                7.597253626675984388e-08,
                7.077580319791856351e-08,
                6.599979154240827294e-08,
                6.160530027187882662e-08,
                5.755724709909511223e-08,
                5.382418804307219426e-08,
                5.037789845365123586e-08,
                4.719300695791495961e-08,
                4.424667506828583551e-08,
                4.151831626512639775e-08,
                3.898934926995638964e-08,
                3.664298098757870836e-08,
                3.446401523991354407e-08,
                3.243868396049991091e-08,
                3.055449798243696714e-08,
                2.880011494717974678e-08,
                2.716522219809296165e-08,
                2.564043281010084701e-08,
                2.421719315278240290e-08,
                2.288770059519357777e-08,
                2.164483014189238018e-08,
                2.048206894555209666e-08,
                1.939345777594022504e-08,
                1.837353864107941193e-08,
                1.741730785675304239e-08,
                1.652017394745123491e-08,
                1.567791983726484137e-08,
                1.488666885476642054e-08,
                1.414285413294442944e-08,
                1.344319103495271333e-08,
                1.278465227981291027e-08,
                1.216444548011550981e-08,
                1.157999283694340269e-08,
                1.102891276631711052e-08,
                1.050900325697631742e-08,
                1.001822678173274380e-08,
                9.554696604355457737e-09,
                9.116664341323528404e-09,
                8.702508653108523186e-09,
                8.310724953181502016e-09,
                7.939916034902849536e-09,
                7.588783527043937047e-09,
                7.256120098072613745e-09,
                6.940802337659183857e-09,
                6.641784251251720208e-09,
                6.358091310141398829e-09,
                6.088815005288812231e-09,
                5.833107858391111697e-09,
                5.590178848318200232e-09,
                5.359289215193762433e-09,
                5.139748608103824900e-09,
                4.930911545730706994e-09,
                4.732174162178850529e-09,
                4.542971212917867505e-09,
                4.362773318155336904e-09,
                4.191084423092024507e-09,
                4.027439456437600669e-09,
                3.871402170295365558e-09,
                3.722563146082316475e-09,
                3.580537952553972555e-09,
                3.444965443269134723e-09,
                3.315506181971070279e-09,
                3.191840985392772813e-09,
                3.073669573926011093e-09,
                2.960709321436459596e-09,
                2.852694096270222418e-09,
                2.749373186188377310e-09,
                2.650510300592821189e-09,
                2.555882643974284215e-09,
                2.465280055030955092e-09,
                2.378504206373405218e-09,
                2.295367860159063611e-09,
                2.215694175386409063e-09,
                2.139316062932753803e-09,
                2.066075584740671891e-09,
                1.995823393851749405e-09,
                1.928418212253682048e-09,
                1.863726343750670541e-09,
                1.801621219290613097e-09,
                1.741982972386093479e-09,
                1.684698042452489537e-09,
                1.629658804057555788e-09,
                1.576763220232560707e-09,
                1.525914518138468320e-09,
                1.477020885511713206e-09,
                1.429995186434658931e-09,
                1.384754695085825290e-09,
                1.341220846227014892e-09,
                1.299319001277018912e-09,
                1.258978228907823707e-09,
                1.220131099177534672e-09,
                1.182713490287098652e-09,
                1.146664407114531650e-09,
                1.111925810741844373e-09,
                1.078442458246703474e-09,
                1.046161752082910031e-09,
                1.015033598422304220e-09,
                9.850102738749973279e-10,
                9.560463000461375303e-10,
                9.280983254252984419e-10,
                9.011250141397849914e-10,
                8.750869411356103526e-10,
                8.499464933800469508e-10,
                8.256677767073405071e-10,
                8.022165279550927868e-10,
                7.795600320626709900e-10,
                7.576670438251247698e-10,
                7.365077140166294162e-10,
                7.160535196165747877e-10,
                6.962771978890490720e-10,
                6.771526840829062520e-10,
                6.586550525349662820e-10,
                6.407604609728203900e-10,
                6.234460978272604536e-10,
                6.066901323762564911e-10,
                5.904716675540946787e-10,
                5.747706952697508001e-10,
                5.595680540884931656e-10,
                5.448453891400439832e-10,
                5.305851141249813395e-10,
                5.167703752993308978e-10,
                5.033850173245988737e-10,
                4.904135508774906262e-10,
                4.778411219201310487e-10,
                4.656534825376060537e-10,
                4.538369632553333277e-10,
                4.423784467540930238e-10,
                4.312653429055047551e-10,
                4.204855650552996144e-10,
                4.100275074861744941e-10,
                3.998800239960005113e-10,
                3.900324075309512566e-10,
                3.804743708167046364e-10,
                3.711960279341948124e-10,
                3.621878767894417446e-10,
                3.534407824300302838e-10,
                3.449459611634165318e-10,
                3.366949654349314040e-10,
                3.286796694256407047e-10,
                3.208922553325931224e-10,
                3.133252002960422675e-10,
                3.059712639402353062e-10,
                2.988234764962455263e-10,
                2.918751274770779846e-10,
                2.851197548769508230e-10,
                2.785511348681372512e-10,
                2.721632719703304229e-10,
                2.659503896687640819e-10,
                2.599069214586737277e-10,
                2.540275022948776549e-10,
                2.483069604264147041e-10,
                2.427403095972439677e-10,
                2.373227415950416406e-10,
                2.320496191310838375e-10,
                2.269164690350894933e-10,
                2.219189757497863931e-10,
                2.170529751107229922e-10,
                2.123144483976510759e-10,
                2.076995166444666993e-10,
                2.032044351954310498e-10,
                1.988255884959633678e-10,
                1.945594851069728626e-10,
                1.904027529321845951e-10,
                1.863521346485262075e-10,
                1.824044833300849706e-10,
                1.785567582566818256e-10,
                1.748060208984972734e-10,
                1.711494310686833519e-10,
                1.675842432362420379e-10,
                1.641078029918550313e-10,
                1.607175436597383690e-10,
                1.574109830488825819e-10,
                1.541857203374159390e-10,
                1.510394330841072385e-10,
                1.479698743613341006e-10,
                1.449748700040884418e-10,
                1.420523159698987513e-10,
                1.392001758047488175e-10,
                1.364164782103450521e-10,
                1.336993147082817933e-10,
                1.310468373968820129e-10,
                1.284572567966825223e-10,
                1.259288397807251221e-10,
                1.234599075859992356e-10,
                1.210488339025442657e-10,
                1.186940430368914220e-10,

            ];
            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                1.664786871919931022e+00,
                3.750000000000000000e-01,
                1.684509549592431640e-02,
                8.128842148046525181e-04,
                5.905449955393933298e-05,
                6.275287082763137108e-06,
                9.041316811698900270e-07,
                1.654757832762808649e-07,
                3.662003619863498124e-08,
                9.446447801751298012e-09,
                2.763463132014930468e-09,
                8.978113214393875423e-10,
                3.187241160142492040e-10,
                1.220633017485942430e-10,
                4.991645317200599315e-11,
                2.161595335282018881e-11,
                9.844693674512067876e-12,
                4.688694800903561363e-12,
                2.324037624088251583e-12,
                1.194017958083854397e-12,
                6.336440605207058690e-13,
                3.462944188613299659e-13,
                1.943936222403038534e-13,
                1.118326900826667633e-13,
                6.580207177828390295e-14,
                3.953024538305210896e-14,
                2.420805275448889987e-14,
                1.509126250380894088e-14,
                9.565001765182222429e-15,
                6.156750784428641814e-15,
                4.020556100538156877e-15,
                2.661285033506638588e-15,
                1.784048389271500525e-15,
                1.210328690069560696e-15,
                8.303887910104651378e-16,
                5.757929911326442083e-16,
                4.032792226676438479e-16,
                2.851463845523200252e-16,
                2.034409918592019780e-16,
                1.463928565878885779e-16,
                1.062010996053044450e-16,
                7.764186381896985022e-17,
                5.718245336070150789e-17,
                4.241138669540170013e-17,
                3.166779917573517790e-17,
                2.379802480491862795e-17,
                1.799416596825648733e-17,
                1.368604707846663029e-17,
                1.046825990297184148e-17,
                8.050487194328770989e-18,
                6.223403300197378655e-18,
                4.835085724120667095e-18,
                3.774576246549360206e-18,
                2.960342721014836653e-18,
                2.332124950726174205e-18,
                1.845134043047301310e-18,
                1.465899728188447950e-18,
                1.169279243284896974e-18,
                9.362901531128702576e-19,
                7.525312013105295418e-19,
                6.070253133572644415e-19,
                4.913673972626950175e-19,
                3.990934258518440452e-19,
                3.252110254524106619e-19,
                2.658485512029731486e-19,
                2.179915222265646143e-19,
                1.792837783753601703e-19,
                1.478768112517367012e-19,
                1.223151155876863188e-19,
                1.014485919155160962e-19,
                8.436535149708173314e-20,
                7.033997253108310517e-20,
                5.879350518700079331e-20,
                4.926244511691668734e-20,
                4.137457906766816490e-20,
                3.483011568865161717e-20,
                2.938689567753283373e-20,
                2.484876153470102369e-20,
                2.105638288371249572e-20,
                1.787999651423651435e-20,
                1.521364424203772894e-20,
                1.297058613890471744e-20,
                1.107963892681802232e-20,
                9.482244768115588455e-21,
                8.130118366449393842e-21,
                6.983353262381663259e-21,
                6.008893753473789810e-21,
                5.179298723802978752e-21,
                4.471739146054350868e-21,
                3.867183120862367622e-21,
                3.349731806617412790e-21,
                2.906077053509359764e-21,
                2.525057437604325989e-21,
                2.197294040616812716e-21,
                1.914891006451397493e-21,
                1.671188834044374086e-21,
                1.460560698819666166e-21,
                1.278243957891048088e-21,
                1.120200485229119297e-21,
                9.830006793437070694e-22,
                8.637269480733619431e-22,
                7.598932504475729358e-22,
                6.693779018839594631e-22,
                5.903673559580346233e-22,
                5.213090872337852565e-22,
                4.608720339354163807e-22,
                4.079133315269273849e-22,
                3.614502904882311911e-22,
                3.206367532944428190e-22,
                2.847431144848303355e-22,
                2.531394099136339166e-22,
                2.252809817700420209e-22,
                2.006963087459019543e-22,
                1.789766590568896380e-22,
                1.597672805112763033e-22,
                1.427598886013331633e-22,
                1.276862523990918381e-22,
                1.143127102830695266e-22,
                1.024354743588497432e-22,
                9.187660480660470293e-23,
                8.248055406553501298e-23,
                7.411119638234295302e-23,
                6.664927132937786870e-23,
                5.999018086697145808e-23,
                5.404208873740175486e-23,
                4.872427872725423455e-23,
                4.396573486228899587e-23,
                3.970391210474285404e-23,
                3.588367077348250651e-23,
                3.245635184070073501e-23,
                2.937897359006145856e-23,
                2.661353294606845381e-23,
                2.412639718307750290e-23,
                2.188777376165142881e-23,
                1.987124777589044566e-23,
                1.805337797487122747e-23,
                1.641334358382587354e-23,
                1.493263522927857465e-23,
                1.359478419492338705e-23,
                1.238512502502483772e-23,
                1.129058716941520414e-23,
                1.029951194542983104e-23,
                9.401491591572305511e-24,
                8.587227617293964603e-24,
                7.848406023187587147e-24,
                7.177587284749516802e-24,
                6.568109268007226219e-24,
                6.014001482963627816e-24,
                5.509909286301716875e-24,
                5.051026822645749792e-24,
                4.633037647766465299e-24,
                4.252062110743089324e-24,
                3.904610688091562266e-24,
                3.587542563653551368e-24,
                3.298028835691691827e-24,
                3.033519808935407200e-24,
                2.791715895800056908e-24,
                2.570541708976013742e-24,
                2.368122978183808423e-24,
                2.182765968097838820e-24,
                2.012939113092193914e-24,
                1.857256618285673797e-24,
                1.714463805987963205e-24,
                1.583424012615999723e-24,
                1.463106863931861776e-24,
                1.352577776455009318e-24,
                1.250988550478179647e-24,
                1.157568935572502398e-24,
                1.071619063070428763e-24,
                9.925026519967258829e-25,
                9.196409054781590345e-25,
                8.525070239785496738e-25,
                7.906212699293182187e-25,
                7.335465255911381545e-25,
                6.808842924041816119e-25,
                6.322710857672364487e-25,
                5.873751842161127272e-25,
                5.458936964287969575e-25,
                5.075499134356977489e-25,
                4.720909169191122333e-25,
                4.392854175978840981e-25,
                4.089218004578321226e-25,
                3.808063560462653432e-25,
                3.547616792351125935e-25,
                3.306252188031330894e-25,
                3.082479629208873357e-25,
                2.874932471671347515e-25,
                2.682356730828475810e-25,
                2.503601264984585674e-25,
                2.337608859678129581e-25,
                2.183408126230593375e-25,
                2.040106136414925669e-25,
                1.906881722999298152e-25,
                1.782979382940296313e-25,
                1.667703726289058594e-25,
                1.560414419507398476e-25,
                1.460521576942348777e-25,
                1.367481558740522138e-25,
                1.280793137550824321e-25,
                1.199994000018000613e-25,
                1.124657552352535829e-25,
                1.054390002214242589e-25,
                9.888276918021743546e-26,
                9.276346594335368534e-26,
                8.705004090464036635e-26,
                8.171378690004372820e-26,
                7.672815232975206494e-26,
                7.206856999210987806e-26,
                6.771230024157115642e-26,
                6.363828721123410793e-26,
                5.982702695659010215e-26,
                5.626044648191864683e-26,
                5.292179270560372025e-26,
                4.979553050636322665e-26,
                4.686724907003667103e-26,
                4.412357582680240341e-26,
                4.155209733239966718e-26,
                3.914128650458613538e-26,
                3.688043567839818639e-26,
                3.475959499121559832e-26,
                3.276951565171334346e-26,
                3.090159768586840213e-26,
                2.914784178871102102e-26,
                2.750080494278939192e-26,
                2.595355949364523046e-26,
                2.449965539930325605e-26,
                2.313308539503776817e-26,
                2.184825283680828195e-26,
                2.063994200685988543e-26,
                1.950329068335157966e-26,
                1.843376479256263362e-26,
                1.742713497749360397e-26,
                1.647945493055886445e-26,
                1.558704135077103369e-26,
                1.474645539738729252e-26,
                1.395448552257059527e-26,
                1.320813157527979051e-26,
                1.250459007743240882e-26,
                1.184124058146305949e-26,
                1.121563302578210129e-26,
                1.062547601140078263e-26,
                1.006862592917249267e-26,
                9.543076872765409486e-27,
                9.046951277672046441e-27,
                8.578491231313506981e-27,
                8.136050403657890149e-27,
                7.718086551767426040e-27,
                7.323154555356268984e-27,
                6.949899943807373314e-27,
                6.597052878183375721e-27,
                6.263422554604556271e-27,
                5.947891997973623180e-27,
                5.649413217419271399e-27,
                5.367002697034600151e-27,
                5.099737197509115517e-27,

            ];

            foreach ((BurrDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                0.000000000000000000e+00,
                3.333333333333333148e-01,
                5.000000000000000000e-01,
                6.000000000000000888e-01,
                6.666666666666667407e-01,
                7.142857142857143016e-01,
                7.500000000000000000e-01,
                7.777777777777777901e-01,
                8.000000000000000444e-01,
                8.181818181818181213e-01,
                8.333333333333332593e-01,
                8.461538461538461453e-01,
                8.571428571428570953e-01,
                8.666666666666666963e-01,
                8.750000000000000000e-01,
                8.823529411764705621e-01,
                8.888888888888889506e-01,
                8.947368421052631637e-01,
                9.000000000000000222e-01,
                9.047619047619047672e-01,
                9.090909090909090606e-01,
                9.130434782608695121e-01,
                9.166666666666666297e-01,
                9.200000000000000400e-01,
                9.230769230769231282e-01,
                9.259259259259259300e-01,
                9.285714285714286031e-01,
                9.310344827586206629e-01,
                9.333333333333333481e-01,
                9.354838709677419928e-01,
                9.375000000000000000e-01,
                9.393939393939393367e-01,
                9.411764705882352811e-01,
                9.428571428571428381e-01,
                9.444444444444444198e-01,
                9.459459459459459429e-01,
                9.473684210526315264e-01,
                9.487179487179486781e-01,
                9.499999999999999556e-01,
                9.512195121951219079e-01,
                9.523809523809523281e-01,
                9.534883720930232842e-01,
                9.545454545454545858e-01,
                9.555555555555554914e-01,
                9.565217391304348116e-01,
                9.574468085106383475e-01,
                9.583333333333333703e-01,
                9.591836734693877098e-01,
                9.599999999999999645e-01,
                9.607843137254902244e-01,
                9.615384615384615641e-01,
                9.622641509433962348e-01,
                9.629629629629630205e-01,
                9.636363636363636243e-01,
                9.642857142857143016e-01,
                9.649122807017543879e-01,
                9.655172413793103869e-01,
                9.661016949152542166e-01,
                9.666666666666666741e-01,
                9.672131147540983243e-01,
                9.677419354838709964e-01,
                9.682539682539682557e-01,
                9.687500000000000000e-01,
                9.692307692307692291e-01,
                9.696969696969697239e-01,
                9.701492537313433084e-01,
                9.705882352941176405e-01,
                9.710144927536231707e-01,
                9.714285714285714191e-01,
                9.718309859154929953e-01,
                9.722222222222222099e-01,
                9.726027397260273988e-01,
                9.729729729729730270e-01,
                9.733333333333333837e-01,
                9.736842105263158187e-01,
                9.740259740259740173e-01,
                9.743589743589743390e-01,
                9.746835443037974445e-01,
                9.749999999999999778e-01,
                9.753086419753086433e-01,
                9.756097560975609539e-01,
                9.759036144578313587e-01,
                9.761904761904761640e-01,
                9.764705882352940902e-01,
                9.767441860465115866e-01,
                9.770114942528735913e-01,
                9.772727272727272929e-01,
                9.775280898876405056e-01,
                9.777777777777777457e-01,
                9.780219780219779890e-01,
                9.782608695652174058e-01,
                9.784946236559139976e-01,
                9.787234042553191182e-01,
                9.789473684210526772e-01,
                9.791666666666666297e-01,
                9.793814432989690344e-01,
                9.795918367346938549e-01,
                9.797979797979797789e-01,
                9.799999999999999822e-01,
                9.801980198019801804e-01,
                9.803921568627450567e-01,
                9.805825242718446688e-01,
                9.807692307692307265e-01,
                9.809523809523809090e-01,
                9.811320754716981174e-01,
                9.813084112149532690e-01,
                9.814814814814815103e-01,
                9.816513761467889898e-01,
                9.818181818181818121e-01,
                9.819819819819819440e-01,
                9.821428571428572063e-01,
                9.823008849557521849e-01,
                9.824561403508771384e-01,
                9.826086956521739024e-01,
                9.827586206896551380e-01,
                9.829059829059828557e-01,
                9.830508474576271638e-01,
                9.831932773109243184e-01,
                9.833333333333332815e-01,
                9.834710743801653443e-01,
                9.836065573770491621e-01,
                9.837398373983740063e-01,
                9.838709677419354982e-01,
                9.839999999999999858e-01,
                9.841269841269840724e-01,
                9.842519685039370358e-01,
                9.843750000000000000e-01,
                9.844961240310077244e-01,
                9.846153846153845590e-01,
                9.847328244274808906e-01,
                9.848484848484848619e-01,
                9.849624060150375948e-01,
                9.850746268656715987e-01,
                9.851851851851851638e-01,
                9.852941176470588758e-01,
                9.854014598540146164e-01,
                9.855072463768116409e-01,
                9.856115107913668849e-01,
                9.857142857142857650e-01,
                9.858156028368794122e-01,
                9.859154929577464976e-01,
                9.860139860139860435e-01,
                9.861111111111111605e-01,
                9.862068965517241104e-01,
                9.863013698630136439e-01,
                9.863945578231292366e-01,
                9.864864864864865135e-01,
                9.865771812080537106e-01,
                9.866666666666666918e-01,
                9.867549668874172619e-01,
                9.868421052631578538e-01,
                9.869281045751634451e-01,
                9.870129870129870087e-01,
                9.870967741935483541e-01,
                9.871794871794872250e-01,
                9.872611464968152895e-01,
                9.873417721518987777e-01,
                9.874213836477987449e-01,
                9.875000000000000444e-01,
                9.875776397515527716e-01,
                9.876543209876543772e-01,
                9.877300613496932113e-01,
                9.878048780487804770e-01,
                9.878787878787879118e-01,
                9.879518072289156239e-01,
                9.880239520958083999e-01,
                9.880952380952381375e-01,
                9.881656804733728316e-01,
                9.882352941176471006e-01,
                9.883040935672514626e-01,
                9.883720930232557933e-01,
                9.884393063583815087e-01,
                9.885057471264367956e-01,
                9.885714285714285454e-01,
                9.886363636363636465e-01,
                9.887005649717514055e-01,
                9.887640449438201973e-01,
                9.888268156424581123e-01,
                9.888888888888889284e-01,
                9.889502762430939509e-01,
                9.890109890109890500e-01,
                9.890710382513661081e-01,
                9.891304347826086474e-01,
                9.891891891891891886e-01,
                9.892473118279569988e-01,
                9.893048128342245562e-01,
                9.893617021276596146e-01,
                9.894179894179894186e-01,
                9.894736842105262831e-01,
                9.895287958115183136e-01,
                9.895833333333333703e-01,
                9.896373056994818285e-01,
                9.896907216494845727e-01,
                9.897435897435897800e-01,
                9.897959183673469274e-01,
                9.898477157360405787e-01,
                9.898989898989899450e-01,
                9.899497487437185494e-01,
                9.899999999999999911e-01,
                9.900497512437811398e-01,
                9.900990099009900902e-01,
                9.901477832512315391e-01,
                9.901960784313725839e-01,
                9.902439024390243816e-01,
                9.902912621359223344e-01,
                9.903381642512076866e-01,
                9.903846153846154188e-01,
                9.904306220095693281e-01,
                9.904761904761905100e-01,
                9.905213270142180226e-01,
                9.905660377358490587e-01,
                9.906103286384976281e-01,
                9.906542056074766345e-01,
                9.906976744186046790e-01,
                9.907407407407406996e-01,
                9.907834101382488878e-01,
                9.908256880733944394e-01,
                9.908675799086757996e-01,
                9.909090909090909616e-01,
                9.909502262443439236e-01,
                9.909909909909909720e-01,
                9.910313901345291221e-01,
                9.910714285714286031e-01,
                9.911111111111111649e-01,
                9.911504424778760924e-01,
                9.911894273127753729e-01,
                9.912280701754385692e-01,
                9.912663755458515080e-01,
                9.913043478260870067e-01,
                9.913419913419913021e-01,
                9.913793103448276245e-01,
                9.914163090128755851e-01,
                9.914529914529914834e-01,
                9.914893617021276473e-01,
                9.915254237288135819e-01,
                9.915611814345991482e-01,
                9.915966386554622147e-01,
                9.916317991631798945e-01,
                9.916666666666666963e-01,
                9.917012448132780378e-01,
                9.917355371900826722e-01,
                9.917695473251029181e-01,
                9.918032786885245811e-01,
                9.918367346938775642e-01,
                9.918699186991869476e-01,
                9.919028340080972006e-01,
                9.919354838709677491e-01,
                9.919678714859437862e-01,
                9.919999999999999929e-01,
                9.920318725099601664e-01,
                9.920634920634920917e-01,
                9.920948616600790970e-01,
                9.921259842519685179e-01,
                9.921568627450980671e-01,
                9.921875000000000000e-01,
                9.922178988326848526e-01,

            ];
            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                1.999999999999999833e-01,
                5.000000000000000000e-01,
                6.923076923076922906e-01,
                8.000000000000000444e-01,
                8.620689655172413257e-01,
                9.000000000000000222e-01,
                9.245283018867924696e-01,
                9.411764705882352811e-01,
                9.529411764705881804e-01,
                9.615384615384615641e-01,
                9.679999999999999716e-01,
                9.729729729729730270e-01,
                9.768786127167630173e-01,
                9.799999999999999822e-01,
                9.825327510917030160e-01,
                9.846153846153845590e-01,
                9.863481228668942169e-01,
                9.878048780487804770e-01,
                9.890410958904110039e-01,
                9.900990099009900902e-01,
                9.910112359550561356e-01,
                9.918032786885245811e-01,
                9.924953095684803106e-01,
                9.931034482758620552e-01,
                9.936406995230524508e-01,
                9.941176470588235503e-01,
                9.945429740791268403e-01,
                9.949238578680202894e-01,
                9.952662721893491549e-01,
                9.955752212389380462e-01,
                9.958549222797927758e-01,
                9.961089494163424263e-01,
                9.963403476669716596e-01,
                9.965517241379310276e-01,
                9.967453213995117745e-01,
                9.969230769230769118e-01,
                9.970866715222140853e-01,
                9.972375690607734322e-01,
                9.973770491803278793e-01,
                9.975062344139651316e-01,
                9.976261127596439682e-01,
                9.977375565610859809e-01,
                9.978413383702104955e-01,
                9.979381443298969145e-01,
                9.980285855101035386e-01,
                9.981132075471698117e-01,
                9.981924988703118062e-01,
                9.982668977469670857e-01,
                9.983367983367983367e-01,
                9.984025559105431658e-01,
                9.984644913627639395e-01,
                9.985228951255539220e-01,
                9.985780305723427341e-01,
                9.986301369863013200e-01,
                9.986794321558269960e-01,
                9.987261146496815289e-01,
                9.987703658161697362e-01,
                9.988123515439429889e-01,
                9.988522238163558553e-01,
                9.988901220865704644e-01,
                9.989261744966443368e-01,
                9.989604989604989882e-01,
                9.989932041278630770e-01,
                9.990243902439024382e-01,
                9.990541499172380657e-01,
                9.990825688073394772e-01,
                9.991097262408190627e-01,
                9.991356957649092374e-01,
                9.991605456453305223e-01,
                9.991843393148450714e-01,
                9.992071357779980234e-01,
                9.992289899768697081e-01,
                9.992499531220701003e-01,
                9.992700729927007641e-01,
                9.992893942085627756e-01,
                9.993079584775086399e-01,
                9.993258048204954891e-01,
                9.993429697766097464e-01,
                9.993594875900720931e-01,
                9.993753903810118633e-01,
                9.993907083015993731e-01,
                9.994054696789536063e-01,
                9.994197011460902447e-01,
                9.994334277620396945e-01,
                9.994466731221468558e-01,
                9.994594594594594650e-01,
                9.994718077380166932e-01,
                9.994837377387713051e-01,
                9.994952681388012961e-01,
                9.995064165844027571e-01,
                9.995171997585998724e-01,
                9.995276334435522214e-01,
                9.995377325782965894e-01,
                9.995475113122171962e-01,
                9.995569830546018331e-01,
                9.995661605206074274e-01,
                9.995750557739296882e-01,
                9.995836802664446186e-01,
                9.995920448750637011e-01,
                9.996001599360255785e-01,
                9.996080352768250687e-01,
                9.996156802459645885e-01,
                9.996231037406954067e-01,
                9.996303142329020508e-01,
                9.996373197932723054e-01,
                9.996441281138790380e-01,
                9.996507465292936434e-01,
                9.996571820363386873e-01,
                9.996634413125788932e-01,
                9.996695307336417313e-01,
                9.996754563894523216e-01,
                9.996812240994580323e-01,
                9.996868394269161628e-01,
                9.996923076923076579e-01,
                9.996976339859400262e-01,
                9.997028231797919773e-01,
                9.997078799386548420e-01,
                9.997128087306146327e-01,
                9.997176138369220366e-01,
                9.997222993612885356e-01,
                9.997268692386479527e-01,
                9.997313272434175113e-01,
                9.997356769972907120e-01,
                9.997399219765930045e-01,
                9.997440655192271208e-01,
                9.997481108312342712e-01,
                9.997520609929957391e-01,
                9.997559189650964129e-01,
                9.997596875938720151e-01,
                9.997633696166587924e-01,
                9.997669676667637617e-01,
                9.997704842781730550e-01,
                9.997739218900130176e-01,
                9.997772828507794918e-01,
                9.997805694223490525e-01,
                9.997837837837837416e-01,
                9.997869280349438448e-01,
                9.997900041999160381e-01,
                9.997930142302716705e-01,
                9.997959600081616216e-01,
                9.997988433492582816e-01,
                9.998016660055533134e-01,
                9.998044296680194121e-01,
                9.998071359691417248e-01,
                9.998097864853298100e-01,
                9.998123827392120244e-01,
                9.998149262018229955e-01,
                9.998174182946868438e-01,
                9.998198603918035943e-01,
                9.998222538215428834e-01,
                9.998245998684498481e-01,
                9.998268997749697462e-01,
                9.998291547430914195e-01,
                9.998313659359190364e-01,
                9.998335344791710044e-01,
                9.998356614626129346e-01,
                9.998377479414269908e-01,
                9.998397949375200655e-01,
                9.998418034407751120e-01,
                9.998437744102484093e-01,
                9.998457087753134243e-01,
                9.998476074367570465e-01,
                9.998494712678281937e-01,
                9.998513011152416752e-01,
                9.998530978001395342e-01,
                9.998548621190130881e-01,
                9.998565948445846674e-01,
                9.998582967266543831e-01,
                9.998599684929109221e-01,
                9.998616108497093702e-01,
                9.998632244828176141e-01,
                9.998648100581316589e-01,
                9.998663682223632998e-01,
                9.998678996036988176e-01,
                9.998694048124326939e-01,
                9.998708844415752361e-01,
                9.998723390674368883e-01,
                9.998737692501893370e-01,
                9.998751755344047476e-01,
                9.998765584495741265e-01,
                9.998779185106058121e-01,
                9.998792562183047572e-01,
                9.998805720598333835e-01,
                9.998818665091553370e-01,
                9.998831400274621473e-01,
                9.998843930635837873e-01,
                9.998856260543848018e-01,
                9.998868394251442249e-01,
                9.998880335899230642e-01,
                9.998892089519166859e-01,
                9.998903659037960967e-01,
                9.998915048280351270e-01,
                9.998926260972270663e-01,
                9.998937300743889756e-01,
                9.998948171132556739e-01,
                9.998958875585632899e-01,
                9.998969417463221543e-01,
                9.998979800040808108e-01,
                9.998990026511803686e-01,
                9.999000099990000834e-01,
                9.999010023511941680e-01,
                9.999019800039208317e-01,
                9.999029432460631028e-01,
                9.999038923594425476e-01,
                9.999048276190249940e-01,
                9.999057492931197055e-01,
                9.999066576435722276e-01,
                9.999075529259499051e-01,
                9.999084353897218502e-01,
                9.999093052784328028e-01,
                9.999101628298708855e-01,
                9.999110082762303620e-01,
                9.999118418442686229e-01,
                9.999126637554585084e-01,
                9.999134742261350794e-01,
                9.999142734676382815e-01,
                9.999150616864501684e-01,
                9.999158390843292388e-01,
                9.999166058584384453e-01,
                9.999173622014709828e-01,
                9.999181083017708582e-01,
                9.999188443434506857e-01,
                9.999195705065047068e-01,
                9.999202869669190363e-01,
                9.999209938967785760e-01,
                9.999216914643695997e-01,
                9.999223798342808944e-01,
                9.999230591675002389e-01,
                9.999237296215082171e-01,
                9.999243913503704784e-01,
                9.999250445048252223e-01,
                9.999256892323697965e-01,
                9.999263256773432973e-01,
                9.999269539810080598e-01,
                9.999275742816273738e-01,
                9.999281867145421998e-01,
                9.999287914122443333e-01,
                9.999293885044485686e-01,
                9.999299781181619773e-01,
                9.999305603777515206e-01,
                9.999311354050098855e-01,
                9.999317033192186566e-01,
                9.999322642372105996e-01,
                9.999328182734296133e-01,
                9.999333655399890164e-01,
                9.999339061467283907e-01,
                9.999344402012685373e-01,
                9.999349678090654336e-01,
                9.999354890734618584e-01,
                9.999360040957379070e-01,
                9.999365129751607295e-01,
                9.999370158090319372e-01,
                9.999375126927343427e-01,
                9.999380037197768134e-01,
                9.999384889818389022e-01,

            ];
            ddouble[] expected_dist_a1b2 = [
                0.000000000000000000e+00,
                5.555555555555555802e-01,
                7.500000000000000000e-01,
                8.400000000000000799e-01,
                8.888888888888889506e-01,
                9.183673469387755306e-01,
                9.375000000000000000e-01,
                9.506172839506172867e-01,
                9.599999999999999645e-01,
                9.669421487603305776e-01,
                9.722222222222222099e-01,
                9.763313609467455523e-01,
                9.795918367346938549e-01,
                9.822222222222222188e-01,
                9.843750000000000000e-01,
                9.861591695501730204e-01,
                9.876543209876543772e-01,
                9.889196675900276956e-01,
                9.899999999999999911e-01,
                9.909297052154194541e-01,
                9.917355371900826722e-01,
                9.924385633270321749e-01,
                9.930555555555555802e-01,
                9.936000000000000387e-01,
                9.940828402366863603e-01,
                9.945130315500685381e-01,
                9.948979591836735192e-01,
                9.952437574316289615e-01,
                9.955555555555555269e-01,
                9.958376690946930676e-01,
                9.960937500000000000e-01,
                9.963269054178145456e-01,
                9.965397923875431996e-01,
                9.967346938775509813e-01,
                9.969135802469135665e-01,
                9.970781592403213933e-01,
                9.972299168975069517e-01,
                9.973701512163050120e-01,
                9.975000000000000533e-01,
                9.976204640095180931e-01,
                9.977324263038548358e-01,
                9.978366684694429667e-01,
                9.979338842975206125e-01,
                9.980246913580247403e-01,
                9.981096408317580160e-01,
                9.981892258940696649e-01,
                9.982638888888888395e-01,
                9.983340274885464938e-01,
                9.983999999999999542e-01,
                9.984621299500192615e-01,
                9.985207100591716456e-01,
                9.985760056959772646e-01,
                9.986282578875171900e-01,
                9.986776859504131743e-01,
                9.987244897959183243e-01,
                9.987688519544475341e-01,
                9.988109393579072126e-01,
                9.988509049123814876e-01,
                9.988888888888889372e-01,
                9.989250201558720343e-01,
                9.989594172736732114e-01,
                9.989921894683799763e-01,
                9.990234375000000000e-01,
                9.990532544378698532e-01,
                9.990817263544535809e-01,
                9.991089329472042646e-01,
                9.991349480968858554e-01,
                9.991598403696702047e-01,
                9.991836734693877453e-01,
                9.992065066455068090e-01,
                9.992283950617284471e-01,
                9.992493901294802194e-01,
                9.992695398100803761e-01,
                9.992888888888888932e-01,
                9.993074792243766824e-01,
                9.993253499747005719e-01,
                9.993425378040762252e-01,
                9.993590770709822602e-01,
                9.993750000000000133e-01,
                9.993903368388965536e-01,
                9.994051160023795788e-01,
                9.994193642038031733e-01,
                9.994331065759637367e-01,
                9.994463667820069341e-01,
                9.994591671173607139e-01,
                9.994715286035142920e-01,
                9.994834710743801809e-01,
                9.994950132559020650e-01,
                9.995061728395061573e-01,
                9.995169665499336054e-01,
                9.995274102079395595e-01,
                9.995375187882992174e-01,
                9.995473064735174162e-01,
                9.995567867036011522e-01,
                9.995659722222222099e-01,
                9.995748751195663306e-01,
                9.995835068721365957e-01,
                9.995918783797571594e-01,
                9.996000000000000441e-01,
                9.996078815802372786e-01,
                9.996155324875047876e-01,
                9.996229616363464521e-01,
                9.996301775147928836e-01,
                9.996371882086168004e-01,
                9.996440014239943439e-01,
                9.996506245086906883e-01,
                9.996570644718792975e-01,
                9.996633280026934187e-01,
                9.996694214876032936e-01,
                9.996753510267023524e-01,
                9.996811224489795533e-01,
                9.996867413266504743e-01,
                9.996922129886118835e-01,
                9.996975425330812959e-01,
                9.997027348394768032e-01,
                9.997077945795894705e-01,
                9.997127262280953719e-01,
                9.997175340724525627e-01,
                9.997222222222221788e-01,
                9.997267946178539644e-01,
                9.997312550389679808e-01,
                9.997356071121686893e-01,
                9.997398543184182751e-01,
                9.997439999999999660e-01,
                9.997480473670949941e-01,
                9.997519995039989560e-01,
                9.997558593750000000e-01,
                9.997596298299381568e-01,
                9.997633136094674633e-01,
                9.997669133500378669e-01,
                9.997704315886134507e-01,
                9.997738707671434133e-01,
                9.997772332368011217e-01,
                9.997805212620027859e-01,
                9.997837370242214083e-01,
                9.997868826256059993e-01,
                9.997899600924176067e-01,
                9.997929713782930383e-01,
                9.997959183673469363e-01,
                9.997988028771188640e-01,
                9.998016266613767300e-01,
                9.998043914127829890e-01,
                9.998070987654320563e-01,
                9.998097502972651540e-01,
                9.998123475323700271e-01,
                9.998148919431718573e-01,
                9.998173849525200385e-01,
                9.998198279356785845e-01,
                9.998222222222221678e-01,
                9.998245690978465605e-01,
                9.998268698060941428e-01,
                9.998291255500021402e-01,
                9.998313374936751430e-01,
                9.998335067637876827e-01,
                9.998356344510190841e-01,
                9.998377216114243682e-01,
                9.998397692677455373e-01,
                9.998417784106641282e-01,
                9.998437500000000311e-01,
                9.998456849658577950e-01,
                9.998475842097240829e-01,
                9.998494486055177211e-01,
                9.998512790005948947e-01,
                9.998530762167125996e-01,
                9.998548410509507933e-01,
                9.998565742765964659e-01,
                9.998582766439909619e-01,
                9.998599488813416647e-01,
                9.998615916955017058e-01,
                9.998632057727163680e-01,
                9.998647917793401785e-01,
                9.998663503625246918e-01,
                9.998678821508786285e-01,
                9.998693877551020348e-01,
                9.998708677685950175e-01,
                9.998723227680423875e-01,
                9.998737533139755440e-01,
                9.998751599513123756e-01,
                9.998765432098765116e-01,
                9.998779036048960345e-01,
                9.998792416374834291e-01,
                9.998805577950968804e-01,
                9.998818525519849176e-01,
                9.998831263696128513e-01,
                9.998843796970747766e-01,
                9.998856129714890351e-01,
                9.998868266183793541e-01,
                9.998880210520422196e-01,
                9.998891966759002603e-01,
                9.998903538828430859e-01,
                9.998914930555555802e-01,
                9.998926145668339815e-01,
                9.998937187798916382e-01,
                9.998948060486522182e-01,
                9.998958767180341489e-01,
                9.998969311242237312e-01,
                9.998979695949392621e-01,
                9.998989924496856085e-01,
                9.999000000000000110e-01,
                9.999009925496893381e-01,
                9.999019703950593474e-01,
                9.999029338251352872e-01,
                9.999038831218761691e-01,
                9.999048185603807148e-01,
                9.999057404090866408e-01,
                9.999066489299633931e-01,
                9.999075443786982209e-01,
                9.999084270048762546e-01,
                9.999092970521541446e-01,
                9.999101547584285932e-01,
                9.999110003559985582e-01,
                9.999118340717230158e-01,
                9.999126561271727276e-01,
                9.999134667387776787e-01,
                9.999142661179698521e-01,
                9.999150544713202304e-01,
                9.999158320006733547e-01,
                9.999165989032755553e-01,
                9.999173553719008511e-01,
                9.999181015949714091e-01,
                9.999188377566755603e-01,
                9.999195640370809324e-01,
                9.999202806122449161e-01,
                9.999209876543210251e-01,
                9.999216853316625908e-01,
                9.999223738089231261e-01,
                9.999230532471529154e-01,
                9.999237238038939379e-01,
                9.999243856332703517e-01,
                9.999250388860778660e-01,
                9.999256837098692285e-01,
                9.999263202490376035e-01,
                9.999269486448973954e-01,
                9.999275690357627422e-01,
                9.999281815570238985e-01,
                9.999287863412202881e-01,
                9.999293835181131129e-01,
                9.999299732147546305e-01,
                9.999305555555555447e-01,
                9.999311306623508422e-01,
                9.999316986544635188e-01,
                9.999322596487663084e-01,
                9.999328137597419675e-01,
                9.999333610995418953e-01,
                9.999339017780422001e-01,
                9.999344359028995433e-01,
                9.999349635796045410e-01,
                9.999354849115337229e-01,
                9.999360000000000470e-01,
                9.999365089443025267e-01,
                9.999370118417737485e-01,
                9.999375087878267232e-01,
                9.999379998759997390e-01,
                9.999384851980007705e-01,
                9.999389648437500000e-01,
                9.999394389014216733e-01,

            ];
            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                3.599999999999999867e-01,
                7.500000000000000000e-01,
                9.053254437869822091e-01,
                9.599999999999999645e-01,
                9.809750297265160679e-01,
                9.899999999999999911e-01,
                9.943040227839088363e-01,
                9.965397923875431996e-01,
                9.977854671280277365e-01,
                9.985207100591716456e-01,
                9.989759999999999751e-01,
                9.992695398100803761e-01,
                9.994654014500985451e-01,
                9.996000000000000441e-01,
                9.996948952155756407e-01,
                9.997633136094674633e-01,
                9.998136262507425487e-01,
                9.998512790005948947e-01,
                9.998799024207167818e-01,
                9.999019703950593474e-01,
                9.999192021209443171e-01,
                9.999328137597419675e-01,
                9.999436796215270817e-01,
                9.999524375743162885e-01,
                9.999595592974438452e-01,
                9.999653979238753987e-01,
                9.999702208680989468e-01,
                9.999742327810559051e-01,
                9.999775918210146441e-01,
                9.999804213329156477e-01,
                9.999828183306934681e-01,
                9.999848597253554461e-01,
                9.999866069448013484e-01,
                9.999881093935790721e-01,
                9.999894070672075141e-01,
                9.999905325443787518e-01,
                9.999915125171805474e-01,
                9.999923689753059675e-01,
                9.999931201289975480e-01,
                9.999937811332019200e-01,
                9.999943646593700830e-01,
                9.999948813496857269e-01,
                9.999953401799680508e-01,
                9.999957487511956788e-01,
                9.999961135249090249e-01,
                9.999964400142399290e-01,
                9.999967329396661775e-01,
                9.999969963565805697e-01,
                9.999972337602275330e-01,
                9.999974481723810094e-01,
                9.999976422132249576e-01,
                9.999978181611899331e-01,
                9.999979780029467635e-01,
                9.999981234753236858e-01,
                9.999982561005689163e-01,
                9.999983772161142870e-01,
                9.999984879997739773e-01,
                9.999985894911448403e-01,
                9.999986826098322679e-01,
                9.999987681710172938e-01,
                9.999988468987883738e-01,
                9.999989194375888957e-01,
                9.999989863620718511e-01,
                9.999990481856038116e-01,
                9.999991053676209329e-01,
                9.999991583200067424e-01,
                9.999992074126337060e-01,
                9.999992529781892570e-01,
                9.999992953163864273e-01,
                9.999993346976466801e-01,
                9.999993713663254402e-01,
                9.999994055435442730e-01,
                9.999994374296808930e-01,
                9.999994672065639634e-01,
                9.999994950394092141e-01,
                9.999995210785311839e-01,
                9.999995454608598955e-01,
                9.999995683112855582e-01,
                9.999995897438527237e-01,
                9.999996098628238794e-01,
                9.999996287636262471e-01,
                9.999996465336973284e-01,
                9.999996632532401897e-01,
                9.999996789958991439e-01,
                9.999996938293662652e-01,
                9.999997078159240660e-01,
                9.999997210129343284e-01,
                9.999997334732776411e-01,
                9.999997452457483060e-01,
                9.999997563754118302e-01,
                9.999997669039268899e-01,
                9.999997768698363210e-01,
                9.999997863088307959e-01,
                9.999997952539874113e-01,
                9.999998037359860703e-01,
                9.999998117833061029e-01,
                9.999998194224046788e-01,
                9.999998266778794553e-01,
                9.999998335726160148e-01,
                9.999998401279232008e-01,
                9.999998463636557977e-01,
                9.999998522983266636e-01,
                9.999998579492097583e-01,
                9.999998633324336250e-01,
                9.999998684630676538e-01,
                9.999998733552006858e-01,
                9.999998780220131778e-01,
                9.999998824758438154e-01,
                9.999998867282499093e-01,
                9.999998907900640166e-01,
                9.999998946714449000e-01,
                9.999998983819252674e-01,
                9.999999019304555148e-01,
                9.999999053254438053e-01,
                9.999999085747935945e-01,
                9.999999116859374926e-01,
                9.999999146658697935e-01,
                9.999999175211747859e-01,
                9.999999202580549529e-01,
                9.999999228823552855e-01,
                9.999999253995871529e-01,
                9.999999278149498405e-01,
                9.999999301333502011e-01,
                9.999999323594217504e-01,
                9.999999344975415427e-01,
                9.999999365518467132e-01,
                9.999999385262487994e-01,
                9.999999404244483969e-01,
                9.999999422499474822e-01,
                9.999999440060616251e-01,
                9.999999456959316468e-01,
                9.999999473225333890e-01,
                9.999999488886881505e-01,
                9.999999503970714576e-01,
                9.999999518502216134e-01,
                9.999999532505478017e-01,
                9.999999546003377482e-01,
                9.999999559017639372e-01,
                9.999999571568911616e-01,
                9.999999583676817405e-01,
                9.999999595360018478e-01,
                9.999999606636266192e-01,
                9.999999617522452589e-01,
                9.999999628034655919e-01,
                9.999999638188188378e-01,
                9.999999647997634966e-01,
                9.999999657476892345e-01,
                9.999999666639208806e-01,
                9.999999675497215357e-01,
                9.999999684062960137e-01,
                9.999999692347938396e-01,
                9.999999700363121358e-01,
                9.999999708118981756e-01,
                9.999999715625523811e-01,
                9.999999722892303211e-01,
                9.999999729928451542e-01,
                9.999999736742695156e-01,
                9.999999743343379599e-01,
                9.999999749738486265e-01,
                9.999999755935651269e-01,
                9.999999761942179877e-01,
                9.999999767765066494e-01,
                9.999999773411007986e-01,
                9.999999778886417001e-01,
                9.999999784197436403e-01,
                9.999999789349954815e-01,
                9.999999794349614390e-01,
                9.999999799201823025e-01,
                9.999999803911769902e-01,
                9.999999808484431041e-01,
                9.999999812924579290e-01,
                9.999999817236796540e-01,
                9.999999821425480384e-01,
                9.999999825494853001e-01,
                9.999999829448970035e-01,
                9.999999833291726148e-01,
                9.999999837026862792e-01,
                9.999999840657978201e-01,
                9.999999844188527387e-01,
                9.999999847621836579e-01,
                9.999999850961099890e-01,
                9.999999854209391525e-01,
                9.999999857369671341e-01,
                9.999999860444783728e-01,
                9.999999863437468717e-01,
                9.999999866350361977e-01,
                9.999999869186005919e-01,
                9.999999871946843033e-01,
                9.999999874635230324e-01,
                9.999999877253437086e-01,
                9.999999879803649350e-01,
                9.999999882287976538e-01,
                9.999999884708450359e-01,
                9.999999887067029247e-01,
                9.999999889365603911e-01,
                9.999999891605995117e-01,
                9.999999893789963679e-01,
                9.999999895919203796e-01,
                9.999999897995355269e-01,
                9.999999900019996835e-01,
                9.999999901994655049e-01,
                9.999999903920803179e-01,
                9.999999905799865640e-01,
                9.999999907633214669e-01,
                9.999999909422179201e-01,
                9.999999911168042654e-01,
                9.999999912872045149e-01,
                9.999999914535384615e-01,
                9.999999916159221236e-01,
                9.999999917744675226e-01,
                9.999999919292829054e-01,
                9.999999920804730769e-01,
                9.999999922281396225e-01,
                9.999999923723803530e-01,
                9.999999925132904144e-01,
                9.999999926509616222e-01,
                9.999999927854829052e-01,
                9.999999929169403057e-01,
                9.999999930454172015e-01,
                9.999999931709943057e-01,
                9.999999932937497782e-01,
                9.999999934137594471e-01,
                9.999999935310965871e-01,
                9.999999936458323635e-01,
                9.999999937580356102e-01,
                9.999999938677732736e-01,
                9.999999939751098577e-01,
                9.999999940801083120e-01,
                9.999999941828293659e-01,
                9.999999942833320832e-01,
                9.999999943816737513e-01,
                9.999999944779097705e-01,
                9.999999945720942085e-01,
                9.999999946642791349e-01,
                9.999999947545152867e-01,
                9.999999948428520691e-01,
                9.999999949293369994e-01,
                9.999999950140167071e-01,
                9.999999950969360452e-01,
                9.999999951781388674e-01,
                9.999999952576675843e-01,
                9.999999953355633853e-01,
                9.999999954118664602e-01,
                9.999999954866156671e-01,
                9.999999955598487533e-01,
                9.999999956316025784e-01,
                9.999999957019127805e-01,
                9.999999957708141096e-01,
                9.999999958383403165e-01,
                9.999999959045242637e-01,
                9.999999959693977036e-01,
                9.999999960329917226e-01,
                9.999999960953364075e-01,
                9.999999961564612905e-01,
                9.999999962163946821e-01,

            ];
            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                3.757049230300259501e-01,
                9.375000000000000000e-01,
                9.972704706372345074e-01,
                9.998475842097240829e-01,
                9.999869095859321710e-01,
                9.999983730737193044e-01,
                9.999997301443707132e-01,
                9.999999439795524969e-01,
                9.999999861167866433e-01,
                9.999999960324919002e-01,
                9.999999987257999212e-01,
                9.999999995490160831e-01,
                9.999999998267291579e-01,
                9.999999999285887897e-01,
                9.999999999687282370e-01,
                9.999999999855612165e-01,
                9.999999999930153649e-01,
                9.999999999964787056e-01,
                9.999999999981580290e-01,
                9.999999999990040189e-01,
                9.999999999994451105e-01,
                9.999999999996823652e-01,
                9.999999999998135936e-01,
                9.999999999998880895e-01,
                9.999999999999313882e-01,
                9.999999999999571454e-01,
                9.999999999999727995e-01,
                9.999999999999823475e-01,
                9.999999999999884537e-01,
                9.999999999999923395e-01,
                9.999999999999947820e-01,
                9.999999999999964473e-01,
                9.999999999999975575e-01,
                9.999999999999983347e-01,
                9.999999999999987788e-01,
                9.999999999999991118e-01,
                9.999999999999993339e-01,
                9.999999999999995559e-01,
                9.999999999999996669e-01,
                9.999999999999997780e-01,
                9.999999999999997780e-01,
                9.999999999999998890e-01,
                9.999999999999998890e-01,
                9.999999999999998890e-01,
                9.999999999999998890e-01,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,

            ];

            foreach ((BurrDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} cdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}