using DoubleDouble;
using DoubleDoubleStatistic;
using DoubleDoubleStatistic.InternalUtils;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleStatisticTest.ContinuousDistribution {
    [TestClass()]
    public class BetaDistributionTests {
        readonly BetaDistribution dist_a1b1 = new(alpha: 1, beta: 1);
        readonly BetaDistribution dist_a2b1 = new(alpha: 2, beta: 1);
        readonly BetaDistribution dist_a1b2 = new(alpha: 1, beta: 2);
        readonly BetaDistribution dist_a2b2 = new(alpha: 2, beta: 2);
        readonly BetaDistribution dist_a3b4 = new(alpha: 3, beta: 4);

        BetaDistribution[] Dists => [
            dist_a1b1,
            dist_a1b2,
            dist_a2b1,
            dist_a2b2,
            dist_a3b4,
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"Alpha={dist.Alpha}");
                Console.WriteLine($"Beta={dist.Beta}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
                Console.WriteLine(dist.Formula);
            }
        }

        [TestMethod()]
        public void MeanTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Mean;
                ddouble expected = IntegrationStatistics.Mean(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void ModeTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mode)) {
                    continue;
                }

                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode - 1e-4), $"{dist}\n{dist.Mode}");
                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode + 1e-4), $"{dist}\n{dist.Mode}");
            }
        }

        [TestMethod()]
        public void MedianTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.Abs(dist.CDF(dist.Median) - 0.5) < 1e-20, $"{dist}\n{dist.Median}");
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Variance;
                ddouble expected = IntegrationStatistics.Variance(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void SkewnessTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Skewness;
                ddouble expected = IntegrationStatistics.Skewness(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void KurtosisTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Kurtosis;
                ddouble expected = IntegrationStatistics.Kurtosis(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void EntropyTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Entropy;
                ddouble expected = IntegrationStatistics.Entropy(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 1; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 1; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 1; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }


        [TestMethod()]
        public void IrregularValueTest() {
            foreach (BetaDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.NegativeInfinity)) && dist.PDF(ddouble.NegativeInfinity) >= 0d, "pdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue)) && dist.PDF(ddouble.MinValue) >= 0d, "pdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue / 2)) && dist.PDF(ddouble.MinValue / 2) >= 0d, "pdf(-lval / 2)");

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.PositiveInfinity)) && dist.PDF(ddouble.PositiveInfinity) >= 0d, "pdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue)) && dist.PDF(ddouble.MaxValue) >= 0d, "pdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue / 2)) && dist.PDF(ddouble.MaxValue / 2) >= 0d, "pdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.PDF(ddouble.NaN)), "pdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Lower) == 0d, "cdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Lower)) && dist.CDF(ddouble.MinValue, Interval.Lower) >= 0d, "cdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Lower)) && dist.CDF(ddouble.MinValue / 2, Interval.Lower) >= 0d, "cdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Lower) == 1d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Lower)) && dist.CDF(ddouble.MaxValue, Interval.Lower) <= 1d, "cdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Lower)) && dist.CDF(ddouble.MaxValue / 2, Interval.Lower) <= 1d, "cdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Lower)), "cdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Upper) == 1d, "ccdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Upper)) && dist.CDF(ddouble.MinValue, Interval.Upper) <= 1d, "ccdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Upper)) && dist.CDF(ddouble.MinValue / 2, Interval.Upper) <= 1d, "ccdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Upper) == 0d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Upper)) && dist.CDF(ddouble.MaxValue, Interval.Upper) >= 0d, "ccdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Upper)) && dist.CDF(ddouble.MaxValue / 2, Interval.Upper) >= 0d, "ccdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Upper)), "ccdf(NaN)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(0d, Interval.Lower)), "quantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(1d, Interval.Lower)), "quantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(0d, Interval.Upper)), "cquantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(1d, Interval.Upper)), "cquantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.Epsilon, Interval.Lower)), "quantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)), "quantile(1-eps)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.Epsilon, Interval.Upper)), "cquantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)), "cquantile(1-eps)");
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
            ];
            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                7.812500000000001735e-03,
                1.562500000000000347e-02,
                2.343750000000000000e-02,
                3.124999999999999653e-02,
                3.906250000000000000e-02,
                4.687500000000000000e-02,
                5.468749999999999306e-02,
                6.250000000000000000e-02,
                7.031249999999998612e-02,
                7.812500000000000000e-02,
                8.593750000000000000e-02,
                9.374999999999997224e-02,
                1.015625000000000139e-01,
                1.093750000000000000e-01,
                1.171874999999999861e-01,
                1.250000000000000000e-01,
                1.328125000000000000e-01,
                1.406250000000000000e-01,
                1.484374999999999722e-01,
                1.562499999999999722e-01,
                1.640624999999999445e-01,
                1.718750000000001110e-01,
                1.796875000000000278e-01,
                1.875000000000000000e-01,
                1.953124999999998335e-01,
                2.031250000000000000e-01,
                2.109375000000000833e-01,
                2.187499999999999722e-01,
                2.265625000000000555e-01,
                2.343750000000000278e-01,
                2.421875000000000000e-01,
                2.499999999999999445e-01,
                2.578124999999999445e-01,
                2.656250000000001110e-01,
                2.734375000000000000e-01,
                2.812499999999998890e-01,
                2.890624999999999445e-01,
                2.968750000000001110e-01,
                3.046875000000000000e-01,
                3.125000000000001110e-01,
                3.203124999999999445e-01,
                3.281249999999998890e-01,
                3.359375000000000555e-01,
                3.437500000000001110e-01,
                3.515625000000001665e-01,
                3.593750000000000000e-01,
                3.671874999999999445e-01,
                3.750000000000000000e-01,
                3.828125000000000555e-01,
                3.906250000000001110e-01,
                3.984375000000000000e-01,
                4.062499999999999445e-01,
                4.140625000000001110e-01,
                4.218750000000000000e-01,
                4.296874999999999445e-01,
                4.374999999999998890e-01,
                4.453124999999999445e-01,
                4.531250000000000000e-01,
                4.609374999999999445e-01,
                4.687499999999997780e-01,
                4.765624999999998335e-01,
                4.843749999999999445e-01,
                4.921875000000000000e-01,
                5.000000000000000000e-01,
                5.078125000000001110e-01,
                5.156250000000000000e-01,
                5.234375000000000000e-01,
                5.312500000000001110e-01,
                5.390625000000001110e-01,
                5.468750000000000000e-01,
                5.546875000000000000e-01,
                5.624999999999997780e-01,
                5.703125000000000000e-01,
                5.781250000000000000e-01,
                5.859374999999998890e-01,
                5.937499999999998890e-01,
                6.015625000000000000e-01,
                6.093750000000001110e-01,
                6.171875000000001110e-01,
                6.249999999999998890e-01,
                6.328125000000001110e-01,
                6.406249999999998890e-01,
                6.484374999999997780e-01,
                6.562499999999998890e-01,
                6.640624999999998890e-01,
                6.718749999999998890e-01,
                6.796875000000000000e-01,
                6.875000000000000000e-01,
                6.953125000000000000e-01,
                7.031249999999998890e-01,
                7.109375000000000000e-01,
                7.187500000000001110e-01,
                7.265625000000000000e-01,
                7.343750000000000000e-01,
                7.421874999999997780e-01,
                7.499999999999998890e-01,
                7.578124999999998890e-01,
                7.656249999999998890e-01,
                7.734375000000001110e-01,
                7.812499999999998890e-01,
                7.890624999999998890e-01,
                7.968750000000000000e-01,
                8.046875000000000000e-01,
                8.125000000000001110e-01,
                8.203124999999998890e-01,
                8.281250000000000000e-01,
                8.359374999999998890e-01,
                8.437499999999998890e-01,
                8.515624999999998890e-01,
                8.593750000000000000e-01,
                8.671875000000000000e-01,
                8.749999999999998890e-01,
                8.828124999999998890e-01,
                8.906249999999996669e-01,
                8.984374999999997780e-01,
                9.062499999999998890e-01,
                9.140624999999998890e-01,
                9.218749999999998890e-01,
                9.296874999999996669e-01,
                9.375000000000001110e-01,
                9.453124999999997780e-01,
                9.531249999999997780e-01,
                9.609374999999996669e-01,
                9.687500000000000000e-01,
                9.765624999999996669e-01,
                9.843750000000000000e-01,
                9.921875000000002220e-01,
                1.000000000000000222e+00,
                1.007812500000000222e+00,
                1.015625000000000222e+00,
                1.023437500000000000e+00,
                1.031250000000000222e+00,
                1.039062500000000000e+00,
                1.046874999999999778e+00,
                1.054687500000000000e+00,
                1.062500000000000222e+00,
                1.070312500000000000e+00,
                1.078125000000000222e+00,
                1.085937499999999778e+00,
                1.093749999999999778e+00,
                1.101562499999999778e+00,
                1.109374999999999778e+00,
                1.117187499999999556e+00,
                1.124999999999999778e+00,
                1.132812499999999778e+00,
                1.140625000000000000e+00,
                1.148437499999999778e+00,
                1.156249999999999778e+00,
                1.164062499999999778e+00,
                1.171874999999999778e+00,
                1.179687500000000000e+00,
                1.187499999999999778e+00,
                1.195312500000000000e+00,
                1.203124999999999778e+00,
                1.210937500000000000e+00,
                1.218750000000000000e+00,
                1.226562500000000222e+00,
                1.234375000000000000e+00,
                1.242187500000000000e+00,
                1.250000000000000000e+00,
                1.257812500000000000e+00,
                1.265625000000000222e+00,
                1.273437500000000222e+00,
                1.281249999999999778e+00,
                1.289062499999999778e+00,
                1.296874999999999778e+00,
                1.304687499999999778e+00,
                1.312499999999999778e+00,
                1.320312499999999556e+00,
                1.328124999999999778e+00,
                1.335937500000000000e+00,
                1.343750000000000000e+00,
                1.351562499999999778e+00,
                1.359375000000000000e+00,
                1.367187499999999778e+00,
                1.374999999999999778e+00,
                1.382812500000000222e+00,
                1.390625000000000000e+00,
                1.398437499999999778e+00,
                1.406249999999999778e+00,
                1.414062500000000000e+00,
                1.421875000000000222e+00,
                1.429687500000000222e+00,
                1.437499999999999778e+00,
                1.445312500000000222e+00,
                1.453125000000000222e+00,
                1.460937500000000222e+00,
                1.468750000000000222e+00,
                1.476562499999999778e+00,
                1.484375000000000000e+00,
                1.492187499999999556e+00,
                1.499999999999999778e+00,
                1.507812499999999778e+00,
                1.515624999999999778e+00,
                1.523437499999999778e+00,
                1.531249999999999778e+00,
                1.539062499999999778e+00,
                1.546875000000000222e+00,
                1.554687500000000000e+00,
                1.562499999999999556e+00,
                1.570312500000000000e+00,
                1.578125000000000000e+00,
                1.585937500000000000e+00,
                1.593749999999999778e+00,
                1.601562500000000222e+00,
                1.609375000000000222e+00,
                1.617187500000000000e+00,
                1.624999999999999778e+00,
                1.632812500000000000e+00,
                1.640624999999999778e+00,
                1.648437500000000444e+00,
                1.656250000000000000e+00,
                1.664062500000000222e+00,
                1.671875000000000000e+00,
                1.679687500000000000e+00,
                1.687500000000000000e+00,
                1.695312499999999556e+00,
                1.703124999999999778e+00,
                1.710937499999999778e+00,
                1.718750000000000000e+00,
                1.726562500000000000e+00,
                1.734375000000000222e+00,
                1.742187500000000222e+00,
                1.750000000000000000e+00,
                1.757812500000000222e+00,
                1.765624999999999556e+00,
                1.773437499999999778e+00,
                1.781250000000000000e+00,
                1.789062500000000222e+00,
                1.796874999999999334e+00,
                1.804687499999999778e+00,
                1.812499999999999556e+00,
                1.820312499999999778e+00,
                1.828125000000000222e+00,
                1.835937499999999556e+00,
                1.843749999999999778e+00,
                1.851562500000000222e+00,
                1.859375000000000888e+00,
                1.867187500000000000e+00,
                1.875000000000000666e+00,
                1.882812499999999556e+00,
                1.890625000000000444e+00,
                1.898437499999999556e+00,
                1.906249999999999778e+00,
                1.914062499999999778e+00,
                1.921875000000000444e+00,
                1.929687499999999778e+00,
                1.937500000000000222e+00,
                1.945312499999999556e+00,
                1.953124999999999556e+00,
                1.960937499999999778e+00,
                1.968749999999999778e+00,
                1.976562500000000888e+00,
                1.984375000000000222e+00,
                1.992187500000000222e+00,
                2.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a1b2 = [
                2.000000000000000000e+00,
                1.992187499999999778e+00,
                1.984375000000000222e+00,
                1.976562500000001110e+00,
                1.968750000000000222e+00,
                1.960937500000000000e+00,
                1.953124999999999556e+00,
                1.945312499999999778e+00,
                1.937500000000000666e+00,
                1.929687500000000000e+00,
                1.921875000000000666e+00,
                1.914062500000000000e+00,
                1.906250000000000000e+00,
                1.898437499999999778e+00,
                1.890625000000000666e+00,
                1.882812499999999556e+00,
                1.875000000000000888e+00,
                1.867187500000000222e+00,
                1.859375000000001110e+00,
                1.851562500000000444e+00,
                1.843750000000000222e+00,
                1.835937499999999556e+00,
                1.828125000000000444e+00,
                1.820312499999999778e+00,
                1.812499999999999778e+00,
                1.804687499999999778e+00,
                1.796874999999999556e+00,
                1.789062500000000222e+00,
                1.781250000000000222e+00,
                1.773437500000000222e+00,
                1.765624999999999778e+00,
                1.757812500000000000e+00,
                1.750000000000000222e+00,
                1.742187500000000444e+00,
                1.734375000000000222e+00,
                1.726562500000000000e+00,
                1.718749999999999778e+00,
                1.710937500000000222e+00,
                1.703124999999999778e+00,
                1.695312500000000000e+00,
                1.687500000000000000e+00,
                1.679687500000000444e+00,
                1.671875000000000000e+00,
                1.664062500000000000e+00,
                1.656250000000000000e+00,
                1.648437500000000444e+00,
                1.640625000000000222e+00,
                1.632812500000000222e+00,
                1.625000000000000222e+00,
                1.617187500000000222e+00,
                1.609375000000000222e+00,
                1.601562500000000222e+00,
                1.593750000000000000e+00,
                1.585937500000000222e+00,
                1.578124999999999778e+00,
                1.570312500000000000e+00,
                1.562499999999999778e+00,
                1.554687500000000222e+00,
                1.546875000000000222e+00,
                1.539062500000000000e+00,
                1.531250000000000000e+00,
                1.523437499999999778e+00,
                1.515625000000000000e+00,
                1.507812500000000222e+00,
                1.500000000000000000e+00,
                1.492187500000000000e+00,
                1.484375000000000222e+00,
                1.476562499999999778e+00,
                1.468750000000000222e+00,
                1.460937500000000000e+00,
                1.453125000000000222e+00,
                1.445312500000000222e+00,
                1.437500000000000000e+00,
                1.429687500000000222e+00,
                1.421875000000000222e+00,
                1.414062500000000000e+00,
                1.406250000000000222e+00,
                1.398437500000000000e+00,
                1.390625000000000000e+00,
                1.382812500000000222e+00,
                1.375000000000000000e+00,
                1.367187500000000000e+00,
                1.359375000000000222e+00,
                1.351562500000000000e+00,
                1.343750000000000000e+00,
                1.335937500000000000e+00,
                1.328125000000000000e+00,
                1.320312499999999778e+00,
                1.312500000000000000e+00,
                1.304687500000000000e+00,
                1.296875000000000000e+00,
                1.289062500000000000e+00,
                1.281249999999999778e+00,
                1.273437500000000444e+00,
                1.265625000000000444e+00,
                1.257812500000000222e+00,
                1.250000000000000222e+00,
                1.242187500000000222e+00,
                1.234375000000000222e+00,
                1.226562500000000222e+00,
                1.218750000000000222e+00,
                1.210937500000000222e+00,
                1.203125000000000000e+00,
                1.195312500000000222e+00,
                1.187499999999999778e+00,
                1.179687500000000222e+00,
                1.171875000000000000e+00,
                1.164062499999999778e+00,
                1.156250000000000000e+00,
                1.148437500000000000e+00,
                1.140625000000000000e+00,
                1.132812499999999778e+00,
                1.125000000000000000e+00,
                1.117187499999999778e+00,
                1.109375000000000000e+00,
                1.101562499999999778e+00,
                1.093749999999999778e+00,
                1.085937500000000000e+00,
                1.078125000000000444e+00,
                1.070312500000000000e+00,
                1.062500000000000222e+00,
                1.054687500000000222e+00,
                1.046874999999999778e+00,
                1.039062500000000000e+00,
                1.031250000000000222e+00,
                1.023437500000000000e+00,
                1.015625000000000222e+00,
                1.007812500000000000e+00,
                1.000000000000000222e+00,
                9.921875000000000000e-01,
                9.843750000000000000e-01,
                9.765624999999997780e-01,
                9.687500000000000000e-01,
                9.609374999999996669e-01,
                9.531249999999997780e-01,
                9.453125000000000000e-01,
                9.374999999999998890e-01,
                9.296874999999996669e-01,
                9.218750000000000000e-01,
                9.140625000000001110e-01,
                9.062499999999998890e-01,
                8.984374999999997780e-01,
                8.906249999999998890e-01,
                8.828125000000001110e-01,
                8.750000000000000000e-01,
                8.671875000000000000e-01,
                8.593750000000000000e-01,
                8.515625000000001110e-01,
                8.437500000000000000e-01,
                8.359374999999998890e-01,
                8.281250000000001110e-01,
                8.203125000000001110e-01,
                8.125000000000001110e-01,
                8.046875000000001110e-01,
                7.968750000000001110e-01,
                7.890625000000000000e-01,
                7.812500000000001110e-01,
                7.734375000000001110e-01,
                7.656250000000002220e-01,
                7.578125000000000000e-01,
                7.500000000000000000e-01,
                7.421874999999998890e-01,
                7.343750000000002220e-01,
                7.265625000000001110e-01,
                7.187500000000001110e-01,
                7.109375000000002220e-01,
                7.031250000000000000e-01,
                6.953125000000000000e-01,
                6.875000000000001110e-01,
                6.796875000000001110e-01,
                6.718750000000000000e-01,
                6.640624999999998890e-01,
                6.562500000000000000e-01,
                6.484374999999998890e-01,
                6.406250000000000000e-01,
                6.328125000000001110e-01,
                6.250000000000001110e-01,
                6.171875000000001110e-01,
                6.093750000000001110e-01,
                6.015625000000001110e-01,
                5.937500000000001110e-01,
                5.859374999999998890e-01,
                5.781250000000000000e-01,
                5.703125000000000000e-01,
                5.624999999999998890e-01,
                5.546874999999998890e-01,
                5.468749999999998890e-01,
                5.390625000000001110e-01,
                5.312500000000001110e-01,
                5.234375000000000000e-01,
                5.156250000000001110e-01,
                5.078125000000001110e-01,
                5.000000000000001110e-01,
                4.921875000000001110e-01,
                4.843750000000000000e-01,
                4.765624999999998335e-01,
                4.687499999999998890e-01,
                4.609375000000000000e-01,
                4.531250000000000000e-01,
                4.453125000000000555e-01,
                4.374999999999999445e-01,
                4.296874999999999445e-01,
                4.218750000000000000e-01,
                4.140625000000001665e-01,
                4.062500000000000000e-01,
                3.984375000000000555e-01,
                3.906250000000001110e-01,
                3.828125000000001110e-01,
                3.750000000000001110e-01,
                3.671874999999999445e-01,
                3.593750000000001110e-01,
                3.515625000000001665e-01,
                3.437500000000001110e-01,
                3.359375000000000555e-01,
                3.281249999999998890e-01,
                3.203125000000000000e-01,
                3.125000000000001110e-01,
                3.046875000000000555e-01,
                2.968750000000001110e-01,
                2.890625000000000000e-01,
                2.812499999999998890e-01,
                2.734375000000000000e-01,
                2.656250000000001110e-01,
                2.578125000000000000e-01,
                2.500000000000000000e-01,
                2.421875000000000000e-01,
                2.343750000000000833e-01,
                2.265625000000000833e-01,
                2.187500000000000000e-01,
                2.109375000000000833e-01,
                2.031250000000000278e-01,
                1.953124999999998335e-01,
                1.875000000000000278e-01,
                1.796875000000000278e-01,
                1.718750000000001110e-01,
                1.640624999999999445e-01,
                1.562500000000000000e-01,
                1.484375000000000000e-01,
                1.406250000000000278e-01,
                1.328125000000000000e-01,
                1.250000000000000278e-01,
                1.171874999999999861e-01,
                1.093750000000000139e-01,
                1.015625000000000278e-01,
                9.374999999999998612e-02,
                8.593750000000000000e-02,
                7.812500000000001388e-02,
                7.031250000000000000e-02,
                6.250000000000001388e-02,
                5.468750000000000000e-02,
                4.687500000000000000e-02,
                3.906250000000000694e-02,
                3.125000000000000000e-02,
                2.343750000000000000e-02,
                1.562500000000000347e-02,
                7.812500000000000000e-03,
                0.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                2.334594726562500347e-02,
                4.650878906250000694e-02,
                6.948852539062502776e-02,
                9.228515625000001388e-02,
                1.148986816406250278e-01,
                1.373291015625000278e-01,
                1.595764160156250000e-01,
                1.816406250000000000e-01,
                2.035217285156250278e-01,
                2.252197265625000000e-01,
                2.467346191406250000e-01,
                2.680664062500000555e-01,
                2.892150878906250000e-01,
                3.101806640624998890e-01,
                3.309631347656249445e-01,
                3.515625000000000555e-01,
                3.719787597656250555e-01,
                3.922119140624999445e-01,
                4.122619628906248890e-01,
                4.321289062500000555e-01,
                4.518127441406251665e-01,
                4.713134765624998335e-01,
                4.906311035156251665e-01,
                5.097656250000003331e-01,
                5.287170410156248890e-01,
                5.474853515625002220e-01,
                5.660705566406251110e-01,
                5.844726562499997780e-01,
                6.026916503906251110e-01,
                6.207275390625000000e-01,
                6.385803222656252220e-01,
                6.562500000000001110e-01,
                6.737365722656248890e-01,
                6.910400390624998890e-01,
                7.081604003906251110e-01,
                7.250976562500001110e-01,
                7.418518066406251110e-01,
                7.584228515624997780e-01,
                7.748107910156253331e-01,
                7.910156250000001110e-01,
                8.070373535156250000e-01,
                8.228759765625004441e-01,
                8.385314941406251110e-01,
                8.540039062499997780e-01,
                8.692932128906253331e-01,
                8.843994140625000000e-01,
                8.993225097656251110e-01,
                9.140625000000002220e-01,
                9.286193847656248890e-01,
                9.429931640625001110e-01,
                9.571838378906253331e-01,
                9.711914062500001110e-01,
                9.850158691406254441e-01,
                9.986572265625000000e-01,
                1.012115478515625000e+00,
                1.025390625000000000e+00,
                1.038482666015625222e+00,
                1.051391601562500444e+00,
                1.064117431640625666e+00,
                1.076660156250000000e+00,
                1.089019775390625000e+00,
                1.101196289062500000e+00,
                1.113189697265625444e+00,
                1.125000000000000000e+00,
                1.136627197265625444e+00,
                1.148071289062500444e+00,
                1.159332275390625222e+00,
                1.170410156250000222e+00,
                1.181304931640625000e+00,
                1.192016601562500222e+00,
                1.202545166015625222e+00,
                1.212890625000000444e+00,
                1.223052978515625000e+00,
                1.233032226562500000e+00,
                1.242828369140625222e+00,
                1.252441406250000444e+00,
                1.261871337890625222e+00,
                1.271118164062500444e+00,
                1.280181884765625222e+00,
                1.289062500000000000e+00,
                1.297760009765624778e+00,
                1.306274414062500222e+00,
                1.314605712890625000e+00,
                1.322753906250000000e+00,
                1.330718994140625000e+00,
                1.338500976562500000e+00,
                1.346099853515625000e+00,
                1.353515625000000222e+00,
                1.360748291015625222e+00,
                1.367797851562500444e+00,
                1.374664306640625666e+00,
                1.381347656250000000e+00,
                1.387847900390625222e+00,
                1.394165039062500222e+00,
                1.400299072265625000e+00,
                1.406250000000000222e+00,
                1.412017822265625444e+00,
                1.417602539062500000e+00,
                1.423004150390625444e+00,
                1.428222656250000444e+00,
                1.433258056640625222e+00,
                1.438110351562500222e+00,
                1.442779541015625444e+00,
                1.447265625000000000e+00,
                1.451568603515625444e+00,
                1.455688476562500666e+00,
                1.459625244140624556e+00,
                1.463378906250000222e+00,
                1.466949462890624778e+00,
                1.470336914062499556e+00,
                1.473541259765625000e+00,
                1.476562500000000222e+00,
                1.479400634765625444e+00,
                1.482055664062500444e+00,
                1.484527587890625666e+00,
                1.486816406250000666e+00,
                1.488922119140625666e+00,
                1.490844726562500444e+00,
                1.492584228515625444e+00,
                1.494140624999999556e+00,
                1.495513916015624778e+00,
                1.496704101562499778e+00,
                1.497711181640624556e+00,
                1.498535156250000666e+00,
                1.499176025390625222e+00,
                1.499633789062500444e+00,
                1.499908447265625222e+00,
                1.500000000000000666e+00,
                1.499908447265625222e+00,
                1.499633789062500444e+00,
                1.499176025390625222e+00,
                1.498535156250000666e+00,
                1.497711181640624556e+00,
                1.496704101562499778e+00,
                1.495513916015624778e+00,
                1.494140624999999556e+00,
                1.492584228515625444e+00,
                1.490844726562500444e+00,
                1.488922119140625666e+00,
                1.486816406250000666e+00,
                1.484527587890625666e+00,
                1.482055664062500444e+00,
                1.479400634765625444e+00,
                1.476562500000000222e+00,
                1.473541259765625000e+00,
                1.470336914062499556e+00,
                1.466949462890624778e+00,
                1.463378906250000222e+00,
                1.459625244140624556e+00,
                1.455688476562500666e+00,
                1.451568603515625444e+00,
                1.447265625000000000e+00,
                1.442779541015625444e+00,
                1.438110351562500222e+00,
                1.433258056640625222e+00,
                1.428222656250000444e+00,
                1.423004150390625444e+00,
                1.417602539062500000e+00,
                1.412017822265625444e+00,
                1.406250000000000222e+00,
                1.400299072265625000e+00,
                1.394165039062500222e+00,
                1.387847900390625222e+00,
                1.381347656250000000e+00,
                1.374664306640625444e+00,
                1.367797851562500666e+00,
                1.360748291015625000e+00,
                1.353515625000000222e+00,
                1.346099853515625222e+00,
                1.338500976562500000e+00,
                1.330718994140625000e+00,
                1.322753906250000000e+00,
                1.314605712890625222e+00,
                1.306274414062500222e+00,
                1.297760009765624778e+00,
                1.289062500000000222e+00,
                1.280181884765625222e+00,
                1.271118164062500222e+00,
                1.261871337890625222e+00,
                1.252441406250000222e+00,
                1.242828369140625222e+00,
                1.233032226562500000e+00,
                1.223052978515625000e+00,
                1.212890625000000444e+00,
                1.202545166015625222e+00,
                1.192016601562500222e+00,
                1.181304931640625000e+00,
                1.170410156250000222e+00,
                1.159332275390625222e+00,
                1.148071289062500222e+00,
                1.136627197265625222e+00,
                1.125000000000000000e+00,
                1.113189697265625444e+00,
                1.101196289062500222e+00,
                1.089019775390625000e+00,
                1.076660156250000000e+00,
                1.064117431640625666e+00,
                1.051391601562500222e+00,
                1.038482666015625222e+00,
                1.025390625000000000e+00,
                1.012115478515625000e+00,
                9.986572265625001110e-01,
                9.850158691406254441e-01,
                9.711914062500001110e-01,
                9.571838378906253331e-01,
                9.429931640625001110e-01,
                9.286193847656248890e-01,
                9.140625000000002220e-01,
                8.993225097656251110e-01,
                8.843994140625000000e-01,
                8.692932128906253331e-01,
                8.540039062499997780e-01,
                8.385314941406251110e-01,
                8.228759765625004441e-01,
                8.070373535156250000e-01,
                7.910156250000001110e-01,
                7.748107910156253331e-01,
                7.584228515624997780e-01,
                7.418518066406251110e-01,
                7.250976562500001110e-01,
                7.081604003906251110e-01,
                6.910400390624998890e-01,
                6.737365722656248890e-01,
                6.562500000000001110e-01,
                6.385803222656252220e-01,
                6.207275390625000000e-01,
                6.026916503906251110e-01,
                5.844726562499997780e-01,
                5.660705566406251110e-01,
                5.474853515625002220e-01,
                5.287170410156248890e-01,
                5.097656250000003331e-01,
                4.906311035156251665e-01,
                4.713134765624998335e-01,
                4.518127441406251665e-01,
                4.321289062500000555e-01,
                4.122619628906248890e-01,
                3.922119140624999445e-01,
                3.719787597656250555e-01,
                3.515625000000000555e-01,
                3.309631347656249445e-01,
                3.101806640624998890e-01,
                2.892150878906250000e-01,
                2.680664062500000555e-01,
                2.467346191406250000e-01,
                2.252197265625000000e-01,
                2.035217285156250278e-01,
                1.816406250000000000e-01,
                1.595764160156250000e-01,
                1.373291015625000278e-01,
                1.148986816406250278e-01,
                9.228515625000001388e-02,
                6.948852539062502776e-02,
                4.650878906250000694e-02,
                2.334594726562500347e-02,
                0.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                9.048403626366049524e-04,
                3.576947492547331506e-03,
                7.953448930493321398e-03,
                1.397246494889258818e-02,
                2.157310200345819232e-02,
                3.069544618483630721e-02,
                4.128055667024453645e-02,
                5.327045917510982859e-02,
                6.660813940470686201e-02,
                8.123753650579598751e-02,
                9.710353651826153509e-02,
                1.141519658267498016e-01,
                1.323295846123073716e-01,
                1.515840803040190699e-01,
                1.718640610306464978e-01,
                1.931190490722655140e-01,
                2.152994743119051868e-01,
                2.383566676871850254e-01,
                2.622428546419540707e-01,
                2.869111485779284876e-01,
                3.123155443063296288e-01,
                3.384109114995224599e-01,
                3.651529881426539004e-01,
                3.924983739852904718e-01,
                4.204045239930560562e-01,
                4.488297417992720972e-01,
                4.777331731565936379e-01,
                5.070747993886474125e-01,
                5.368154308416702714e-01,
                5.669167003361506030e-01,
                5.973410566184613746e-01,
                6.280517578124996669e-01,
                6.590128648713290405e-01,
                6.901892350288110212e-01,
                7.215465152512482438e-01,
                7.530511356890199348e-01,
                7.846703031282233898e-01,
                8.163719944423056818e-01,
                8.481249500437112454e-01,
                8.798986673355099208e-01,
                9.116633941630427618e-01,
                9.433901222655542984e-01,
                9.750505807278385673e-01,
                1.006617229431868044e+00,
                1.038063252508436562e+00,
                1.069362551788799465e+00,
                1.100489740256307192e+00,
                1.131420135498046431e+00,
                1.162129753156477152e+00,
                1.192595300381071644e+00,
                1.222794169279950438e+00,
                1.252704430371522459e+00,
                1.282304826036124057e+00,
                1.311574763967655599e+00,
                1.340494310625217400e+00,
                1.369044184684752752e+00,
                1.397205750490683851e+00,
                1.424961011507547948e+00,
                1.452292603771639268e+00,
                1.479183789342640942e+00,
                1.505618449755274479e+00,
                1.531581079470924145e+00,
                1.557056779329285989e+00,
                1.582031249999999112e+00,
                1.606490785434288471e+00,
                1.630422266316599478e+00,
                1.653813153516239476e+00,
                1.676651481539010780e+00,
                1.698925851978855928e+00,
                1.720625426969490279e+00,
                1.741739922636042603e+00,
                1.762259602546691006e+00,
                1.782175271164304853e+00,
                1.801478267298078917e+00,
                1.820160457555174638e+00,
                1.838214229792355603e+00,
                1.855632486567627915e+00,
                1.872408638591877672e+00,
                1.888536598180507564e+00,
                1.904010772705077459e+00,
                1.918826058044942329e+00,
                1.932977832038886623e+00,
                1.946461947936767745e+00,
                1.959274727851152198e+00,
                1.971412956208950185e+00,
                1.982873873203060189e+00,
                1.993655168244003351e+00,
                2.003754973411559615e+00,
                2.013171856906410540e+00,
                2.021904816501773450e+00,
                2.029953272995043800e+00,
                2.037317063659429550e+00,
                2.043996435695590197e+00,
                2.049992039683274037e+00,
                2.055304923032962972e+00,
                2.059936523437499556e+00,
                2.063888662323733136e+00,
                2.067163538304156223e+00,
                2.069763720628542636e+00,
                2.071692142635582989e+00,
                2.072952095204526834e+00,
                2.073547220206817698e+00,
                2.073481503957735672e+00,
                2.072759270668029341e+00,
                2.071385175895556596e+00,
                2.069364199996924114e+00,
                2.066701641579128168e+00,
                2.063403110951184782e+00,
                2.059474523575772764e+00,
                2.054922093520872739e+00,
                2.049752326911402189e+00,
                2.043972015380858931e+00,
                2.037588229522953043e+00,
                2.030608312343247235e+00,
                2.023039872710795883e+00,
                2.014890778809784955e+00,
                2.006169151591166155e+00,
                1.996883358224294858e+00,
                1.987042005548572687e+00,
                1.976653933525084783e+00,
                1.965728208688233059e+00,
                1.954274117597379012e+00,
                1.942301160288478767e+00,
                1.929819043725728100e+00,
                1.916837675253190598e+00,
                1.903367156046442910e+00,
                1.889417774564206898e+00,
                1.874999999999999112e+00,
                1.860124475733754723e+00,
                1.844802012783474998e+00,
                1.829043583256860339e+00,
                1.812860313802957091e+00,
                1.796263479063781920e+00,
                1.779264495125971957e+00,
                1.761874912972415830e+00,
                1.744106411933898482e+00,
                1.725970793140731763e+00,
                1.707479972974397020e+00,
                1.688645976519182357e+00,
                1.669480931013821667e+00,
                1.649997059303131675e+00,
                1.630206673289648966e+00,
                1.610122167385269476e+00,
                1.589756011962889293e+00,
                1.569120746808039035e+00,
                1.548228974570520000e+00,
                1.527093354216049637e+00,
                1.505726594477890812e+00,
                1.484141447308501505e+00,
                1.462350701331160741e+00,
                1.440367175291612512e+00,
                1.418203711509703480e+00,
                1.395873169331024677e+00,
                1.373388418578542547e+00,
                1.350762333004240423e+00,
                1.328007783740758230e+00,
                1.305137632753030186e+00,
                1.282164726289920065e+00,
                1.259101888335862229e+00,
                1.235961914062500000e+00,
                1.212757563280319584e+00,
                1.189501553890295327e+00,
                1.166206555335520090e+00,
                1.142885182052850723e+00,
                1.119549986924539109e+00,
                1.096213454729877412e+00,
                1.072887995596829125e+00,
                1.049585938453674094e+00,
                1.026319524480640677e+00,
                1.003100900561548547e+00,
                9.799421127354428496e-01,
                9.568550996482370063e-01,
                9.338516860043450940e-01,
                9.109435760183258735e-01,
                8.881423468665156085e-01,
                8.654594421386715419e-01,
                8.429061652896050472e-01,
                8.204936730908227727e-01,
                7.982329690821637902e-01,
                7.761348970234388522e-01,
                7.542101343460664298e-01,
                7.324691856047134131e-01,
                7.109223759289305944e-01,
                6.895798444747921474e-01,
                6.684515378765352178e-01,
                6.475472036981950730e-01,
                6.268763838852463577e-01,
                6.064484082162376888e-01,
                5.862723877544343543e-01,
                5.663572082994503543e-01,
                5.467115238388942089e-01,
                5.273437499999996669e-01,
                5.082620575012696262e-01,
                4.894743656041095625e-01,
                4.709883355644705061e-01,
                4.528113640844820265e-01,
                4.349505767640946541e-01,
                4.174128215527158070e-01,
                4.002046622008493815e-01,
                3.833323717117305129e-01,
                3.668019257929697186e-01,
                3.506189963081848271e-01,
                3.347889447286434561e-01,
                3.193168155848977174e-01,
                3.042073299184264168e-01,
                2.894648787332697037e-01,
                2.750935164476685513e-01,
                2.610969543457031250e-01,
                2.474785540289304309e-01,
                2.342413208680226289e-01,
                2.213878974544058187e-01,
                2.089205570518969657e-01,
                1.968411970483429640e-01,
                1.851513324072583677e-01,
                1.738520891194638707e-01,
                1.629441976547241211e-01,
                1.524279864133859241e-01,
                1.423033751780166944e-01,
                1.325698685650422981e-01,
                1.232265494763851027e-01,
                1.142720725511025964e-01,
                1.057046576170250773e-01,
                9.752208314239395326e-02,
                8.972167968749997224e-02,
                8.230032335632128659e-02,
                7.525442924816160006e-02,
                6.857994490928827347e-02,
                6.227234378457066621e-02,
                5.632661866911801291e-02,
                5.073727515991773712e-02,
                4.549832510747361947e-02,
                4.060328006744384072e-02,
                3.604514475227914988e-02,
                3.181641048286109469e-02,
                2.790904864014009251e-02,
                2.431450411677359841e-02,
                2.102368876876425582e-02,
                1.802697486709802996e-02,
                1.531418854938237234e-02,
                1.287460327148437153e-02,
                1.069693325916886914e-02,
                8.769326959736641752e-03,
                7.079360493662530812e-03,
                5.614031106233596802e-03,
                4.359750619187251729e-03,
                3.302338882349430214e-03,
                2.427017225272720246e-03,
                1.718401908874510851e-03,
                1.160497577075147134e-03,
                7.366907084360716559e-04,
                4.297430677979717267e-04,
                2.217851579189299182e-04,
                9.430967111256903545e-05,
                2.816494088619946078e-05,
                3.548393578967077403e-06,
                0.000000000000000000e+00,
            ];

            foreach ((BetaDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 1d / 256, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                0.000000000000000000e+00,
                3.906250000000000000e-03,
                7.812500000000000000e-03,
                1.171875000000000000e-02,
                1.562500000000000000e-02,
                1.953125000000000000e-02,
                2.343750000000000000e-02,
                2.734375000000000000e-02,
                3.125000000000000000e-02,
                3.515625000000000000e-02,
                3.906250000000000000e-02,
                4.296875000000000000e-02,
                4.687500000000000000e-02,
                5.078125000000000000e-02,
                5.468750000000000000e-02,
                5.859375000000000000e-02,
                6.250000000000000000e-02,
                6.640625000000000000e-02,
                7.031250000000000000e-02,
                7.421875000000000000e-02,
                7.812500000000000000e-02,
                8.203125000000000000e-02,
                8.593750000000000000e-02,
                8.984375000000000000e-02,
                9.375000000000000000e-02,
                9.765625000000000000e-02,
                1.015625000000000000e-01,
                1.054687500000000000e-01,
                1.093750000000000000e-01,
                1.132812500000000000e-01,
                1.171875000000000000e-01,
                1.210937500000000000e-01,
                1.250000000000000000e-01,
                1.289062500000000000e-01,
                1.328125000000000000e-01,
                1.367187500000000000e-01,
                1.406250000000000000e-01,
                1.445312500000000000e-01,
                1.484375000000000000e-01,
                1.523437500000000000e-01,
                1.562500000000000000e-01,
                1.601562500000000000e-01,
                1.640625000000000000e-01,
                1.679687500000000000e-01,
                1.718750000000000000e-01,
                1.757812500000000000e-01,
                1.796875000000000000e-01,
                1.835937500000000000e-01,
                1.875000000000000000e-01,
                1.914062500000000000e-01,
                1.953125000000000000e-01,
                1.992187500000000000e-01,
                2.031250000000000000e-01,
                2.070312500000000000e-01,
                2.109375000000000000e-01,
                2.148437500000000000e-01,
                2.187500000000000000e-01,
                2.226562500000000000e-01,
                2.265625000000000000e-01,
                2.304687500000000000e-01,
                2.343750000000000000e-01,
                2.382812500000000000e-01,
                2.421875000000000000e-01,
                2.460937500000000000e-01,
                2.500000000000000000e-01,
                2.539062500000000000e-01,
                2.578125000000000000e-01,
                2.617187500000000000e-01,
                2.656250000000000000e-01,
                2.695312500000000000e-01,
                2.734375000000000000e-01,
                2.773437500000000000e-01,
                2.812500000000000000e-01,
                2.851562500000000000e-01,
                2.890625000000000000e-01,
                2.929687500000000000e-01,
                2.968750000000000000e-01,
                3.007812500000000000e-01,
                3.046875000000000000e-01,
                3.085937500000000000e-01,
                3.125000000000000000e-01,
                3.164062500000000000e-01,
                3.203125000000000000e-01,
                3.242187500000000000e-01,
                3.281250000000000000e-01,
                3.320312500000000000e-01,
                3.359375000000000000e-01,
                3.398437500000000000e-01,
                3.437500000000000000e-01,
                3.476562500000000000e-01,
                3.515625000000000000e-01,
                3.554687500000000000e-01,
                3.593750000000000000e-01,
                3.632812500000000000e-01,
                3.671875000000000000e-01,
                3.710937500000000000e-01,
                3.750000000000000000e-01,
                3.789062500000000000e-01,
                3.828125000000000000e-01,
                3.867187500000000000e-01,
                3.906250000000000000e-01,
                3.945312500000000000e-01,
                3.984375000000000000e-01,
                4.023437500000000000e-01,
                4.062500000000000000e-01,
                4.101562500000000000e-01,
                4.140625000000000000e-01,
                4.179687500000000000e-01,
                4.218750000000000000e-01,
                4.257812500000000000e-01,
                4.296875000000000000e-01,
                4.335937500000000000e-01,
                4.375000000000000000e-01,
                4.414062500000000000e-01,
                4.453125000000000000e-01,
                4.492187500000000000e-01,
                4.531250000000000000e-01,
                4.570312500000000000e-01,
                4.609375000000000000e-01,
                4.648437500000000000e-01,
                4.687500000000000000e-01,
                4.726562500000000000e-01,
                4.765625000000000000e-01,
                4.804687500000000000e-01,
                4.843750000000000000e-01,
                4.882812500000000000e-01,
                4.921875000000000000e-01,
                4.960937500000000000e-01,
                5.000000000000000000e-01,
                5.039062500000000000e-01,
                5.078125000000000000e-01,
                5.117187500000000000e-01,
                5.156250000000000000e-01,
                5.195312500000000000e-01,
                5.234375000000000000e-01,
                5.273437500000000000e-01,
                5.312500000000000000e-01,
                5.351562500000000000e-01,
                5.390625000000000000e-01,
                5.429687500000000000e-01,
                5.468750000000000000e-01,
                5.507812500000000000e-01,
                5.546875000000000000e-01,
                5.585937500000000000e-01,
                5.625000000000000000e-01,
                5.664062500000000000e-01,
                5.703125000000000000e-01,
                5.742187500000000000e-01,
                5.781250000000000000e-01,
                5.820312500000000000e-01,
                5.859375000000000000e-01,
                5.898437500000000000e-01,
                5.937500000000000000e-01,
                5.976562500000000000e-01,
                6.015625000000000000e-01,
                6.054687500000000000e-01,
                6.093750000000000000e-01,
                6.132812500000000000e-01,
                6.171875000000000000e-01,
                6.210937500000000000e-01,
                6.250000000000000000e-01,
                6.289062500000000000e-01,
                6.328125000000000000e-01,
                6.367187500000000000e-01,
                6.406250000000000000e-01,
                6.445312500000000000e-01,
                6.484375000000000000e-01,
                6.523437500000000000e-01,
                6.562500000000000000e-01,
                6.601562500000000000e-01,
                6.640625000000000000e-01,
                6.679687500000000000e-01,
                6.718750000000000000e-01,
                6.757812500000000000e-01,
                6.796875000000000000e-01,
                6.835937500000000000e-01,
                6.875000000000000000e-01,
                6.914062500000000000e-01,
                6.953125000000000000e-01,
                6.992187500000000000e-01,
                7.031250000000000000e-01,
                7.070312500000000000e-01,
                7.109375000000000000e-01,
                7.148437500000000000e-01,
                7.187500000000000000e-01,
                7.226562500000000000e-01,
                7.265625000000000000e-01,
                7.304687500000000000e-01,
                7.343750000000000000e-01,
                7.382812500000000000e-01,
                7.421875000000000000e-01,
                7.460937500000000000e-01,
                7.500000000000000000e-01,
                7.539062500000000000e-01,
                7.578125000000000000e-01,
                7.617187500000000000e-01,
                7.656250000000000000e-01,
                7.695312500000000000e-01,
                7.734375000000000000e-01,
                7.773437500000000000e-01,
                7.812500000000000000e-01,
                7.851562500000000000e-01,
                7.890625000000000000e-01,
                7.929687500000000000e-01,
                7.968750000000000000e-01,
                8.007812500000000000e-01,
                8.046875000000000000e-01,
                8.085937500000000000e-01,
                8.125000000000000000e-01,
                8.164062500000000000e-01,
                8.203125000000000000e-01,
                8.242187500000000000e-01,
                8.281250000000000000e-01,
                8.320312500000000000e-01,
                8.359375000000000000e-01,
                8.398437500000000000e-01,
                8.437500000000000000e-01,
                8.476562500000000000e-01,
                8.515625000000000000e-01,
                8.554687500000000000e-01,
                8.593750000000000000e-01,
                8.632812500000000000e-01,
                8.671875000000000000e-01,
                8.710937500000000000e-01,
                8.750000000000000000e-01,
                8.789062500000000000e-01,
                8.828125000000000000e-01,
                8.867187500000000000e-01,
                8.906250000000000000e-01,
                8.945312500000000000e-01,
                8.984375000000000000e-01,
                9.023437500000000000e-01,
                9.062500000000000000e-01,
                9.101562500000000000e-01,
                9.140625000000000000e-01,
                9.179687500000000000e-01,
                9.218750000000000000e-01,
                9.257812500000000000e-01,
                9.296875000000000000e-01,
                9.335937500000000000e-01,
                9.375000000000000000e-01,
                9.414062500000000000e-01,
                9.453125000000000000e-01,
                9.492187500000000000e-01,
                9.531250000000000000e-01,
                9.570312500000000000e-01,
                9.609375000000000000e-01,
                9.648437500000000000e-01,
                9.687500000000000000e-01,
                9.726562500000000000e-01,
                9.765625000000000000e-01,
                9.804687500000000000e-01,
                9.843750000000000000e-01,
                9.882812500000000000e-01,
                9.921875000000000000e-01,
                9.960937500000000000e-01,
                1.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                1.525878906250000000e-05,
                6.103515625000000000e-05,
                1.373291015625000000e-04,
                2.441406250000000000e-04,
                3.814697265625000000e-04,
                5.493164062500000000e-04,
                7.476806640625000000e-04,
                9.765625000000000000e-04,
                1.235961914062500000e-03,
                1.525878906250000000e-03,
                1.846313476562500000e-03,
                2.197265625000000000e-03,
                2.578735351562500000e-03,
                2.990722656250000000e-03,
                3.433227539062500000e-03,
                3.906250000000000000e-03,
                4.409790039062500000e-03,
                4.943847656250000000e-03,
                5.508422851562500000e-03,
                6.103515625000000000e-03,
                6.729125976562500000e-03,
                7.385253906250000000e-03,
                8.071899414062500000e-03,
                8.789062500000000000e-03,
                9.536743164062500000e-03,
                1.031494140625000000e-02,
                1.112365722656250000e-02,
                1.196289062500000000e-02,
                1.283264160156250000e-02,
                1.373291015625000000e-02,
                1.466369628906250000e-02,
                1.562500000000000000e-02,
                1.661682128906250000e-02,
                1.763916015625000000e-02,
                1.869201660156250000e-02,
                1.977539062500000000e-02,
                2.088928222656250000e-02,
                2.203369140625000000e-02,
                2.320861816406250000e-02,
                2.441406250000000000e-02,
                2.565002441406250000e-02,
                2.691650390625000000e-02,
                2.821350097656250000e-02,
                2.954101562500000000e-02,
                3.089904785156250000e-02,
                3.228759765625000000e-02,
                3.370666503906250000e-02,
                3.515625000000000000e-02,
                3.663635253906250000e-02,
                3.814697265625000000e-02,
                3.968811035156250000e-02,
                4.125976562500000000e-02,
                4.286193847656250000e-02,
                4.449462890625000000e-02,
                4.615783691406250000e-02,
                4.785156250000000000e-02,
                4.957580566406250000e-02,
                5.133056640625000000e-02,
                5.311584472656250000e-02,
                5.493164062500000000e-02,
                5.677795410156250000e-02,
                5.865478515625000000e-02,
                6.056213378906250000e-02,
                6.250000000000000000e-02,
                6.446838378906250000e-02,
                6.646728515625000000e-02,
                6.849670410156250000e-02,
                7.055664062500000000e-02,
                7.264709472656250000e-02,
                7.476806640625000000e-02,
                7.691955566406250000e-02,
                7.910156250000000000e-02,
                8.131408691406250000e-02,
                8.355712890625000000e-02,
                8.583068847656250000e-02,
                8.813476562500000000e-02,
                9.046936035156250000e-02,
                9.283447265625000000e-02,
                9.523010253906250000e-02,
                9.765625000000000000e-02,
                1.001129150390625000e-01,
                1.026000976562500000e-01,
                1.051177978515625000e-01,
                1.076660156250000000e-01,
                1.102447509765625000e-01,
                1.128540039062500000e-01,
                1.154937744140625000e-01,
                1.181640625000000000e-01,
                1.208648681640625000e-01,
                1.235961914062500000e-01,
                1.263580322265625000e-01,
                1.291503906250000000e-01,
                1.319732666015625000e-01,
                1.348266601562500000e-01,
                1.377105712890625000e-01,
                1.406250000000000000e-01,
                1.435699462890625000e-01,
                1.465454101562500000e-01,
                1.495513916015625000e-01,
                1.525878906250000000e-01,
                1.556549072265625000e-01,
                1.587524414062500000e-01,
                1.618804931640625000e-01,
                1.650390625000000000e-01,
                1.682281494140625000e-01,
                1.714477539062500000e-01,
                1.746978759765625000e-01,
                1.779785156250000000e-01,
                1.812896728515625000e-01,
                1.846313476562500000e-01,
                1.880035400390625000e-01,
                1.914062500000000000e-01,
                1.948394775390625000e-01,
                1.983032226562500000e-01,
                2.017974853515625000e-01,
                2.053222656250000000e-01,
                2.088775634765625000e-01,
                2.124633789062500000e-01,
                2.160797119140625000e-01,
                2.197265625000000000e-01,
                2.234039306640625000e-01,
                2.271118164062500000e-01,
                2.308502197265625000e-01,
                2.346191406250000000e-01,
                2.384185791015625000e-01,
                2.422485351562500000e-01,
                2.461090087890625000e-01,
                2.500000000000000000e-01,
                2.539215087890625000e-01,
                2.578735351562500000e-01,
                2.618560791015625000e-01,
                2.658691406250000000e-01,
                2.699127197265625000e-01,
                2.739868164062500000e-01,
                2.780914306640625000e-01,
                2.822265625000000000e-01,
                2.863922119140625000e-01,
                2.905883789062500000e-01,
                2.948150634765625000e-01,
                2.990722656250000000e-01,
                3.033599853515625000e-01,
                3.076782226562500000e-01,
                3.120269775390625000e-01,
                3.164062500000000555e-01,
                3.208160400390625000e-01,
                3.252563476562500000e-01,
                3.297271728515625000e-01,
                3.342285156250000555e-01,
                3.387603759765625000e-01,
                3.433227539062499445e-01,
                3.479156494140625000e-01,
                3.525390625000000000e-01,
                3.571929931640625000e-01,
                3.618774414062500000e-01,
                3.665924072265625000e-01,
                3.713378906250000000e-01,
                3.761138916015625000e-01,
                3.809204101562500000e-01,
                3.857574462890625000e-01,
                3.906250000000000000e-01,
                3.955230712890625000e-01,
                4.004516601562500000e-01,
                4.054107666015625000e-01,
                4.104003906250000000e-01,
                4.154205322265625000e-01,
                4.204711914062500000e-01,
                4.255523681640625000e-01,
                4.306640625000000000e-01,
                4.358062744140625000e-01,
                4.409790039062500000e-01,
                4.461822509765625000e-01,
                4.514160156250000000e-01,
                4.566802978515625000e-01,
                4.619750976562500000e-01,
                4.673004150390625000e-01,
                4.726562500000000000e-01,
                4.780426025390625000e-01,
                4.834594726562500000e-01,
                4.889068603515625000e-01,
                4.943847656250000000e-01,
                4.998931884765625000e-01,
                5.054321289062500000e-01,
                5.110015869140625000e-01,
                5.166015625000000000e-01,
                5.222320556640625000e-01,
                5.278930664062500000e-01,
                5.335845947265625000e-01,
                5.393066406250000000e-01,
                5.450592041015625000e-01,
                5.508422851562500000e-01,
                5.566558837890625000e-01,
                5.625000000000000000e-01,
                5.683746337890625000e-01,
                5.742797851562500000e-01,
                5.802154541015625000e-01,
                5.861816406250000000e-01,
                5.921783447265625000e-01,
                5.982055664062500000e-01,
                6.042633056640625000e-01,
                6.103515625000000000e-01,
                6.164703369140625000e-01,
                6.226196289062500000e-01,
                6.287994384765625000e-01,
                6.350097656250000000e-01,
                6.412506103515625000e-01,
                6.475219726562500000e-01,
                6.538238525390625000e-01,
                6.601562500000000000e-01,
                6.665191650390625000e-01,
                6.729125976562500000e-01,
                6.793365478515625000e-01,
                6.857910156250000000e-01,
                6.922760009765625000e-01,
                6.987915039062500000e-01,
                7.053375244140625000e-01,
                7.119140625000000000e-01,
                7.185211181640625000e-01,
                7.251586914062500000e-01,
                7.318267822265625000e-01,
                7.385253906250000000e-01,
                7.452545166015625000e-01,
                7.520141601562500000e-01,
                7.588043212890625000e-01,
                7.656250000000000000e-01,
                7.724761962890625000e-01,
                7.793579101562500000e-01,
                7.862701416015625000e-01,
                7.932128906250000000e-01,
                8.001861572265625000e-01,
                8.071899414062500000e-01,
                8.142242431640625000e-01,
                8.212890625000000000e-01,
                8.283843994140625000e-01,
                8.355102539062500000e-01,
                8.426666259765625000e-01,
                8.498535156250000000e-01,
                8.570709228515625000e-01,
                8.643188476562500000e-01,
                8.715972900390625000e-01,
                8.789062500000000000e-01,
                8.862457275390625000e-01,
                8.936157226562500000e-01,
                9.010162353515625000e-01,
                9.084472656250000000e-01,
                9.159088134765625000e-01,
                9.234008789062500000e-01,
                9.309234619140625000e-01,
                9.384765625000000000e-01,
                9.460601806640625000e-01,
                9.536743164062500000e-01,
                9.613189697265625000e-01,
                9.689941406250000000e-01,
                9.766998291015625000e-01,
                9.844360351562500000e-01,
                9.922027587890625000e-01,
                1.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a1b2 = [
                0.000000000000000000e+00,
                7.797241210937498265e-03,
                1.556396484375000000e-02,
                2.330017089843750000e-02,
                3.100585937500000000e-02,
                3.868103027343750694e-02,
                4.632568359375000000e-02,
                5.393981933593750000e-02,
                6.152343749999999306e-02,
                6.907653808593750000e-02,
                7.659912109375000000e-02,
                8.409118652343750000e-02,
                9.155273437499998612e-02,
                9.898376464843750000e-02,
                1.063842773437500000e-01,
                1.137542724609375000e-01,
                1.210937500000000139e-01,
                1.284027099609375000e-01,
                1.356811523437500278e-01,
                1.429290771484375000e-01,
                1.501464843750000000e-01,
                1.573333740234374722e-01,
                1.644897460937500000e-01,
                1.716156005859375000e-01,
                1.787109375000000000e-01,
                1.857757568359375278e-01,
                1.928100585937500000e-01,
                1.998138427734375000e-01,
                2.067871093750000000e-01,
                2.137298583984375000e-01,
                2.206420898437500000e-01,
                2.275238037109375000e-01,
                2.343750000000000000e-01,
                2.411956787109375278e-01,
                2.479858398437500000e-01,
                2.547454833984375000e-01,
                2.614746093750000000e-01,
                2.681732177734375000e-01,
                2.748413085937500000e-01,
                2.814788818359375000e-01,
                2.880859375000000000e-01,
                2.946624755859375000e-01,
                3.012084960937500000e-01,
                3.077239990234375000e-01,
                3.142089843750000555e-01,
                3.206634521484375000e-01,
                3.270874023437500000e-01,
                3.334808349609375000e-01,
                3.398437500000000000e-01,
                3.461761474609375000e-01,
                3.524780273437500000e-01,
                3.587493896484375000e-01,
                3.649902343750000000e-01,
                3.712005615234375000e-01,
                3.773803710937500000e-01,
                3.835296630859375000e-01,
                3.896484375000000000e-01,
                3.957366943359375000e-01,
                4.017944335937500000e-01,
                4.078216552734375000e-01,
                4.138183593750000000e-01,
                4.197845458984375000e-01,
                4.257202148437500000e-01,
                4.316253662109375000e-01,
                4.375000000000000000e-01,
                4.433441162109375000e-01,
                4.491577148437500000e-01,
                4.549407958984375000e-01,
                4.606933593750000000e-01,
                4.664154052734375000e-01,
                4.721069335937500000e-01,
                4.777679443359375000e-01,
                4.833984375000000000e-01,
                4.889984130859375000e-01,
                4.945678710937500000e-01,
                5.001068115234375000e-01,
                5.056152343750000000e-01,
                5.110931396484375000e-01,
                5.165405273437500000e-01,
                5.219573974609375000e-01,
                5.273437500000000000e-01,
                5.326995849609375000e-01,
                5.380249023437500000e-01,
                5.433197021484375000e-01,
                5.485839843750000000e-01,
                5.538177490234375000e-01,
                5.590209960937500000e-01,
                5.641937255859375000e-01,
                5.693359375000000000e-01,
                5.744476318359375000e-01,
                5.795288085937500000e-01,
                5.845794677734375000e-01,
                5.895996093750000000e-01,
                5.945892333984375000e-01,
                5.995483398437500000e-01,
                6.044769287109375000e-01,
                6.093750000000000000e-01,
                6.142425537109375000e-01,
                6.190795898437500000e-01,
                6.238861083984375000e-01,
                6.286621093750000000e-01,
                6.334075927734375000e-01,
                6.381225585937500000e-01,
                6.428070068359375000e-01,
                6.474609375000000000e-01,
                6.520843505859375000e-01,
                6.566772460937500000e-01,
                6.612396240234375000e-01,
                6.657714843750000000e-01,
                6.702728271484375000e-01,
                6.747436523437500000e-01,
                6.791839599609375000e-01,
                6.835937500000000000e-01,
                6.879730224609375000e-01,
                6.923217773437500000e-01,
                6.966400146484375000e-01,
                7.009277343750000000e-01,
                7.051849365234375000e-01,
                7.094116210937500000e-01,
                7.136077880859375000e-01,
                7.177734375000000000e-01,
                7.219085693359375000e-01,
                7.260131835937500000e-01,
                7.300872802734375000e-01,
                7.341308593750000000e-01,
                7.381439208984375000e-01,
                7.421264648437500000e-01,
                7.460784912109375000e-01,
                7.500000000000000000e-01,
                7.538909912109375000e-01,
                7.577514648437500000e-01,
                7.615814208984375000e-01,
                7.653808593750000000e-01,
                7.691497802734375000e-01,
                7.728881835937500000e-01,
                7.765960693359375000e-01,
                7.802734375000000000e-01,
                7.839202880859375000e-01,
                7.875366210937500000e-01,
                7.911224365234375000e-01,
                7.946777343750000000e-01,
                7.982025146484375000e-01,
                8.016967773437500000e-01,
                8.051605224609375000e-01,
                8.085937500000000000e-01,
                8.119964599609375000e-01,
                8.153686523437500000e-01,
                8.187103271484375000e-01,
                8.220214843750000000e-01,
                8.253021240234375000e-01,
                8.285522460937500000e-01,
                8.317718505859375000e-01,
                8.349609375000000000e-01,
                8.381195068359375000e-01,
                8.412475585937500000e-01,
                8.443450927734375000e-01,
                8.474121093750000000e-01,
                8.504486083984375000e-01,
                8.534545898437500000e-01,
                8.564300537109375000e-01,
                8.593750000000000000e-01,
                8.622894287109375000e-01,
                8.651733398437500000e-01,
                8.680267333984375000e-01,
                8.708496093750000000e-01,
                8.736419677734375000e-01,
                8.764038085937500000e-01,
                8.791351318359375000e-01,
                8.818359375000000000e-01,
                8.845062255859375000e-01,
                8.871459960937500000e-01,
                8.897552490234375000e-01,
                8.923339843750000000e-01,
                8.948822021484375000e-01,
                8.973999023437500000e-01,
                8.998870849609375000e-01,
                9.023437500000000000e-01,
                9.047698974609375000e-01,
                9.071655273437500000e-01,
                9.095306396484375000e-01,
                9.118652343750000000e-01,
                9.141693115234375000e-01,
                9.164428710937500000e-01,
                9.186859130859375000e-01,
                9.208984375000000000e-01,
                9.230804443359375000e-01,
                9.252319335937500000e-01,
                9.273529052734375000e-01,
                9.294433593750000000e-01,
                9.315032958984375000e-01,
                9.335327148437500000e-01,
                9.355316162109375000e-01,
                9.375000000000000000e-01,
                9.394378662109375000e-01,
                9.413452148437500000e-01,
                9.432220458984375000e-01,
                9.450683593750000000e-01,
                9.468841552734375000e-01,
                9.486694335937500000e-01,
                9.504241943359375000e-01,
                9.521484375000000000e-01,
                9.538421630859375000e-01,
                9.555053710937500000e-01,
                9.571380615234375000e-01,
                9.587402343750000000e-01,
                9.603118896484375000e-01,
                9.618530273437500000e-01,
                9.633636474609375000e-01,
                9.648437500000000000e-01,
                9.662933349609375000e-01,
                9.677124023437500000e-01,
                9.691009521484375000e-01,
                9.704589843750000000e-01,
                9.717864990234375000e-01,
                9.730834960937500000e-01,
                9.743499755859375000e-01,
                9.755859375000000000e-01,
                9.767913818359375000e-01,
                9.779663085937500000e-01,
                9.791107177734375000e-01,
                9.802246093750000000e-01,
                9.813079833984375000e-01,
                9.823608398437500000e-01,
                9.833831787109375000e-01,
                9.843750000000000000e-01,
                9.853363037109375000e-01,
                9.862670898437500000e-01,
                9.871673583984375000e-01,
                9.880371093750000000e-01,
                9.888763427734375000e-01,
                9.896850585937500000e-01,
                9.904632568359375000e-01,
                9.912109375000000000e-01,
                9.919281005859375000e-01,
                9.926147460937500000e-01,
                9.932708740234375000e-01,
                9.938964843750000000e-01,
                9.944915771484375000e-01,
                9.950561523437500000e-01,
                9.955902099609375000e-01,
                9.960937500000000000e-01,
                9.965667724609375000e-01,
                9.970092773437500000e-01,
                9.974212646484375000e-01,
                9.978027343750000000e-01,
                9.981536865234375000e-01,
                9.984741210937500000e-01,
                9.987640380859375000e-01,
                9.990234375000000000e-01,
                9.992523193359375000e-01,
                9.994506835937500000e-01,
                9.996185302734375000e-01,
                9.997558593750000000e-01,
                9.998626708984375000e-01,
                9.999389648437500000e-01,
                9.999847412109375000e-01,
                1.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                4.565715789794921875e-05,
                1.821517944335937500e-04,
                4.087686538696289062e-04,
                7.247924804687500000e-04,
                1.129508018493652344e-03,
                1.622200012207031250e-03,
                2.202153205871582031e-03,
                2.868652343750000000e-03,
                3.620982170104980469e-03,
                4.458427429199218750e-03,
                5.380272865295410156e-03,
                6.385803222656250000e-03,
                7.474303245544433594e-03,
                8.645057678222656250e-03,
                9.897351264953613281e-03,
                1.123046875000000000e-02,
                1.264369487762451172e-02,
                1.413631439208984375e-02,
                1.570761203765869141e-02,
                1.735687255859375000e-02,
                1.908338069915771484e-02,
                2.088642120361328125e-02,
                2.276527881622314453e-02,
                2.471923828125000000e-02,
                2.674758434295654297e-02,
                2.884960174560546875e-02,
                3.102457523345946919e-02,
                3.327178955078125000e-02,
                3.559052944183349609e-02,
                3.798007965087890625e-02,
                4.043972492218017578e-02,
                4.296875000000000000e-02,
                4.556643962860107422e-02,
                4.823207855224609375e-02,
                5.096495151519775391e-02,
                5.376434326171875000e-02,
                5.662953853607178428e-02,
                5.955982208251952431e-02,
                6.255447864532470703e-02,
                6.561279296875000000e-02,
                6.873404979705810547e-02,
                7.191753387451171875e-02,
                7.516252994537353516e-02,
                7.846832275390625000e-02,
                8.183419704437255859e-02,
                8.525943756103515625e-02,
                8.874332904815673828e-02,
                9.228515625000000000e-02,
                9.588420391082763672e-02,
                9.953975677490234375e-02,
                1.032510995864868164e-01,
                1.070175170898437500e-01,
                1.108382940292358398e-01,
                1.147127151489257674e-01,
                1.186400651931762695e-01,
                1.226196289062499861e-01,
                1.266506910324096680e-01,
                1.307325363159179688e-01,
                1.348644495010375977e-01,
                1.390457153320312500e-01,
                1.432756185531616211e-01,
                1.475534439086914062e-01,
                1.518784761428833008e-01,
                1.562500000000000000e-01,
                1.606673002243041992e-01,
                1.651296615600585938e-01,
                1.696363687515258789e-01,
                1.741867065429687500e-01,
                1.787799596786499023e-01,
                1.834154129028320312e-01,
                1.880923509597778320e-01,
                1.928100585937500000e-01,
                1.975678205490112305e-01,
                2.023649215698242188e-01,
                2.072006464004516602e-01,
                2.120742797851562500e-01,
                2.169851064682006836e-01,
                2.219324111938476562e-01,
                2.269154787063598633e-01,
                2.319335937500000000e-01,
                2.369860410690307617e-01,
                2.420721054077148438e-01,
                2.471910715103149414e-01,
                2.523422241210937500e-01,
                2.575248479843139648e-01,
                2.627382278442382812e-01,
                2.679816484451293945e-01,
                2.732543945312500000e-01,
                2.785557508468627930e-01,
                2.838850021362304688e-01,
                2.892414331436157227e-01,
                2.946243286132812500e-01,
                3.000329732894897461e-01,
                3.054666519165039062e-01,
                3.109246492385864258e-01,
                3.164062500000000000e-01,
                3.219107389450073242e-01,
                3.274374008178710938e-01,
                3.329855203628540039e-01,
                3.385543823242187500e-01,
                3.441432714462280273e-01,
                3.497514724731445312e-01,
                3.553782701492309570e-01,
                3.610229492187500000e-01,
                3.666847944259643555e-01,
                3.723630905151367188e-01,
                3.780571222305297852e-01,
                3.837661743164061945e-01,
                3.894895315170288641e-01,
                3.952264785766601562e-01,
                4.009763002395629883e-01,
                4.067382812500000000e-01,
                4.125117063522338867e-01,
                4.182958602905273438e-01,
                4.240900278091430664e-01,
                4.298934936523437500e-01,
                4.357055425643920898e-01,
                4.415254592895507812e-01,
                4.473525285720825195e-01,
                4.531860351562500000e-01,
                4.590252637863159180e-01,
                4.648694992065429688e-01,
                4.707180261611938477e-01,
                4.765701293945312500e-01,
                4.824250936508178711e-01,
                4.882822036743164062e-01,
                4.941407442092895508e-01,
                5.000000000000000000e-01,
                5.058592557907104492e-01,
                5.117177963256835938e-01,
                5.175749063491821289e-01,
                5.234298706054687500e-01,
                5.292819738388061523e-01,
                5.351305007934570312e-01,
                5.409747362136840820e-01,
                5.468139648437500000e-01,
                5.526474714279174805e-01,
                5.584745407104492188e-01,
                5.642944574356079102e-01,
                5.701065063476562500e-01,
                5.759099721908569336e-01,
                5.817041397094726562e-01,
                5.874882936477661133e-01,
                5.932617187500000000e-01,
                5.990236997604370117e-01,
                6.047735214233398438e-01,
                6.105104684829711914e-01,
                6.162338256835937500e-01,
                6.219428777694702148e-01,
                6.276369094848632812e-01,
                6.333152055740356445e-01,
                6.389770507812500000e-01,
                6.446217298507690430e-01,
                6.502485275268554688e-01,
                6.558567285537719727e-01,
                6.614456176757812500e-01,
                6.670144796371459961e-01,
                6.725625991821289062e-01,
                6.780892610549926758e-01,
                6.835937500000000000e-01,
                6.890753507614135742e-01,
                6.945333480834960938e-01,
                6.999670267105102539e-01,
                7.053756713867187500e-01,
                7.107585668563842773e-01,
                7.161149978637695312e-01,
                7.214442491531372070e-01,
                7.267456054687500000e-01,
                7.320183515548706055e-01,
                7.372617721557617188e-01,
                7.424751520156860352e-01,
                7.476577758789062500e-01,
                7.528089284896850586e-01,
                7.579278945922851562e-01,
                7.630139589309692383e-01,
                7.680664062500000000e-01,
                7.730845212936401367e-01,
                7.780675888061523438e-01,
                7.830148935317993164e-01,
                7.879257202148437500e-01,
                7.927993535995483398e-01,
                7.976350784301757812e-01,
                8.024321794509887695e-01,
                8.071899414062500000e-01,
                8.119076490402221680e-01,
                8.165845870971679688e-01,
                8.212200403213500977e-01,
                8.258132934570312500e-01,
                8.303636312484741211e-01,
                8.348703384399414062e-01,
                8.393326997756958008e-01,
                8.437500000000000000e-01,
                8.481215238571166992e-01,
                8.524465560913085938e-01,
                8.567243814468383789e-01,
                8.609542846679687500e-01,
                8.651355504989624023e-01,
                8.692674636840820312e-01,
                8.733493089675903320e-01,
                8.773803710937500000e-01,
                8.813599348068237305e-01,
                8.852872848510742188e-01,
                8.891617059707641602e-01,
                8.929824829101562500e-01,
                8.967489004135131836e-01,
                9.004602432250976562e-01,
                9.041157960891723633e-01,
                9.077148437500000000e-01,
                9.112566709518432617e-01,
                9.147405624389648438e-01,
                9.181658029556274414e-01,
                9.215316772460937500e-01,
                9.248374700546264648e-01,
                9.280824661254882812e-01,
                9.312659502029418945e-01,
                9.343872070312500000e-01,
                9.374455213546752930e-01,
                9.404401779174804688e-01,
                9.433704614639282227e-01,
                9.462356567382812500e-01,
                9.490350484848022461e-01,
                9.517679214477539062e-01,
                9.544335603713989258e-01,
                9.570312500000000000e-01,
                9.595602750778198242e-01,
                9.620199203491210938e-01,
                9.644094705581665039e-01,
                9.667282104492187500e-01,
                9.689754247665405273e-01,
                9.711503982543945312e-01,
                9.732524156570434570e-01,
                9.752807617187500000e-01,
                9.772347211837768555e-01,
                9.791135787963867188e-01,
                9.809166193008422852e-01,
                9.826431274414062500e-01,
                9.842923879623413086e-01,
                9.858636856079101562e-01,
                9.873563051223754883e-01,
                9.887695312500000000e-01,
                9.901026487350463867e-01,
                9.913549423217773438e-01,
                9.925256967544555664e-01,
                9.936141967773437500e-01,
                9.946197271347045898e-01,
                9.955415725708007812e-01,
                9.963790178298950195e-01,
                9.971313476562500000e-01,
                9.977978467941284180e-01,
                9.983777999877929688e-01,
                9.988704919815063477e-01,
                9.992752075195312500e-01,
                9.995912313461303711e-01,
                9.998178482055664062e-01,
                9.999543428421020508e-01,
                1.000000000000000000e+00,
            ];
            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                1.181648222825515404e-06,
                9.370150564791401848e-06,
                3.134577084296097382e-05,
                7.364511839114129543e-05,
                1.425650131281486210e-04,
                2.441663250465353485e-04,
                3.842777881217784852e-04,
                5.684997886419296265e-04,
                8.022081279577265552e-04,
                1.090557759653165704e-03,
                1.438486501136537537e-03,
                1.850718719651922584e-03,
                2.331768992711147348e-03,
                2.885945742946205428e-03,
                3.517354847382136562e-03,
                4.229903221130371094e-03,
                5.027302375502530098e-03,
                5.913071950544690480e-03,
                6.890543221992118106e-03,
                7.962862582644447684e-03,
                9.132994998161336753e-03,
                1.040372743727857596e-02,
                1.177767227644466175e-02,
                1.325727067887783051e-02,
                1.484479594804355429e-02,
                1.654235685555250149e-02,
                1.835190094347893819e-02,
                2.027521780109964311e-02,
                2.231394231605321465e-02,
                2.446955789991989150e-02,
                2.674339968822181390e-02,
                2.913665771484375000e-02,
                3.165038006087428357e-02,
                3.428547597786746337e-02,
                3.704271898552491393e-02,
                3.992274994379840791e-02,
                4.292608009941289993e-02,
                4.605309410681002191e-02,
                4.930405302351204694e-02,
                5.267909727990627289e-02,
                5.617824962344997175e-02,
                5.980141803729565469e-02,
                6.354839863333694439e-02,
                6.741887851967476308e-02,
                7.141243864250412798e-02,
                7.552855660242130398e-02,
                7.976660944515145957e-02,
                8.412587642669677734e-02,
                8.860554175290502599e-02,
                9.320469729345860765e-02,
                9.792234527028398361e-02,
                1.027574009203817834e-01,
                1.077086951330770148e-01,
                1.127749770616901515e-01,
                1.179549167096283213e-01,
                1.232471074908971786e-01,
                1.286500687650331542e-01,
                1.341622483464562088e-01,
                1.397820249882429089e-01,
                1.455077108403202146e-01,
                1.513375538820795896e-01,
                1.572697403294114338e-01,
                1.633023970161602278e-01,
                1.694335937500000000e-01,
                1.756613456427302822e-01,
                1.819836154149925278e-01,
                1.883983156754069910e-01,
                1.949033111741300950e-01,
                2.014964210308320958e-01,
                2.081754209370956232e-01,
                2.149380453332341290e-01,
                2.217819895595312119e-01,
                2.287049119819002385e-01,
                2.357044360919644255e-01,
                2.427781525815575492e-01,
                2.499236213916447291e-01,
                2.571383737356640609e-01,
                2.644199140972887108e-01,
                2.717657222026090835e-01,
                2.791732549667358398e-01,
                2.866399484148232091e-01,
                2.941632195775127911e-01,
                3.017404683607977645e-01,
                3.093690793903078884e-01,
                3.170464238300141346e-01,
                3.247698611753548903e-01,
                3.325367410207817898e-01,
                3.403444048017263412e-01,
                3.481901875109869593e-01,
                3.560714193895364033e-01,
                3.639854275917500104e-01,
                3.719295378250535578e-01,
                3.799010759639926960e-01,
                3.878973696387220116e-01,
                3.959157497979148288e-01,
                4.039535522460938055e-01,
                4.120081191553807698e-01,
                4.200768005516692938e-01,
                4.281569557752149535e-01,
                4.362459549156483263e-01,
                4.443411802214072281e-01,
                4.524400274835898017e-01,
                4.605399073942280097e-01,
                4.686382468789817013e-01,
                4.767324904042524736e-01,
                4.848201012587196601e-01,
                4.928985628092945603e-01,
                5.009653797314966850e-01,
                5.090180792142505739e-01,
                5.170542121391008550e-01,
                5.250713542338516504e-01,
                5.330671072006225586e-01,
                5.410390998183274291e-01,
                5.489849890195728221e-01,
                5.569024609419770400e-01,
                5.647892319539096206e-01,
                5.726430496546512927e-01,
                5.804616938489743916e-01,
                5.882429774961437374e-01,
                5.959847476333379745e-01,
                6.036848862734913723e-01,
                6.113413112775560876e-01,
                6.189519772011848886e-01,
                6.265148761158343405e-01,
                6.340280384042884521e-01,
                6.414895335306027846e-01,
                6.488974707844690215e-01,
                6.562500000000000000e-01,
                6.635453122489352040e-01,
                6.707816405082667188e-01,
                6.779572603022856470e-01,
                6.850704903190489858e-01,
                6.921196930012669668e-01,
                6.991032751116108557e-01,
                7.060196882724412148e-01,
                7.128674294799566269e-01,
                7.196450415927628796e-01,
                7.263511137948626128e-01,
                7.329842820330654263e-01,
                7.395432294288184494e-01,
                7.460266866644573724e-01,
                7.524334323438779393e-01,
                7.587622933276279014e-01,
                7.650121450424194336e-01,
                7.711819117650620115e-01,
                7.772705668808157498e-01,
                7.832771331161652029e-01,
                7.892006827460136265e-01,
                7.950403377752977008e-01,
                8.007952700950227154e-01,
                8.064647016127182155e-01,
                8.120479043573141098e-01,
                8.175442005584372396e-01,
                8.229529627001284098e-01,
                8.282736135489798812e-01,
                8.335056261566933244e-01,
                8.386485238370582351e-01,
                8.437018801173508109e-01,
                8.486653186641532898e-01,
                8.535385131835937500e-01,
                8.583211872960063715e-01,
                8.630131143850121589e-01,
                8.676141174210201257e-01,
                8.721240687591489404e-01,
                8.765428899115690342e-01,
                8.808705512942651694e-01,
                8.851070719482194704e-01,
                8.892525192350149155e-01,
                8.933070085068592903e-01,
                8.972707027510296030e-01,
                9.011438122087369607e-01,
                9.049265939684119076e-01,
                9.086193515334102244e-01,
                9.122224343641391897e-01,
                9.157362373946043022e-01,
                9.191612005233764648e-01,
                9.224978080789796309e-01,
                9.257465882596989104e-01,
                9.289081125478091394e-01,
                9.319829950982239097e-01,
                9.349718921015650608e-01,
                9.378755011216526327e-01,
                9.406945604074152811e-01,
                9.434298481792211533e-01,
                9.460821818896292257e-01,
                9.486524174585611036e-01,
                9.511414484828932814e-01,
                9.535502054204698652e-01,
                9.558796547485357564e-01,
                9.581307980965902971e-01,
                9.603046713536613765e-01,
                9.624023437500000000e-01,
                9.644249169131953181e-01,
                9.663735238987101184e-01,
                9.682493281948367780e-01,
                9.700535227020736784e-01,
                9.717873286869220806e-01,
                9.734519947101034631e-01,
                9.750487955291973208e-01,
                9.765790309756994247e-01,
                9.780440248065005449e-01,
                9.794451235297856329e-01,
                9.807836952053534674e-01,
                9.820611282193567604e-01,
                9.832788300334627252e-01,
                9.844382259084341058e-01,
                9.855407576021306681e-01,
                9.865878820419311523e-01,
                9.875810699715756868e-01,
                9.885218045724286640e-01,
                9.894115800591620769e-01,
                9.902519002498593181e-01,
                9.910442771105394399e-01,
                9.917902292741018755e-01,
                9.924912805336916222e-01,
                9.931489583104848862e-01,
                9.937647920958951886e-01,
                9.943403118681999331e-01,
                9.948770464835874350e-01,
                9.953765220416244119e-01,
                9.958402602251439362e-01,
                9.962697766145538480e-01,
                9.966665789765656314e-01,
                9.970321655273437500e-01,
                9.973680231700754462e-01,
                9.976756257069610001e-01,
                9.979564320256244514e-01,
                9.982118842599447817e-01,
                9.984434059253075588e-01,
                9.986524000282770430e-01,
                9.988402471506887537e-01,
                9.990083035081624985e-01,
                9.991578989830358637e-01,
                9.992903351317181659e-01,
                9.994068831664648656e-01,
                9.995087819115724415e-01,
                9.995972357339937275e-01,
                9.996734124483737105e-01,
                9.997384411965057893e-01,
                9.997934103012084961e-01,
                9.998393650946226785e-01,
                9.998773057209291437e-01,
                9.999081849134867639e-01,
                9.999329057463910431e-01,
                9.999523193604531457e-01,
                9.999672226635993866e-01,
                9.999783560056911824e-01,
                9.999864008277654648e-01,
                9.999919772856955547e-01,
                9.999956418482724985e-01,
                9.999978848697068656e-01,
                9.999991281365510076e-01,
                9.999997223890417786e-01,
                9.999999448168637173e-01,
                9.999999965293326909e-01,
                1.000000000000000000e+00,
            ];

            foreach ((BetaDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 1d / 256, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} cdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}