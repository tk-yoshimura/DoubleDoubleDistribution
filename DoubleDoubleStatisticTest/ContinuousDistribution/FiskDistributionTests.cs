using DoubleDouble;
using DoubleDoubleStatistic;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleStatisticTest.ContinuousDistribution {
    [TestClass()]
    public class FiskDistributionTests {
        readonly FiskDistribution dist_c1 = new(c: 1);
        readonly FiskDistribution dist_c2 = new(c: 2);
        readonly FiskDistribution dist_c3 = new(c: 3);

        FiskDistribution[] Dists => [
            dist_c1,
            dist_c2,
            dist_c3,
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"C={dist.C}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
                Console.WriteLine(dist.Formula);
            }
        }

        [TestMethod()]
        public void MeanTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mean)) {
                    continue;
                }

                ddouble actual = dist.Mean;
                ddouble expected = IntegrationStatistics.Mean(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void ModeTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mode)) {
                    continue;
                }

                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode - 1e-4), $"{dist}\n{dist.Mode}");
                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode + 1e-4), $"{dist}\n{dist.Mode}");
            }
        }

        [TestMethod()]
        public void MedianTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.Abs(dist.CDF(dist.Median) - 0.5) < 1e-20, $"{dist}\n{dist.Median}");
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Variance)) {
                    continue;
                }

                ddouble actual = dist.Variance;
                ddouble expected = IntegrationStatistics.Variance(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void SkewnessTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Skewness)) {
                    continue;
                }

                ddouble actual = dist.Skewness;
                ddouble expected = IntegrationStatistics.Skewness(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void KurtosisTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Kurtosis)) {
                    continue;
                }

                ddouble actual = dist.Kurtosis;
                ddouble expected = IntegrationStatistics.Kurtosis(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void EntropyTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Entropy;
                ddouble expected = IntegrationStatistics.Entropy(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (FiskDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_c1 = [
                1.000000000000000000e+00,
                4.444444444444444198e-01,
                2.500000000000000000e-01,
                1.600000000000000311e-01,
                1.111111111111111049e-01,
                8.163265306122449716e-02,
                6.250000000000000000e-02,
                4.938271604938272025e-02,
                4.000000000000000083e-02,
                3.305785123966941547e-02,
                2.777777777777777971e-02,
                2.366863905325443385e-02,
                2.040816326530611735e-02,
                1.777777777777778123e-02,
                1.562500000000000000e-02,
                1.384083044982699177e-02,
                1.234567901234567833e-02,
                1.108033240997229919e-02,
                9.999999999999998473e-03,
                9.070294784580500841e-03,
                8.264462809917353867e-03,
                7.561436672967863232e-03,
                6.944444444444445794e-03,
                6.400000000000000307e-03,
                5.917159763313610196e-03,
                5.486968449931412493e-03,
                5.102040816326531072e-03,
                4.756242568370987363e-03,
                4.444444444444444441e-03,
                4.162330905306972292e-03,
                3.906250000000000000e-03,
                3.673094582185492101e-03,
                3.460207612456747510e-03,
                3.265306122448980147e-03,
                3.086419753086419582e-03,
                2.921840759678597573e-03,
                2.770083102493074365e-03,
                2.629848783694938540e-03,
                2.500000000000000486e-03,
                2.379535990481856152e-03,
                2.267573696145124777e-03,
                2.163331530557057597e-03,
                2.066115702479338900e-03,
                1.975308641975308255e-03,
                1.890359168241966242e-03,
                1.810774105930284964e-03,
                1.736111111111111232e-03,
                1.665972511453560649e-03,
                1.599999999999999643e-03,
                1.537870049980776454e-03,
                1.479289940828402332e-03,
                1.423994304022783552e-03,
                1.371742112482852907e-03,
                1.322314049586776957e-03,
                1.275510204081632768e-03,
                1.231148045552477640e-03,
                1.189060642092746407e-03,
                1.149095087618500063e-03,
                1.111111111111110893e-03,
                1.074979844127922938e-03,
                1.040582726326742856e-03,
                1.007810531620055312e-03,
                9.765625000000002168e-04,
                9.467455621301778309e-04,
                9.182736455463728084e-04,
                8.910670527957230327e-04,
                8.650519031141868775e-04,
                8.401596303297626054e-04,
                8.163265306122451451e-04,
                7.934933544931562248e-04,
                7.716049382716051123e-04,
                7.506098705197974778e-04,
                7.304601899196495017e-04,
                7.111111111111109283e-04,
                6.925207756232688080e-04,
                6.746500252993760383e-04,
                6.574621959237343096e-04,
                6.409229290177855930e-04,
                6.250000000000002299e-04,
                6.096631611034903373e-04,
                5.948839976204640381e-04,
                5.806357961968354854e-04,
                5.668934240362811941e-04,
                5.536332179930794151e-04,
                5.408328826392645077e-04,
                5.284713964856653469e-04,
                5.165289256198347251e-04,
                5.049867440979675069e-04,
                4.938271604938271721e-04,
                4.830334500664169774e-04,
                4.725897920604916146e-04,
                4.624812117007746871e-04,
                4.526935264825711867e-04,
                4.432132963988920024e-04,
                4.340277777777778621e-04,
                4.251248804336272939e-04,
                4.164931278633903248e-04,
                4.081216202428324135e-04,
                4.000000000000000192e-04,
                3.921184197627684376e-04,
                3.844675124951941678e-04,
                3.770383636535016843e-04,
                3.698224852071006915e-04,
                3.628117913832199621e-04,
                3.559985760056959964e-04,
                3.493754913092847274e-04,
                3.429355281207132808e-04,
                3.366719973066240328e-04,
                3.305785123966941308e-04,
                3.246489732976220489e-04,
                3.188775510204083005e-04,
                3.132586733495183566e-04,
                3.077870113881194642e-04,
                3.024574669187145835e-04,
                2.972651605231866560e-04,
                2.922054204105486303e-04,
                2.872737719046251784e-04,
                2.824659275474895805e-04,
                2.777777777777778317e-04,
                2.732053821460283063e-04,
                2.687449610319806803e-04,
                2.643928878313173744e-04,
                2.601456815816857141e-04,
                2.559999999999999342e-04,
                2.519526329050138821e-04,
                2.480004960009919712e-04,
                2.441406250000000542e-04,
                2.403701700618953428e-04,
                2.366863905325443764e-04,
                2.330866499621233993e-04,
                2.295684113865932292e-04,
                2.261292328565775423e-04,
                2.227667631989307040e-04,
                2.194787379972564878e-04,
                2.162629757785467194e-04,
                2.131173743939474572e-04,
                2.100399075824407056e-04,
                2.070286217069509732e-04,
                2.040816326530612050e-04,
                2.011971228811428340e-04,
                1.983733386232890833e-04,
                1.956085872169787928e-04,
                1.929012345679012510e-04,
                1.902497027348394772e-04,
                1.876524676299493424e-04,
                1.851080568281734235e-04,
                1.826150474799123483e-04,
                1.801720643214269372e-04,
                1.777777777777777321e-04,
                1.754309021534143024e-04,
                1.731301939058171478e-04,
                1.708744499978640625e-04,
                1.686625063248440096e-04,
                1.664932362122788559e-04,
                1.643655489809336316e-04,
                1.622783885756014580e-04,
                1.602307322544464254e-04,
                1.582215893358648873e-04,
                1.562499999999999761e-04,
                1.543150341422013026e-04,
                1.524157902758725843e-04,
                1.505513944822914124e-04,
                1.487209994051159824e-04,
                1.469237832874196559e-04,
                1.451589490492088985e-04,
                1.434257234034924124e-04,
                1.417233560090702985e-04,
                1.400511186583102601e-04,
                1.384083044982699080e-04,
                1.367942272836086327e-04,
                1.352082206598161540e-04,
                1.336496374753583694e-04,
                1.321178491214163096e-04,
                1.306122448979591462e-04,
                1.291322314049586542e-04,
                1.276772319576111904e-04,
                1.262466860244918225e-04,
                1.248400486876190176e-04,
                1.234567901234567659e-04,
                1.220963951039345460e-04,
                1.207583625166042986e-04,
                1.194422049031025141e-04,
                1.181474480151228765e-04,
                1.168736303871438970e-04,
                1.156203029251936447e-04,
                1.143870285109668767e-04,
                1.131733816206428238e-04,
                1.119789479577839160e-04,
                1.108033240997229735e-04,
                1.096461171568761603e-04,
                1.085069444444444249e-04,
                1.073854331659910617e-04,
                1.062812201084068235e-04,
                1.051939513477975036e-04,
                1.041232819658475677e-04,
                1.030688757762374694e-04,
                1.020304050607081169e-04,
                1.010075503143859971e-04,
                9.999999999999997769e-05,
                9.900745031063587596e-05,
                9.802960494069209584e-05,
                9.706617486471402615e-05,
                9.611687812379852839e-05,
                9.518143961927423417e-05,
                9.425959091337544817e-05,
                9.335107003664030003e-05,
                9.245562130177513221e-05,
                9.157299512373799351e-05,
                9.070294784580499052e-05,
                8.984524157139327834e-05,
                8.899964400142399909e-05,
                8.816592827701732668e-05,
                8.734387282732114120e-05,
                8.653326122228232340e-05,
                8.573388203017834731e-05,
                8.494552867973411293e-05,
                8.416799932665599464e-05,
                8.340109672442193897e-05,
                8.264462809917355981e-05,
                8.189840502856208864e-05,
                8.116224332440549868e-05,
                8.043596291902110147e-05,
                7.971938775510206156e-05,
                7.901234567901234645e-05,
                7.831466833737958915e-05,
                7.762619107686932513e-05,
                7.694675284702985250e-05,
                7.627619610610017606e-05,
                7.561436672967863232e-05,
                7.496111392215286905e-05,
                7.431629013079666399e-05,
                7.367975096244176443e-05,
                7.305135510263714401e-05,
                7.243096423721142078e-05,
                7.181844297615628105e-05,
                7.121365877975395779e-05,
                7.061648188687239512e-05,
                7.002678524535636525e-05,
                6.944444444444444438e-05,
                6.886933764914516902e-05,
                6.830134553650707657e-05,
                6.774035123372114256e-05,
                6.718624025799515653e-05,
                6.663890045814243842e-05,
                6.609822195782934359e-05,
                6.556409710042778013e-05,
                6.503642039542144207e-05,
                6.451508846631505846e-05,
                6.400000000000001066e-05,
                6.349105569752859924e-05,
                6.298815822625345698e-05,
                6.249121217328812991e-05,
                6.200012400024800636e-05,
                6.151480199923105817e-05,
                6.103515625000001355e-05,
                6.056109857832821762e-05,
            ];
            ddouble[] expected_dist_c2 = [
                0.000000000000000000e+00,
                6.400000000000000133e-01,
                5.000000000000000000e-01,
                2.840236686390532617e-01,
                1.600000000000000033e-01,
                9.512485136741974379e-02,
                5.999999999999999084e-02,
                3.987184051263794465e-02,
                2.768166089965398008e-02,
                1.993079584775086371e-02,
                1.479289940828402289e-02,
                1.126400000000000318e-02,
                8.765522279035794020e-03,
                6.949781148718634990e-03,
                5.599999999999999943e-03,
                4.576571766366012081e-03,
                3.786982248520710023e-03,
                3.168353737376090364e-03,
                2.676977989292087575e-03,
                2.281854006380184402e-03,
                1.960592098813841808e-03,
                1.696755460169170875e-03,
                1.478097285675893796e-03,
                1.295368704877696659e-03,
                1.141498216409036863e-03,
                1.011017563902628924e-03,
                8.996539792387542528e-04,
                8.040365613291914054e-04,
                7.214821304336624212e-04,
                6.498371905745597196e-04,
                5.873600125303469728e-04,
                5.326317485033155250e-04,
                4.844887886266256868e-04,
                4.419708215551178525e-04,
                4.042806183115337806e-04,
                3.707526477366544239e-04,
                3.408284023668638912e-04,
                3.140368643206910954e-04,
                2.899789383718446179e-04,
                2.683149690943295433e-04,
                2.487546719236821235e-04,
                2.310489658269421600e-04,
                2.149833131999754742e-04,
                2.003722613728004226e-04,
                1.870549473907960776e-04,
                1.748913790938245994e-04,
                1.637593449626201301e-04,
                1.535518356897345971e-04,
                1.441748841344550798e-04,
                1.355457488513621227e-04,
                1.275913809470342582e-04,
                1.202471255263574588e-04,
                1.134556181258440790e-04,
                1.071658438191783576e-04,
                1.013323325201726497e-04,
                9.591446870850404646e-05,
                9.087589760233681809e-05,
                8.618401288450993323e-05,
                8.180951360012637919e-05,
                7.772601989670837978e-05,
                7.390973896312028188e-05,
                7.033917391108509610e-05,
                6.699486948967198273e-05,
                6.385918947357285803e-05,
                6.091612135633551420e-05,
                5.815110463894286851e-05,
                5.555087955559295186e-05,
                5.310335354117383784e-05,
                5.079748313411507310e-05,
                4.862316933657340775e-05,
                4.657116473152388462e-05,
                4.463299089168740316e-05,
                4.280086481525185126e-05,
                4.106763329374127158e-05,
                3.942671426288028500e-05,
                3.787204431180672562e-05,
                3.639803163276302494e-05,
                3.499951378516360568e-05,
                3.367171972696552908e-05,
                3.241023563446432951e-05,
                3.121097409059999121e-05,
                3.007014627293182139e-05,
                2.898423681676731272e-05,
                2.794998106746576403e-05,
                2.696434446950059030e-05,
                2.602450386914527037e-05,
                2.512783053323594008e-05,
                2.427187470886173724e-05,
                2.345435156846977710e-05,
                2.267312840211366349e-05,
                2.192621293373704194e-05,
                2.121174265173734848e-05,
                2.052797505583274143e-05,
                1.987327873265751048e-05,
                1.924612518171208453e-05,
                1.864508132144216974e-05,
                1.806880261244771225e-05,
                1.751602674123949179e-05,
                1.698556781366624105e-05,
                1.647631101221395104e-05,
                1.598720767590604828e-05,
                1.551727076557230396e-05,
                1.506557068086335841e-05,
                1.463123139861547993e-05,
                1.421342690506045679e-05,
                1.381137789696631709e-05,
                1.342434872911943800e-05,
                1.305164458764727861e-05,
                1.269260887055877538e-05,
                1.234662075857029098e-05,
                1.201309296080805090e-05,
                1.169146962135207561e-05,
                1.138122437382688434e-05,
                1.108185853236511998e-05,
                1.079289940828402286e-05,
                1.051389874273255658e-05,
                1.024443124639844320e-05,
                9.984093238118717679e-06,
                9.732501374922017067e-06,
                9.489291466652479746e-06,
                9.254117368890942658e-06,
                9.026649948403326203e-06,
                8.806576115814851159e-06,
                8.593597920635755245e-06,
                8.387431704153639248e-06,
                8.187807306063157121e-06,
                7.994467321028621886e-06,
                7.807166401671896143e-06,
                7.625670604749637061e-06,
                7.449756777532629175e-06,
                7.279211981627717334e-06,
                7.113832951691696600e-06,
                6.953425586678163010e-06,
                6.797804471434142683e-06,
                6.646792426624868794e-06,
                6.500220085113702261e-06,
                6.357925493060628691e-06,
                6.219753734128607796e-06,
                6.085556575302766358e-06,
                5.955192132934134201e-06,
                5.828524557718026662e-06,
                5.705423737407871420e-06,
                5.585765016149154980e-06,
                5.469428929395454173e-06,
                5.356300953440167694e-06,
                5.246271268663561826e-06,
                5.139234535656080680e-06,
                5.035089683435411601e-06,
                4.933739709027366605e-06,
                4.835091487729154569e-06,
                4.739055593418853803e-06,
                4.645546128316579697e-06,
                4.554480561641762427e-06,
                4.465779576646977431e-06,
                4.379366925542230823e-06,
                4.295169291854799037e-06,
                4.213116159798635403e-06,
                4.133139690254318312e-06,
                4.055174602985574218e-06,
                3.979158064741793632e-06,
                3.905029582917701582e-06,
                3.832730904461632996e-06,
                3.762205919742765451e-06,
                3.693400571105374424e-06,
                3.626262765854534528e-06,
                3.560742293433189650e-06,
                3.496790746564823823e-06,
                3.434361446149401584e-06,
                3.373409369712795765e-06,
                3.313891083221714363e-06,
                3.255764676087037294e-06,
                3.198989699188861454e-06,
                3.143527105766107862e-06,
                3.089339195022604973e-06,
                3.036389558310022825e-06,
                2.984643027755941428e-06,
                2.934065627212791544e-06,
                2.884624525410383871e-06,
                2.836287991201260971e-06,
                2.789025350794314200e-06,
                2.742806946877818168e-06,
                2.697604099538517669e-06,
                2.653389068888453308e-06,
                2.610135019316055397e-06,
                2.567815985282506738e-06,
                2.526406838588646070e-06,
                2.485883257041665477e-06,
                2.446221694454615819e-06,
                2.407399351915289296e-06,
                2.369394150264367753e-06,
                2.332184703725883495e-06,
                2.295750294635999778e-06,
                2.260070849218914180e-06,
                2.225126914361334193e-06,
                2.190899635339436711e-06,
                2.157370734454621446e-06,
                2.124522490536526128e-06,
                2.092337719273914776e-06,
                2.060799754336016261e-06,
                2.029892429248742022e-06,
                1.999600059992001141e-06,
                1.969907428286005574e-06,
                1.940799765536016011e-06,
                1.912262737406499291e-06,
                1.884282428997074777e-06,
                1.856845330593962433e-06,
                1.829938323971925247e-06,
                1.803548669222889113e-06,
                1.777663992088574844e-06,
                1.752272271775543194e-06,
                1.727361829232087975e-06,
                1.702921315867376730e-06,
                1.678939702694149590e-06,
                1.655406269877185669e-06,
                1.632310596670544237e-06,
                1.609642551727387315e-06,
                1.587392283766947992e-06,
                1.565550212583885342e-06,
                1.544107020385981073e-06,
                1.523053643446731055e-06,
                1.502381264060026488e-06,
                1.482081302784673011e-06,
                1.462145410967054895e-06,
                1.442565463530777036e-06,
                1.423333552022603016e-06,
                1.404441977904490759e-06,
                1.385883246081967102e-06,
                1.367650058659516098e-06,
                1.349735308914068340e-06,
                1.332132075478043493e-06,
                1.314833616723805181e-06,
                1.297833365341698702e-06,
                1.281124923104203466e-06,
                1.264702055809049957e-06,
                1.248558688394433449e-06,
                1.232688900219784128e-06,
                1.217086920505787248e-06,
                1.201747123927648902e-06,
                1.186664026355827906e-06,
                1.171832280738715371e-06,
                1.157246673121949363e-06,
                1.142902118799295815e-06,
                1.128793658590219512e-06,
                1.114916455239474199e-06,
                1.101265789934227616e-06,
                1.087837058934428060e-06,
                1.074625770312283832e-06,
                1.061627540796893978e-06,
                1.048838092720239660e-06,
                1.036253251060876753e-06,
                1.023868940581838196e-06,
                1.011681183059370889e-06,
                9.996860945992873436e-07,
                9.878798830378232784e-07,
                9.762588454240174678e-07,
                9.648193655807510995e-07,

            ];
            ddouble[] expected_dist_c3 = [
                0.000000000000000000e+00,
                5.925925925925925597e-01,
                7.500000000000000000e-01,
                3.526530612244898055e-01,
                1.481481481481481399e-01,
                6.783876985697324946e-02,
                3.443877551020408517e-02,
                1.909075413348918296e-02,
                1.136094674556212963e-02,
                7.157993184441673387e-03,
                4.724111866969010060e-03,
                3.239406532691624548e-03,
                2.293529274352821591e-03,
                1.668440618877936729e-03,
                1.242225527312060566e-03,
                9.436691551863052741e-04,
                7.295692121792460771e-04,
                5.728386994496790499e-04,
                4.559954963407769645e-04,
                3.674636161079101342e-04,
                2.994008988014983021e-04,
                2.463848855257155172e-04,
                2.045964883802721813e-04,
                1.713006337253181969e-04,
                1.445086221805347466e-04,
                1.227542674508356590e-04,
                1.049427844487626604e-04,
                9.024709296593879889e-05,
                7.803557387002698633e-05,
                6.782102994557035608e-05,
                5.922415826239303937e-05,
                5.194709246741583401e-05,
                4.575402362849782236e-05,
                4.045685707718595651e-05,
                3.590449255894922174e-05,
                3.197473884263633256e-05,
                2.856816279879117310e-05,
                2.560337217919180164e-05,
                2.301337027939039245e-05,
                2.074271860435925101e-05,
                1.874531337875979528e-05,
                1.698263184569986356e-05,
                1.542234062310732522e-05,
                1.403718494609184406e-05,
                1.280409719822984847e-05,
                1.170347767137666014e-05,
                1.071861136722311230e-05,
                9.835192843555273993e-06,
                9.040937317083537638e-06,
                8.325260971451379331e-06,
                7.679017054363787849e-06,
                7.094277153817197500e-06,
                6.564149221250602432e-06,
                6.082625608615988341e-06,
                5.644455718788062942e-06,
                5.245038918629295194e-06,
                4.880334195159820026e-06,
                4.546783696184270715e-06,
                4.241247824532366976e-06,
                3.960949978332437014e-06,
                3.703429370522033612e-06,
                3.466500636238444806e-06,
                3.248219160183718192e-06,
                3.046851237987685345e-06,
                2.860848334229290114e-06,
                2.688824821621392823e-06,
                2.529538686070919557e-06,
                2.381874764996615528e-06,
                2.244830154697310974e-06,
                2.117501479341032002e-06,
                1.999073761402618957e-06,
                1.888810672819934020e-06,
                1.786045979147245409e-06,
                1.690176016680537145e-06,
                1.600653065827277258e-06,
                1.516979503639254196e-06,
                1.438702635033593130e-06,
                1.365410116296849836e-06,
                1.296725896414705141e-06,
                1.232306611937610405e-06,
                1.171838379764538859e-06,
                1.115033939638225027e-06,
                1.061630104492165176e-06,
                1.011385482235742215e-06,
                9.640784372460360016e-07,
                9.195052638679332487e-07,
                8.774785477043935153e-07,
                8.378256934873648368e-07,
                8.003876009252948856e-07,
                7.650174721833483734e-07,
                7.315797366163525094e-07,
                6.999490800837614095e-07,
                6.700095676659100060e-07,
                6.416538499017374231e-07,
                6.147824438056451948e-07,
                5.893030809172798962e-07,
                5.651301155116004612e-07,
                5.421839868637864203e-07,
                5.203907301382488705e-07,
                4.996815310651966355e-07,
                4.799923200921591405e-07,
                4.612634021605221088e-07,
                4.434391186661576201e-07,
                4.264675385252987014e-07,
                4.103001755877224537e-07,
                3.948917299240656535e-07,
                3.801998507670783988e-07,
                3.661849191116434592e-07,
                3.528098481787495467e-07,
                3.400399001272229995e-07,
                3.278425175564172412e-07,
                3.161871684854615530e-07,
                3.050452036220180738e-07,
                2.943897248475057859e-07,
                2.841954639479134299e-07,
                2.744386707109697111e-07,
                2.650970095927293185e-07,
                2.561494642305894091e-07,
                2.475762491462851273e-07,
                2.393587280423247396e-07,
                2.314793381493149543e-07,
                2.239215201303379268e-07,
                2.166696530925129972e-07,
                2.097089942956176684e-07,
                2.030256231835759848e-07,
                1.966063893971595234e-07,
                1.904388644557106989e-07,
                1.845112968224192736e-07,
                1.788125700919254448e-07,
                1.733321640610359957e-07,
                1.680601184633491661e-07,
                1.629869991667736391e-07,
                1.581038666494915375e-07,
                1.534022465849934633e-07,
                1.488741023805632340e-07,
                1.445118095261267191e-07,
                1.403081316218262230e-07,
                1.362561979631310410e-07,
                1.323494825718539830e-07,
                1.285817845701780217e-07,
                1.249472098027958617e-07,
                1.214401536195908432e-07,
                1.180552847379970084e-07,
                1.147875301103313462e-07,
                1.116320607270397413e-07,
                1.085842782919803210e-07,
                1.056398027106319972e-07,
                1.027944603364941895e-07,
                1.000442729249694411e-07,
                9.738544724772702942e-08,
                9.481436532395757600e-08,
                9.232757522807235424e-08,
                8.992178243629859069e-08,
                8.759384167729646725e-08,
                8.534074925438800122e-08,
                8.315963580926765009e-08,
                8.104775949916695630e-08,
                7.900249956139189620e-08,
                7.702135024094868394e-08,
                7.510191505863863755e-08,
                7.324190139854328199e-08,
                7.143911539524683066e-08,
                6.969145710246612016e-08,
                6.799691592598280315e-08,
                6.635356630490994444e-08,
                6.475956362637954948e-08,
                6.321314035971741266e-08,
                6.171260239708022161e-08,
                6.025632558837610559e-08,
                5.884275245907467844e-08,
                5.747038910024351641e-08,
                5.613780222082844353e-08,
                5.484361635282683076e-08,
                5.358651120059331188e-08,
                5.236521912606605731e-08,
                5.117852276221367292e-08,
                5.002525274747924644e-08,
                4.890428557444431197e-08,
                4.781454154634941732e-08,
                4.675498283549734286e-08,
                4.572461163792500298e-08,
                4.472246841907065445e-08,
                4.374763024547709335e-08,
                4.279920919786873157e-08,
                4.187635086121580883e-08,
                4.097823288765821498e-08,
                4.010406362840370148e-08,
                3.925308083094104827e-08,
                3.842455039812255536e-08,
                3.761776520586782506e-08,
                3.683204397642821392e-08,
                3.606673020432578203e-08,
                3.532119113224488544e-08,
                3.459481677430835342e-08,
                3.388701898431453178e-08,
                3.319723056664752858e-08,
                3.252490442769994048e-08,
                3.186951276576751784e-08,
                3.123054629748718693e-08,
                3.060751351899632249e-08,
                2.999994000009000853e-08,
                2.940736770974693349e-08,
                2.882935437148267384e-08,
                2.826547284707182166e-08,
                2.771531054725853742e-08,
                2.717846886814884720e-08,
                2.665456265204695422e-08,
                2.614321967156332730e-08,
                2.564408013588378510e-08,
                2.515679621814693586e-08,
                2.468103160293189992e-08,
                2.421646105291021544e-08,
                2.376276999376405931e-08,
                2.331965411651956474e-08,
                2.288681899648699730e-08,
                2.246397972804085730e-08,
                2.205086057451157288e-08,
                2.164719463249735973e-08,
                2.125272350993922820e-08,
                2.086719701733508921e-08,
                2.049037287149972850e-08,
                2.012201641130682615e-08,
                1.976190032487705477e-08,
                1.940980438770226310e-08,
                1.906551521122099397e-08,
                1.872882600138377319e-08,
                1.839953632676917803e-08,
                1.807745189583272740e-08,
                1.776238434289061401e-08,
                1.745415102245942318e-08,
                1.715257481159085006e-08,
                1.685748391985760590e-08,
                1.656871170666285058e-08,
                1.628609650556077498e-08,
                1.600948145529084579e-08,
                1.573871433724158636e-08,
                1.547364741907343850e-08,
                1.521413730424227406e-08,
                1.496004478717734460e-08,
                1.471123471387851296e-08,
                1.446757584770829665e-08,
                1.422894074016469649e-08,
                1.399520560643012152e-08,
                1.376625020550110114e-08,
                1.354195772471226516e-08,
                1.332221466847630309e-08,
                1.310691075106951807e-08,
                1.289593879330026434e-08,
                1.268919462290460750e-08,
                1.248657697852042442e-08,
                1.228798741709766432e-08,
                1.209333022460869324e-08,
                1.190251232992857328e-08,
                1.171544322176068009e-08,
                1.153203486848852132e-08,
                1.135220164083961522e-08,

            ];

            foreach ((FiskDistribution dist, ddouble[] expecteds) in new[]{
                (dist_c1, expected_dist_c1),
                (dist_c2, expected_dist_c2),
                (dist_c3, expected_dist_c3),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist_c1 = [
                0.000000000000000000e+00,
                3.333333333333333148e-01,
                5.000000000000000000e-01,
                6.000000000000000888e-01,
                6.666666666666666297e-01,
                7.142857142857143016e-01,
                7.500000000000000000e-01,
                7.777777777777779011e-01,
                8.000000000000000444e-01,
                8.181818181818181213e-01,
                8.333333333333333703e-01,
                8.461538461538461453e-01,
                8.571428571428570953e-01,
                8.666666666666666963e-01,
                8.750000000000000000e-01,
                8.823529411764705621e-01,
                8.888888888888888395e-01,
                8.947368421052631637e-01,
                8.999999999999999112e-01,
                9.047619047619048782e-01,
                9.090909090909090606e-01,
                9.130434782608695121e-01,
                9.166666666666667407e-01,
                9.200000000000000400e-01,
                9.230769230769231282e-01,
                9.259259259259258190e-01,
                9.285714285714286031e-01,
                9.310344827586207739e-01,
                9.333333333333333481e-01,
                9.354838709677419928e-01,
                9.375000000000000000e-01,
                9.393939393939394478e-01,
                9.411764705882352811e-01,
                9.428571428571429491e-01,
                9.444444444444444198e-01,
                9.459459459459459429e-01,
                9.473684210526315264e-01,
                9.487179487179487891e-01,
                9.500000000000000666e-01,
                9.512195121951219079e-01,
                9.523809523809523281e-01,
                9.534883720930231732e-01,
                9.545454545454544748e-01,
                9.555555555555554914e-01,
                9.565217391304348116e-01,
                9.574468085106382365e-01,
                9.583333333333333703e-01,
                9.591836734693877098e-01,
                9.599999999999999645e-01,
                9.607843137254901134e-01,
                9.615384615384614531e-01,
                9.622641509433961238e-01,
                9.629629629629629095e-01,
                9.636363636363636243e-01,
                9.642857142857143016e-01,
                9.649122807017543879e-01,
                9.655172413793102759e-01,
                9.661016949152541056e-01,
                9.666666666666665630e-01,
                9.672131147540984353e-01,
                9.677419354838708854e-01,
                9.682539682539682557e-01,
                9.687500000000000000e-01,
                9.692307692307693401e-01,
                9.696969696969697239e-01,
                9.701492537313434195e-01,
                9.705882352941176405e-01,
                9.710144927536230597e-01,
                9.714285714285715301e-01,
                9.718309859154929953e-01,
                9.722222222222223209e-01,
                9.726027397260273988e-01,
                9.729729729729730270e-01,
                9.733333333333332726e-01,
                9.736842105263158187e-01,
                9.740259740259741283e-01,
                9.743589743589742280e-01,
                9.746835443037974445e-01,
                9.750000000000000888e-01,
                9.753086419753087544e-01,
                9.756097560975610650e-01,
                9.759036144578312477e-01,
                9.761904761904761640e-01,
                9.764705882352940902e-01,
                9.767441860465116976e-01,
                9.770114942528735913e-01,
                9.772727272727271819e-01,
                9.775280898876405056e-01,
                9.777777777777777457e-01,
                9.780219780219779890e-01,
                9.782608695652175168e-01,
                9.784946236559141086e-01,
                9.787234042553190072e-01,
                9.789473684210526772e-01,
                9.791666666666667407e-01,
                9.793814432989690344e-01,
                9.795918367346939659e-01,
                9.797979797979798899e-01,
                9.799999999999999822e-01,
                9.801980198019802915e-01,
                9.803921568627450567e-01,
                9.805825242718446688e-01,
                9.807692307692308376e-01,
                9.809523809523809090e-01,
                9.811320754716982284e-01,
                9.813084112149533800e-01,
                9.814814814814815103e-01,
                9.816513761467889898e-01,
                9.818181818181817011e-01,
                9.819819819819820550e-01,
                9.821428571428572063e-01,
                9.823008849557521849e-01,
                9.824561403508772495e-01,
                9.826086956521739024e-01,
                9.827586206896551380e-01,
                9.829059829059829667e-01,
                9.830508474576271638e-01,
                9.831932773109244295e-01,
                9.833333333333333925e-01,
                9.834710743801653443e-01,
                9.836065573770492731e-01,
                9.837398373983740063e-01,
                9.838709677419354982e-01,
                9.839999999999998748e-01,
                9.841269841269841834e-01,
                9.842519685039370358e-01,
                9.843750000000000000e-01,
                9.844961240310077244e-01,
                9.846153846153846700e-01,
                9.847328244274808906e-01,
                9.848484848484848619e-01,
                9.849624060150375948e-01,
                9.850746268656717097e-01,
                9.851851851851850528e-01,
                9.852941176470587648e-01,
                9.854014598540146164e-01,
                9.855072463768116409e-01,
                9.856115107913668849e-01,
                9.857142857142856540e-01,
                9.858156028368795232e-01,
                9.859154929577464976e-01,
                9.860139860139860435e-01,
                9.861111111111111605e-01,
                9.862068965517242214e-01,
                9.863013698630137549e-01,
                9.863945578231292366e-01,
                9.864864864864864025e-01,
                9.865771812080537106e-01,
                9.866666666666665808e-01,
                9.867549668874172619e-01,
                9.868421052631578538e-01,
                9.869281045751633341e-01,
                9.870129870129871197e-01,
                9.870967741935484652e-01,
                9.871794871794873361e-01,
                9.872611464968152895e-01,
                9.873417721518987777e-01,
                9.874213836477987449e-01,
                9.874999999999999334e-01,
                9.875776397515527716e-01,
                9.876543209876543772e-01,
                9.877300613496932113e-01,
                9.878048780487804770e-01,
                9.878787878787879118e-01,
                9.879518072289156239e-01,
                9.880239520958082888e-01,
                9.880952380952381375e-01,
                9.881656804733727206e-01,
                9.882352941176471006e-01,
                9.883040935672513516e-01,
                9.883720930232559043e-01,
                9.884393063583816197e-01,
                9.885057471264367956e-01,
                9.885714285714284344e-01,
                9.886363636363635354e-01,
                9.887005649717515166e-01,
                9.887640449438200863e-01,
                9.888268156424582234e-01,
                9.888888888888888173e-01,
                9.889502762430938398e-01,
                9.890109890109890500e-01,
                9.890710382513661081e-01,
                9.891304347826087584e-01,
                9.891891891891891886e-01,
                9.892473118279568878e-01,
                9.893048128342246672e-01,
                9.893617021276596146e-01,
                9.894179894179894186e-01,
                9.894736842105262831e-01,
                9.895287958115182025e-01,
                9.895833333333332593e-01,
                9.896373056994819395e-01,
                9.896907216494844617e-01,
                9.897435897435896690e-01,
                9.897959183673469274e-01,
                9.898477157360406897e-01,
                9.898989898989899450e-01,
                9.899497487437185494e-01,
                9.899999999999999911e-01,
                9.900497512437810288e-01,
                9.900990099009900902e-01,
                9.901477832512315391e-01,
                9.901960784313725839e-01,
                9.902439024390243816e-01,
                9.902912621359223344e-01,
                9.903381642512076866e-01,
                9.903846153846154188e-01,
                9.904306220095693281e-01,
                9.904761904761905100e-01,
                9.905213270142179116e-01,
                9.905660377358490587e-01,
                9.906103286384975171e-01,
                9.906542056074765235e-01,
                9.906976744186047901e-01,
                9.907407407407408106e-01,
                9.907834101382488878e-01,
                9.908256880733944394e-01,
                9.908675799086757996e-01,
                9.909090909090909616e-01,
                9.909502262443440346e-01,
                9.909909909909910830e-01,
                9.910313901345292331e-01,
                9.910714285714287142e-01,
                9.911111111111110539e-01,
                9.911504424778760924e-01,
                9.911894273127752619e-01,
                9.912280701754385692e-01,
                9.912663755458515080e-01,
                9.913043478260868957e-01,
                9.913419913419913021e-01,
                9.913793103448276245e-01,
                9.914163090128755851e-01,
                9.914529914529914834e-01,
                9.914893617021277583e-01,
                9.915254237288135819e-01,
                9.915611814345991482e-01,
                9.915966386554622147e-01,
                9.916317991631800055e-01,
                9.916666666666666963e-01,
                9.917012448132781488e-01,
                9.917355371900826722e-01,
                9.917695473251029181e-01,
                9.918032786885245811e-01,
                9.918367346938775642e-01,
                9.918699186991870587e-01,
                9.919028340080970896e-01,
                9.919354838709678601e-01,
                9.919678714859436752e-01,
                9.919999999999999929e-01,
                9.920318725099600554e-01,
                9.920634920634920917e-01,
                9.920948616600790970e-01,
                9.921259842519685179e-01,
                9.921568627450980671e-01,
                9.921875000000000000e-01,
                9.922178988326848526e-01,

            ];
            ddouble[] expected_dist_c2 = [
                0.000000000000000000e+00,
                2.000000000000000111e-01,
                5.000000000000000000e-01,
                6.923076923076922906e-01,
                8.000000000000000444e-01,
                8.620689655172414367e-01,
                8.999999999999999112e-01,
                9.245283018867923586e-01,
                9.411764705882352811e-01,
                9.529411764705882915e-01,
                9.615384615384614531e-01,
                9.680000000000000826e-01,
                9.729729729729730270e-01,
                9.768786127167631284e-01,
                9.799999999999999822e-01,
                9.825327510917031271e-01,
                9.846153846153846700e-01,
                9.863481228668942169e-01,
                9.878048780487804770e-01,
                9.890410958904111149e-01,
                9.900990099009900902e-01,
                9.910112359550562466e-01,
                9.918032786885245811e-01,
                9.924953095684801996e-01,
                9.931034482758620552e-01,
                9.936406995230524508e-01,
                9.941176470588235503e-01,
                9.945429740791268403e-01,
                9.949238578680204004e-01,
                9.952662721893491549e-01,
                9.955752212389380462e-01,
                9.958549222797927758e-01,
                9.961089494163424263e-01,
                9.963403476669716596e-01,
                9.965517241379310276e-01,
                9.967453213995117745e-01,
                9.969230769230769118e-01,
                9.970866715222141963e-01,
                9.972375690607735432e-01,
                9.973770491803278793e-01,
                9.975062344139651316e-01,
                9.976261127596438572e-01,
                9.977375565610860919e-01,
                9.978413383702103845e-01,
                9.979381443298969145e-01,
                9.980285855101034276e-01,
                9.981132075471698117e-01,
                9.981924988703116952e-01,
                9.982668977469669747e-01,
                9.983367983367982257e-01,
                9.984025559105430547e-01,
                9.984644913627638285e-01,
                9.985228951255538110e-01,
                9.985780305723426231e-01,
                9.986301369863014310e-01,
                9.986794321558269960e-01,
                9.987261146496816400e-01,
                9.987703658161697362e-01,
                9.988123515439429889e-01,
                9.988522238163557443e-01,
                9.988901220865705755e-01,
                9.989261744966443368e-01,
                9.989604989604989882e-01,
                9.989932041278630770e-01,
                9.990243902439024382e-01,
                9.990541499172381767e-01,
                9.990825688073393662e-01,
                9.991097262408190627e-01,
                9.991356957649092374e-01,
                9.991605456453305223e-01,
                9.991843393148449604e-01,
                9.992071357779981344e-01,
                9.992289899768697081e-01,
                9.992499531220699893e-01,
                9.992700729927007641e-01,
                9.992893942085627756e-01,
                9.993079584775087509e-01,
                9.993258048204954891e-01,
                9.993429697766097464e-01,
                9.993594875900719821e-01,
                9.993753903810117523e-01,
                9.993907083015994841e-01,
                9.994054696789537173e-01,
                9.994197011460902447e-01,
                9.994334277620395834e-01,
                9.994466731221468558e-01,
                9.994594594594594650e-01,
                9.994718077380165822e-01,
                9.994837377387711941e-01,
                9.994952681388011850e-01,
                9.995064165844028681e-01,
                9.995171997585997614e-01,
                9.995276334435521104e-01,
                9.995377325782967004e-01,
                9.995475113122171962e-01,
                9.995569830546017220e-01,
                9.995661605206074274e-01,
                9.995750557739295772e-01,
                9.995836802664446186e-01,
                9.995920448750638121e-01,
                9.996001599360255785e-01,
                9.996080352768250687e-01,
                9.996156802459646995e-01,
                9.996231037406954067e-01,
                9.996303142329020508e-01,
                9.996373197932723054e-01,
                9.996441281138789270e-01,
                9.996507465292936434e-01,
                9.996571820363385763e-01,
                9.996634413125788932e-01,
                9.996695307336418423e-01,
                9.996754563894524326e-01,
                9.996812240994581433e-01,
                9.996868394269162739e-01,
                9.996923076923076579e-01,
                9.996976339859399152e-01,
                9.997028231797920883e-01,
                9.997078799386547310e-01,
                9.997128087306146327e-01,
                9.997176138369219256e-01,
                9.997222993612885356e-01,
                9.997268692386480637e-01,
                9.997313272434176223e-01,
                9.997356769972906010e-01,
                9.997399219765930045e-01,
                9.997440655192270098e-01,
                9.997481108312342712e-01,
                9.997520609929956281e-01,
                9.997559189650964129e-01,
                9.997596875938720151e-01,
                9.997633696166587924e-01,
                9.997669676667638727e-01,
                9.997704842781729440e-01,
                9.997739218900131286e-01,
                9.997772828507796028e-01,
                9.997805694223490525e-01,
                9.997837837837838526e-01,
                9.997869280349437338e-01,
                9.997900041999160381e-01,
                9.997930142302717815e-01,
                9.997959600081617326e-01,
                9.997988433492581706e-01,
                9.998016660055534244e-01,
                9.998044296680193010e-01,
                9.998071359691418358e-01,
                9.998097864853298100e-01,
                9.998123827392121354e-01,
                9.998149262018228844e-01,
                9.998174182946868438e-01,
                9.998198603918035943e-01,
                9.998222538215427724e-01,
                9.998245998684499591e-01,
                9.998268997749696352e-01,
                9.998291547430913084e-01,
                9.998313659359190364e-01,
                9.998335344791711154e-01,
                9.998356614626130456e-01,
                9.998377479414271018e-01,
                9.998397949375200655e-01,
                9.998418034407751120e-01,
                9.998437744102482982e-01,
                9.998457087753135353e-01,
                9.998476074367570465e-01,
                9.998494712678281937e-01,
                9.998513011152416752e-01,
                9.998530978001395342e-01,
                9.998548621190129770e-01,
                9.998565948445847784e-01,
                9.998582967266543831e-01,
                9.998599684929110332e-01,
                9.998616108497094812e-01,
                9.998632244828175031e-01,
                9.998648100581316589e-01,
                9.998663682223632998e-01,
                9.998678996036988176e-01,
                9.998694048124328049e-01,
                9.998708844415752361e-01,
                9.998723390674368883e-01,
                9.998737692501892260e-01,
                9.998751755344048586e-01,
                9.998765584495742376e-01,
                9.998779185106059231e-01,
                9.998792562183046462e-01,
                9.998805720598333835e-01,
                9.998818665091552260e-01,
                9.998831400274620362e-01,
                9.998843930635838984e-01,
                9.998856260543848018e-01,
                9.998868394251442249e-01,
                9.998880335899230642e-01,
                9.998892089519166859e-01,
                9.998903659037962077e-01,
                9.998915048280351270e-01,
                9.998926260972271773e-01,
                9.998937300743888645e-01,
                9.998948171132555629e-01,
                9.998958875585632899e-01,
                9.998969417463221543e-01,
                9.998979800040808108e-01,
                9.998990026511804796e-01,
                9.999000099990000834e-01,
                9.999010023511941680e-01,
                9.999019800039208317e-01,
                9.999029432460631028e-01,
                9.999038923594426587e-01,
                9.999048276190249940e-01,
                9.999057492931195945e-01,
                9.999066576435721165e-01,
                9.999075529259499051e-01,
                9.999084353897219613e-01,
                9.999093052784326918e-01,
                9.999101628298708855e-01,
                9.999110082762302509e-01,
                9.999118418442686229e-01,
                9.999126637554586194e-01,
                9.999134742261350794e-01,
                9.999142734676382815e-01,
                9.999150616864501684e-01,
                9.999158390843292388e-01,
                9.999166058584385564e-01,
                9.999173622014708718e-01,
                9.999181083017708582e-01,
                9.999188443434507967e-01,
                9.999195705065048179e-01,
                9.999202869669191474e-01,
                9.999209938967784650e-01,
                9.999216914643695997e-01,
                9.999223798342808944e-01,
                9.999230591675002389e-01,
                9.999237296215082171e-01,
                9.999243913503703673e-01,
                9.999250445048253333e-01,
                9.999256892323696855e-01,
                9.999263256773432973e-01,
                9.999269539810080598e-01,
                9.999275742816273738e-01,
                9.999281867145420888e-01,
                9.999287914122443333e-01,
                9.999293885044484576e-01,
                9.999299781181618663e-01,
                9.999305603777515206e-01,
                9.999311354050098855e-01,
                9.999317033192186566e-01,
                9.999322642372107106e-01,
                9.999328182734297243e-01,
                9.999333655399889054e-01,
                9.999339061467283907e-01,
                9.999344402012686484e-01,
                9.999349678090655447e-01,
                9.999354890734617474e-01,
                9.999360040957377960e-01,
                9.999365129751606185e-01,
                9.999370158090318261e-01,
                9.999375126927342317e-01,
                9.999380037197769244e-01,
                9.999384889818387911e-01,

            ];
            ddouble[] expected_dist_c3 = [
                0.000000000000000000e+00,
                1.111111111111111049e-01,
                5.000000000000000000e-01,
                7.714285714285714635e-01,
                8.888888888888888395e-01,
                9.398496240601503793e-01,
                9.642857142857143016e-01,
                9.772079772079772519e-01,
                9.846153846153846700e-01,
                9.891451831750338597e-01,
                9.920634920634920917e-01,
                9.940253920836445989e-01,
                9.953917050691245549e-01,
                9.963718820861677816e-01,
                9.970930232558138373e-01,
                9.976352349985220247e-01,
                9.980506822612085216e-01,
                9.983743141637877461e-01,
                9.986301369863014310e-01,
                9.988350080093200134e-01,
                9.990009990009991458e-01,
                9.991369079728126268e-01,
                9.992492492492492939e-01,
                9.993429158110882504e-01,
                9.994216310005783477e-01,
                9.994882620098508585e-01,
                9.995450409463148000e-01,
                9.995937230206692892e-01,
                9.996357012750455295e-01,
                9.996720908308399656e-01,
                9.997037914691944138e-01,
                9.997315346152555460e-01,
                9.997559189650964129e-01,
                9.997774377521213562e-01,
                9.997964997964998712e-01,
                9.998134458876477559e-01,
                9.998285616320933267e-01,
                9.998420876019027403e-01,
                9.998542274052478751e-01,
                9.998651541456672343e-01,
                9.998750156230471475e-01,
                9.998839385454598716e-01,
                9.998920319585402616e-01,
                9.998993900521915279e-01,
                9.999060944689642794e-01,
                9.999122162114711942e-01,
                9.999178172255096531e-01,
                9.999229517196213113e-01,
                9.999276672694393797e-01,
                9.999320057455144406e-01,
                9.999360040957377960e-01,
                9.999396950075003510e-01,
                9.999431074699892674e-01,
                9.999462672532490881e-01,
                9.999491973176183324e-01,
                9.999519181647164023e-01,
                9.999544481392064199e-01,
                9.999568036889648903e-01,
                9.999589995899960115e-01,
                9.999610491413769564e-01,
                9.999629643346542585e-01,
                9.999647560013922298e-01,
                9.999664339419978010e-01,
                9.999680070384515673e-01,
                9.999694833531691529e-01,
                9.999708702158880413e-01,
                9.999721743001837027e-01,
                9.999734016909874734e-01,
                9.999745579442818055e-01,
                9.999756481399745267e-01,
                9.999766769288179757e-01,
                9.999776485741186383e-01,
                9.999785669888763273e-01,
                9.999794357689094637e-01,
                9.999802582224502912e-01,
                9.999810373966241395e-01,
                9.999817761011791095e-01,
                9.999824769297828153e-01,
                9.999831422791638502e-01,
                9.999837743663383405e-01,
                9.999843752441367473e-01,
                9.999849468152165466e-01,
                9.999854908447228796e-01,
                9.999860089717469425e-01,
                9.999865027197020195e-01,
                9.999869735057389519e-01,
                9.999874226492931895e-01,
                9.999878513798553525e-01,
                9.999882608440452403e-01,
                9.999886521120547878e-01,
                9.999890261835261418e-01,
                9.999893839929191452e-01,
                9.999897264144158582e-01,
                9.999900542664088565e-01,
                9.999903683156110556e-01,
                9.999906692808232522e-01,
                9.999909578363910256e-01,
                9.999912346153804199e-01,
                9.999915002124947216e-01,
                9.999917551867604226e-01,
                9.999920000639994644e-01,
                9.999922353391070828e-01,
                9.999924614781533494e-01,
                9.999926789203238409e-01,
                9.999928880797104291e-01,
                9.999930893469691773e-01,
                9.999932830908527803e-01,
                9.999934696596304295e-01,
                9.999936493824024275e-01,
                9.999938225703203232e-01,
                9.999939895177188953e-01,
                9.999941505031664235e-01,
                9.999943057904415733e-01,
                9.999944556294418918e-01,
                9.999946002570276882e-01,
                9.999947398978094038e-01,
                9.999948747648798042e-01,
                9.999950050604982099e-01,
                9.999951309767260987e-01,
                9.999952526960235177e-01,
                9.999953703918037506e-01,
                9.999954842289519030e-01,
                9.999955943643107359e-01,
                9.999957009471349689e-01,
                9.999958041195153857e-01,
                9.999959040167770707e-01,
                9.999960007678525553e-01,
                9.999960944956308717e-01,
                9.999961853172862902e-01,
                9.999962733445846297e-01,
                9.999963586841741359e-01,
                9.999964414378548216e-01,
                9.999965217028350395e-01,
                9.999965995719710676e-01,
                9.999966751339922633e-01,
                9.999967484737131151e-01,
                9.999968196722354152e-01,
                9.999968888071337769e-01,
                9.999969559526346030e-01,
                9.999970211797839514e-01,
                9.999970845566048538e-01,
                9.999971461482454194e-01,
                9.999972060171214983e-01,
                9.999972642230479103e-01,
                9.999973208233645661e-01,
                9.999973758730551499e-01,
                9.999974294248594742e-01,
                9.999974815293790620e-01,
                9.999975322351780660e-01,
                9.999975815888780817e-01,
                9.999976296352481864e-01,
                9.999976764172910926e-01,
                9.999977219763223069e-01,
                9.999977663520481785e-01,
                9.999978095826378421e-01,
                9.999978517047931614e-01,
                9.999978927538124562e-01,
                9.999979327636545623e-01,
                9.999979717669965629e-01,
                9.999980097952899660e-01,
                9.999980468788147725e-01,
                9.999980830467288806e-01,
                9.999981183271176022e-01,
                9.999981527470382936e-01,
                9.999981863325648757e-01,
                9.999982191088286898e-01,
                9.999982511000580221e-01,
                9.999982823296161838e-01,
                9.999983128200369276e-01,
                9.999983425930588643e-01,
                9.999983716696574376e-01,
                9.999984000700767872e-01,
                9.999984278138593918e-01,
                9.999984549198731587e-01,
                9.999984814063391791e-01,
                9.999985072908579298e-01,
                9.999985325904326983e-01,
                9.999985573214943413e-01,
                9.999985814999219347e-01,
                9.999986051410664212e-01,
                9.999986282597691511e-01,
                9.999986508703824217e-01,
                9.999986729867881285e-01,
                9.999986946224153073e-01,
                9.999987157902577861e-01,
                9.999987365028893960e-01,
                9.999987567724819559e-01,
                9.999987766108174858e-01,
                9.999987960293046374e-01,
                9.999988150389919062e-01,
                9.999988336505803987e-01,
                9.999988518744370447e-01,
                9.999988697206062538e-01,
                9.999988871988221284e-01,
                9.999989043185190107e-01,
                9.999989210888425850e-01,
                9.999989375186597584e-01,
                9.999989536165692083e-01,
                9.999989693909100419e-01,
                9.999989848497710110e-01,
                9.999990000010000601e-01,
                9.999990148522113209e-01,
                9.999990294107939937e-01,
                9.999990436839206742e-01,
                9.999990576785533491e-01,
                9.999990714014513893e-01,
                9.999990848591781001e-01,
                9.999990980581078270e-01,
                9.999991110044316178e-01,
                9.999991237041639947e-01,
                9.999991361631476172e-01,
                9.999991483870609432e-01,
                9.999991603814220031e-01,
                9.999991721515936183e-01,
                9.999991837027895070e-01,
                9.999991950400783924e-01,
                9.999992061683891098e-01,
                9.999992170925146029e-01,
                9.999992278171162541e-01,
                9.999992383467287693e-01,
                9.999992486857636198e-01,
                9.999992588385129277e-01,
                9.999992688091534632e-01,
                9.999992786017498636e-01,
                9.999992882202587419e-01,
                9.999992976685315726e-01,
                9.999993069503179122e-01,
                9.999993160692687288e-01,
                9.999993250289394009e-01,
                9.999993338327922698e-01,
                9.999993424841999712e-01,
                9.999993509864477659e-01,
                9.999993593427368710e-01,
                9.999993675561856810e-01,
                9.999993756298334313e-01,
                9.999993835666417530e-01,
                9.999993913694978920e-01,
                9.999993990412153755e-01,
                9.999994065845378977e-01,
                9.999994140021405409e-01,
                9.999994212966312190e-01,
                9.999994284705535641e-01,
                9.999994355263885915e-01,
                9.999994424665559212e-01,
                9.999994492934158874e-01,
                9.999994560092716478e-01,
                9.999994626163705158e-01,
                9.999994691169046268e-01,
                9.999994755130139357e-01,
                9.999994818067868829e-01,
                9.999994880002621711e-01,
                9.999994940954296530e-01,
                9.999995000942322187e-01,
                9.999995059985666845e-01,
                9.999995118102856795e-01,
                9.999995175311974238e-01,

            ];

            foreach ((FiskDistribution dist, ddouble[] expecteds) in new[]{
                (dist_c1, expected_dist_c1),
                (dist_c2, expected_dist_c2),
                (dist_c3, expected_dist_c3),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} cdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}