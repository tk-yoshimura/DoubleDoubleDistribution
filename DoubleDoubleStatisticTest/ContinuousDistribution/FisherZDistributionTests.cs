using DoubleDouble;
using DoubleDoubleStatistic;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleStatisticTest.ContinuousDistribution {
    [TestClass()]
    public class FisherZDistributionTests {
        readonly FisherZDistribution dist_n_1_m_1 = new(n: 1, m: 1);
        readonly FisherZDistribution dist_n_2_m_1 = new(n: 2, m: 1);
        readonly FisherZDistribution dist_n_1_m_2 = new(n: 1, m: 2);
        readonly FisherZDistribution dist_n_2_m_2 = new(n: 2, m: 2);
        readonly FisherZDistribution dist_n_3_m_4 = new(n: 3, m: 4);
        readonly FisherZDistribution dist_n_4_m_2 = new(n: 4, m: 2);
        readonly FisherZDistribution dist_n_2_m_4 = new(n: 2, m: 4);
        readonly FisherZDistribution dist_n_4_m_4 = new(n: 4, m: 4);
        readonly FisherZDistribution dist_n_6_m_8 = new(n: 6, m: 8);
        readonly FisherZDistribution dist_n_8_m_6 = new(n: 8, m: 6);
        readonly FisherZDistribution dist_n_8_m_8 = new(n: 8, m: 8);
        readonly FisherZDistribution dist_n_10_m_10 = new(n: 10, m: 10);

        FisherZDistribution[] Dists => [
            dist_n_1_m_1,
            dist_n_2_m_1,
            dist_n_1_m_2,
            dist_n_2_m_2,
            dist_n_3_m_4,
            dist_n_4_m_2,
            dist_n_2_m_4,
            dist_n_4_m_4,
            dist_n_6_m_8,
            dist_n_8_m_6,
            dist_n_8_m_8,
            dist_n_10_m_10
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"N={dist.N}");
                Console.WriteLine($"M={dist.M}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
                Console.WriteLine(dist.Formula);
            }
        }

        [TestMethod()]
        public void MeanTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mean)) {
                    continue;
                }

                ddouble actual = dist.Mean;
                ddouble expected = IntegrationStatistics.Mean(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void ModeTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mode)) {
                    continue;
                }

                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode - 1e-4), $"{dist}\n{dist.Mode}");
                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode + 1e-4), $"{dist}\n{dist.Mode}");
            }
        }

        [TestMethod()]
        public void MedianTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.Abs(dist.CDF(dist.Median) - 0.5) < 1e-20, $"{dist}\n{dist.Median}");
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Variance)) {
                    continue;
                }

                ddouble actual = dist.Variance;
                ddouble expected = IntegrationStatistics.Variance(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void SkewnessTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Skewness)) {
                    continue;
                }

                ddouble actual = dist.Skewness;
                ddouble expected = IntegrationStatistics.Skewness(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void KurtosisTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Kurtosis)) {
                    continue;
                }

                ddouble actual = dist.Kurtosis;
                ddouble expected = IntegrationStatistics.Kurtosis(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void EntropyTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Entropy;
                ddouble expected = IntegrationStatistics.Entropy(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void IrregularValueTest() {
            foreach (FisherZDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.NegativeInfinity)) && dist.PDF(ddouble.NegativeInfinity) >= 0d, "pdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue)) && dist.PDF(ddouble.MinValue) >= 0d, "pdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue / 2)) && dist.PDF(ddouble.MinValue / 2) >= 0d, "pdf(-lval / 2)");

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.PositiveInfinity)) && dist.PDF(ddouble.PositiveInfinity) >= 0d, "pdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue)) && dist.PDF(ddouble.MaxValue) >= 0d, "pdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue / 2)) && dist.PDF(ddouble.MaxValue / 2) >= 0d, "pdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.PDF(ddouble.NaN)), "pdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Lower) == 0d, "cdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Lower)) && dist.CDF(ddouble.MinValue, Interval.Lower) >= 0d, "cdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Lower)) && dist.CDF(ddouble.MinValue / 2, Interval.Lower) >= 0d, "cdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Lower) == 1d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Lower)) && dist.CDF(ddouble.MaxValue, Interval.Lower) <= 1d, "cdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Lower)) && dist.CDF(ddouble.MaxValue / 2, Interval.Lower) <= 1d, "cdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Lower)), "cdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Upper) == 1d, "ccdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Upper)) && dist.CDF(ddouble.MinValue, Interval.Upper) <= 1d, "ccdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Upper)) && dist.CDF(ddouble.MinValue / 2, Interval.Upper) <= 1d, "ccdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Upper) == 0d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Upper)) && dist.CDF(ddouble.MaxValue, Interval.Upper) >= 0d, "ccdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Upper)) && dist.CDF(ddouble.MaxValue / 2, Interval.Upper) >= 0d, "ccdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Upper)), "ccdf(NaN)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(0d, Interval.Lower)), "quantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(1d, Interval.Lower)), "quantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(0d, Interval.Upper)), "cquantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(1d, Interval.Upper)), "cquantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.Epsilon, Interval.Lower)), "quantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)), "quantile(1-eps)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.Epsilon, Interval.Upper)), "cquantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)), "cquantile(1-eps)");
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_n_1_m_1 = [
                0.01165618764477412,
                0.01240739315310086,
                0.01320693306489301,
                0.014057901155389,
                0.01496358588797513,
                0.01592748197480885,
                0.01695330247884536,
                0.01804499145049404,
                0.0192067370832496,
                0.02044298536150277,
                0.02175845415986408,
                0.02315814773616738,
                0.02464737153918824,
                0.02623174722622133,
                0.02791722775407329,
                0.02971011236863943,
                0.03161706127175159,
                0.03364510968790257,
                0.03580168098602734,
                0.03809459843073999,
                0.04053209504100579,
                0.04312282091958218,
                0.04587584728082388,
                0.04880066624447215,
                0.05190718527548175,
                0.05520571493130935,
                0.05870694832496644,
                0.06242193042139599,
                0.06636201495389996,
                0.07053880637514973,
                0.07496408384441301,
                0.07964970380261546,
                0.08460747720757375,
                0.08984901700702437,
                0.09538555093893891,
                0.1012276942999343,
                0.1073851769602957,
                0.1138665186928549,
                0.1206786469089158,
                0.1278264512690603,
                0.1353122704996579,
                0.1431353082660578,
                0.1512909773263809,
                0.15977017463002,
                0.1685584947497727,
                0.177635395238981,
                0.1869733353125572,
                0.1965369186674465,
                0.2062820820908703,
                0.2161553832770438,
                0.2260934531365545,
                0.236022688544958,
                0.2458592691750409,
                0.2555095846100486,
                0.2648711529195622,
                0.2738340969556576,
                0.2822832180221503,
                0.290100667683402,
                0.297169168506336,
                0.3033756769424462,
                0.3086153222418409,
                0.3127954021495835,
                0.3158391780491744,
                0.3176891974623432,
                0.3183098861837905,
                0.3176891974623431,
                0.3158391780491745,
                0.3127954021495835,
                0.3086153222418408,
                0.3033756769424462,
                0.297169168506336,
                0.2901006676834019,
                0.2822832180221503,
                0.2738340969556576,
                0.2648711529195622,
                0.2555095846100486,
                0.2458592691750409,
                0.236022688544958,
                0.2260934531365546,
                0.2161553832770438,
                0.2062820820908703,
                0.1965369186674465,
                0.1869733353125571,
                0.177635395238981,
                0.1685584947497727,
                0.15977017463002,
                0.1512909773263809,
                0.1431353082660578,
                0.1353122704996579,
                0.1278264512690603,
                0.1206786469089158,
                0.1138665186928548,
                0.1073851769602957,
                0.1012276942999343,
                0.09538555093893891,
                0.0898490170070244,
                0.08460747720757375,
                0.07964970380261548,
                0.07496408384441303,
                0.07053880637514974,
                0.06636201495389997,
                0.06242193042139599,
                0.05870694832496644,
                0.05520571493130935,
                0.05190718527548174,
                0.04880066624447215,
                0.04587584728082388,
                0.04312282091958217,
                0.04053209504100579,
                0.03809459843073999,
                0.03580168098602734,
                0.03364510968790258,
                0.03161706127175158,
                0.02971011236863944,
                0.02791722775407329,
                0.02623174722622134,
                0.02464737153918825,
                0.02315814773616738,
                0.02175845415986408,
                0.02044298536150277,
                0.0192067370832496,
                0.01804499145049404,
                0.01695330247884536,
                0.01592748197480885,
                0.01496358588797514,
                0.014057901155389,
                0.01320693306489301,
                0.01240739315310086,
                0.01165618764477412,
            ];
            ddouble[] expected_dist_n_2_m_1 = [
                6.702506105839778e-4,
                7.593917507793502e-4,
                8.603730439240888e-4,
                9.747628074969724e-4,
                0.001104335860948443,
                0.001251100365922818,
                0.001417328055442959,
                0.001605588251410698,
                0.001818786108484206,
                0.002060205562268388,
                0.002333557499874223,
                0.002643033709940791,
                0.002993367205315334,
                0.003389899542215415,
                0.003838655781442726,
                0.004346427745558238,
                0.004920866214940983,
                0.005570582667666591,
                0.00630526109332218,
                0.007135780286742034,
                0.008074346838529072,
                0.009134638765648765,
                0.01033195934343851,
                0.0116834001811117,
                0.01320801189172357,
                0.01492697980420428,
                0.01686380100328605,
                0.01904445751180779,
                0.02149757859469244,
                0.02425458291087012,
                0.02734978852053156,
                0.03082047553700571,
                0.03470688248940944,
                0.03905211327349327,
                0.04390192702248565,
                0.04930437853550809,
                0.05530927240282837,
                0.06196739018659361,
                0.0693294476925704,
                0.07744473949338425,
                0.08635943168951192,
                0.0961144729071174,
                0.1067431093586686,
                0.1182680140157965,
                0.130698073800098,
                0.1440249226428813,
                0.1582193614262434,
                0.1732278653866854,
                0.188969440254173,
                0.2053331421723947,
                0.2221766127253014,
                0.2393259870510628,
                0.2565774982594176,
                0.2737010164515282,
                0.2904456231035411,
                0.3065471380999737,
                0.321737304692946,
                0.3357541244710855,
                0.3483526536817425,
                0.3593154575757077,
                0.3684618967803131,
                0.3756555004107974,
                0.3808088574946349,
                0.3838857060357562,
                0.3849001794597504,
                0.3839134404332282,
                0.3810281538759875,
                0.3763813980560907,
                0.370136674370678,
                0.3624756575747153,
                0.3535902454048312,
                0.3436753427107769,
                0.3329226742162122,
                0.3215157823954169,
                0.3096262473900297,
                0.2974110726701898,
                0.2850111157898579,
                0.272550406324459,
                0.2601361785059074,
                0.2478594486379847,
                0.2357959815116696,
                0.2240075108510872,
                0.2125431024283777,
                0.2014405720977663,
                0.1907278928099934,
                0.1804245436769709,
                0.1705427699611464,
                0.1610887354710456,
                0.1520635585104861,
                0.1434642296408998,
                0.1352844145070883,
                0.1275151482715993,
                0.1201454301876495,
                0.1131627278470527,
                0.1065534009418554,
                0.1003030541947523,
                0.09439682861277218,
                0.0888196395281233,
                0.08355636910200566,
                0.07859202014697425,
                0.07391183731533886,
                0.06950140093358594,
                0.0653466980527339,
                0.06143417464041924,
                0.0577507722651363,
                0.05428395211535095,
                0.05102170875269785,
                0.04795257561425319,
                0.04506562394836846,
                0.0423504565859586,
                0.03979719770878849,
                0.03739647957282301,
                0.03513942697316203,
                0.0330176400930062,
                0.03102317625851926,
                0.02914853102087185,
                0.02738661890312185,
                0.02573075408026979,
                0.02417463120356059,
                0.02271230653294318,
                0.02133817950290294,
                0.02004697481524583,
                0.01883372512665906,
                0.01769375437800606,
                0.01662266179549544,
                0.01561630658039641,
                0.01467079329326938,
                0.01378245793025105,
                0.0129478546823716,
            ];
            ddouble[] expected_dist_n_1_m_2 = [
                0.0129478546823716,
                0.01378245793025105,
                0.01467079329326938,
                0.01561630658039641,
                0.01662266179549543,
                0.01769375437800606,
                0.01883372512665905,
                0.02004697481524583,
                0.02133817950290294,
                0.02271230653294318,
                0.0241746312035606,
                0.02573075408026979,
                0.02738661890312184,
                0.02914853102087184,
                0.03102317625851926,
                0.03301764009300621,
                0.03513942697316203,
                0.03739647957282301,
                0.0397971977087885,
                0.04235045658595861,
                0.04506562394836846,
                0.04795257561425319,
                0.05102170875269783,
                0.05428395211535095,
                0.0577507722651363,
                0.06143417464041923,
                0.06534669805273388,
                0.06950140093358595,
                0.07391183731533883,
                0.07859202014697426,
                0.08355636910200567,
                0.0888196395281233,
                0.0943968286127722,
                0.1003030541947523,
                0.1065534009418554,
                0.1131627278470526,
                0.1201454301876495,
                0.1275151482715992,
                0.1352844145070883,
                0.1434642296408998,
                0.1520635585104861,
                0.1610887354710456,
                0.1705427699611464,
                0.1804245436769708,
                0.1907278928099933,
                0.2014405720977662,
                0.2125431024283777,
                0.2240075108510871,
                0.2357959815116695,
                0.2478594486379847,
                0.2601361785059074,
                0.272550406324459,
                0.2850111157898578,
                0.2974110726701897,
                0.3096262473900298,
                0.3215157823954169,
                0.3329226742162122,
                0.3436753427107769,
                0.3535902454048311,
                0.3624756575747152,
                0.3701366743706779,
                0.3763813980560908,
                0.3810281538759875,
                0.3839134404332281,
                0.3849001794597504,
                0.3838857060357564,
                0.3808088574946351,
                0.3756555004107975,
                0.368461896780313,
                0.3593154575757077,
                0.3483526536817426,
                0.3357541244710855,
                0.3217373046929461,
                0.3065471380999736,
                0.2904456231035412,
                0.2737010164515282,
                0.2565774982594177,
                0.2393259870510627,
                0.2221766127253014,
                0.2053331421723947,
                0.1889694402541729,
                0.1732278653866854,
                0.1582193614262434,
                0.1440249226428813,
                0.1306980738000979,
                0.1182680140157965,
                0.1067431093586686,
                0.09611447290711736,
                0.08635943168951193,
                0.07744473949338428,
                0.0693294476925704,
                0.06196739018659361,
                0.05530927240282839,
                0.0493043785355081,
                0.04390192702248564,
                0.03905211327349326,
                0.03470688248940947,
                0.03082047553700571,
                0.02734978852053156,
                0.02425458291087012,
                0.02149757859469243,
                0.01904445751180779,
                0.01686380100328604,
                0.01492697980420428,
                0.01320801189172357,
                0.0116834001811117,
                0.01033195934343852,
                0.00913463876564877,
                0.008074346838529074,
                0.007135780286742037,
                0.006305261093322182,
                0.005570582667666589,
                0.004920866214940984,
                0.004346427745558236,
                0.003838655781442726,
                0.003389899542215415,
                0.002993367205315334,
                0.002643033709940791,
                0.002333557499874223,
                0.002060205562268388,
                0.001818786108484206,
                0.001605588251410697,
                0.001417328055442959,
                0.001251100365922819,
                0.001104335860948442,
                9.747628074969723e-4,
                8.603730439240884e-4,
                7.593917507793496e-4,
                6.702506105839778e-4,
            ];
            ddouble[] expected_dist_n_2_m_2 = [
                6.704753415129483e-4,
                7.596802530408261e-4,
                8.60743403848672e-4,
                9.752382364200328e-4,
                0.001104946145404321,
                0.00125188372726361,
                0.001418333534050457,
                0.001606878762874717,
                0.001820442360243652,
                0.002062331071683159,
                0.002336285021590888,
                0.002646533465614085,
                0.002997857417138098,
                0.003395659909429058,
                0.003846044713729214,
                0.004355904388528798,
                0.004933018582720094,
                0.005586163550491652,
                0.006325233852132376,
                0.007161377203813797,
                0.008107143389739531,
                0.009176648047394693,
                0.01038575196260369,
                0.01175225624244108,
                0.01329611334158031,
                0.01503965336525887,
                0.01700782431537908,
                0.01922844393176546,
                0.02173245944445046,
                0.02455420982050059,
                0.02773168287526792,
                0.03130675682905003,
                0.03532541242658221,
                0.03983789750041603,
                0.0448988207640869,
                0.05056714561020564,
                0.05690604775947108,
                0.06398259284553262,
                0.07186718165065624,
                0.08063270214903932,
                0.09035331946182425,
                0.1011028283322308,
                0.112952489289748,
                0.1259682713114333,
                0.1402074330902163,
                0.1557143950918267,
                0.1725158888851259,
                0.1906154222183506,
                0.2099871708070129,
                0.2305695020528863,
                0.2522584503733104,
                0.2749015926651338,
                0.2982929041406656,
                0.3221692911625234,
                0.3462095739849939,
                0.3700366989405536,
                0.3932238664829636,
                0.4153050446362408,
                0.4357899875236278,
                0.4541834098838406,
                0.4700074244031888,
                0.4828258025059045,
                0.4922681654751964,
                0.4980519500272347,
                0.4999999999999998,
                0.4980519500272348,
                0.4922681654751965,
                0.4828258025059046,
                0.4700074244031888,
                0.4541834098838406,
                0.4357899875236279,
                0.4153050446362408,
                0.3932238664829636,
                0.3700366989405536,
                0.3462095739849939,
                0.3221692911625234,
                0.2982929041406656,
                0.2749015926651337,
                0.2522584503733102,
                0.2305695020528863,
                0.209987170807013,
                0.1906154222183506,
                0.1725158888851259,
                0.1557143950918267,
                0.1402074330902163,
                0.1259682713114333,
                0.1129524892897481,
                0.1011028283322308,
                0.09035331946182422,
                0.08063270214903932,
                0.07186718165065623,
                0.06398259284553263,
                0.0569060477594711,
                0.05056714561020565,
                0.04489882076408691,
                0.03983789750041603,
                0.03532541242658222,
                0.03130675682905004,
                0.02773168287526792,
                0.0245542098205006,
                0.02173245944445046,
                0.01922844393176545,
                0.01700782431537908,
                0.01503965336525887,
                0.0132961133415803,
                0.01175225624244108,
                0.01038575196260369,
                0.009176648047394693,
                0.008107143389739531,
                0.007161377203813798,
                0.006325233852132376,
                0.005586163550491653,
                0.004933018582720093,
                0.004355904388528799,
                0.003846044713729214,
                0.003395659909429058,
                0.002997857417138098,
                0.002646533465614086,
                0.002336285021590888,
                0.002062331071683158,
                0.001820442360243652,
                0.001606878762874716,
                0.001418333534050457,
                0.00125188372726361,
                0.00110494614540432,
                9.752382364200327e-4,
                8.607434038486718e-4,
                7.596802530408261e-4,
                6.704753415129481e-4,
            ];
            ddouble[] expected_dist_n_3_m_4 = [
                2.99045305158897e-5,
                3.606752130471371e-5,
                4.349995715974125e-5,
                5.246306794175459e-5,
                6.327174888528528e-5,
                7.630555182682558e-5,
                9.202191528941416e-5,
                1.109720849666676e-4,
                1.338202655630675e-4,
                1.613666514543607e-4,
                1.945751102709641e-4,
                2.34606443769336e-4,
                2.8285832821622e-4,
                3.410132464437966e-4,
                4.110959707072204e-4,
                4.955424448999436e-4,
                5.972822523007247e-4,
                7.19837246718103e-4,
                8.674393763492935e-4,
                0.001045171245863227,
                0.001259133546666113,
                0.001516644138945481,
                0.001826474288681393,
                0.002199128338746071,
                0.002647173906444648,
                0.003185630517796559,
                0.003832425359913578,
                0.004608925479192579,
                0.00554055616148071,
                0.006657515240619776,
                0.007995592472270776,
                0.009597101580854151,
                0.01151192974151172,
                0.0137987045808843,
                0.01652607161733222,
                0.01977406460800272,
                0.02363553656670286,
                0.02821759916626251,
                0.03364299166436946,
                0.04005126624713691,
                0.04759963385417362,
                0.05646326276241721,
                0.06683476210782596,
                0.07892251642641195,
                0.0929474700280394,
                0.1091378999373735,
                0.127721676206592,
                0.148915507081951,
                0.1729107280703027,
                0.1998553476487976,
                0.2298323395771865,
                0.2628346003514674,
                0.2987375853498897,
                0.3372713881356468,
                0.3779948829141039,
                0.4202754041180388,
                0.4632781210880704,
                0.5059695564890088,
                0.547139346298435,
                0.5854431313615056,
                0.6194673033850532,
                0.6478132998464813,
                0.6691956131529629,
                0.6825442722987759,
                0.687100062550647,
                0.6824899447409556,
                0.6687715348238805,
                0.6464391430775153,
                0.6163892100917739,
                0.5798489780374734,
                0.5382776316461753,
                0.4932527901130449,
                0.4463564374450072,
                0.3990730807453181,
                0.3527096537861108,
                0.3083423493823496,
                0.2667911677141402,
                0.2286193273457708,
                0.1941522793208743,
                0.1635100015766907,
                0.1366463473384828,
                0.1133901279476047,
                0.09348393981294824,
                0.07661816257153414,
                0.06245882729278684,
                0.05066905354352291,
                0.04092444570941534,
                0.03292324612592004,
                0.02639222133503489,
                0.02108927388106568,
                0.01680368656254901,
                0.0133547681920842,
                0.01058951505243824,
                0.008379753012849841,
                0.006619094149534797,
                0.00521993388046522,
                0.004110630562626044,
                0.003232947031691559,
                0.002539789284739652,
                0.001993247710232564,
                0.001562927480180519,
                0.001224543948638233,
                9.587537294926445e-4,
                7.501906868642794e-4,
                5.866769776097778e-4,
                4.585815471288278e-4,
                3.583014157687459e-4,
                2.798442546422534e-4,
                2.184938562347302e-4,
                1.705429947106574e-4,
                1.330807615094046e-4,
                1.038237241137669e-4,
                8.098219264110923e-5,
                6.315451165253372e-5,
                4.924365425077753e-5,
                3.839151660673727e-5,
                2.992722785407498e-5,
                2.332653494857884e-5,
                1.817992347210249e-5,
                1.416761868730343e-5,
                1.103999799372093e-5,
                8.602254464990551e-6,
                6.702396468796906e-6,
                5.221862923578814e-6,
                4.068187685814462e-6,
                3.169268126990969e-6,
                2.468888794307653e-6,
                1.923226487093205e-6,
                1.49812238569193e-6,
            ];
            ddouble[] expected_dist_n_4_m_2 = [
                1.796943523952784e-6,
                2.306703324606909e-6,
                2.960967098844812e-6,
                3.800650123517524e-6,
                4.87823077510696e-6,
                6.261008502448854e-6,
                8.035275266982893e-6,
                1.031165453227226e-5,
                1.32319316336605e-5,
                1.697778783520644e-5,
                2.178196242087695e-5,
                2.794250876753358e-5,
                3.584098890342939e-5,
                4.596567562524917e-5,
                5.894111283361474e-5,
                7.556573658943396e-5,
                9.685969722139052e-5,
                1.241255650292298e-4,
                1.5902526981985e-4,
                2.036774412026253e-4,
                2.607803074754582e-4,
                3.337665015155735e-4,
                4.269975354978663e-4,
                5.460073591680046e-4,
                6.978063125276458e-4,
                8.912589043004902e-4,
                0.001137551137113728,
                0.001450765447676211,
                0.001848583541739917,
                0.002353139168721096,
                0.002992043728471204,
                0.003799606849308676,
                0.004818270768534715,
                0.006100270204503005,
                0.007709516785150633,
                0.009723686971090703,
                0.01223646245492111,
                0.01535982978615018,
                0.01922628926942745,
                0.02399075070079264,
                0.02983180576694195,
                0.03695196760885206,
                0.04557636558222675,
                0.05594929255696264,
                0.06832794598022347,
                0.0829727133691519,
                0.1001334653205131,
                0.1200315733857106,
                0.142837797399902,
                0.1686467970975556,
                0.1974497889683546,
                0.2291077123118621,
                0.2633280504522462,
                0.2996489856263995,
                0.3374346399200174,
                0.3758845915091378,
                0.4140595729243271,
                0.4509233283973816,
                0.4853982853084489,
                0.5164303922113616,
                0.543056677515785,
                0.5644682199555473,
                0.5800615437854778,
                0.5894729411942854,
                0.592592592592593,
                0.5895581189811121,
                0.5807298161845739,
                0.5666518272106308,
                0.5480046308567419,
                0.5255544093368897,
                0.5001042465817956,
                0.4724509647494804,
                0.4433500280290976,
                0.4134895933173491,
                0.3834736522913281,
                0.3538133845873322,
                0.3249253444951197,
                0.2971348959505114,
                0.2706833254706295,
                0.2457372251165034,
                0.2223989795882068,
                0.2007174596707999,
                0.1806982815595196,
                0.1623132163483017,
                0.1455085163829615,
                0.1302120638441729,
                0.1163393455440822,
                0.1037983227826422,
                0.09249330330748826,
                0.0823279407458274,
                0.07320749123410278,
                0.06504045215491186,
                0.05773969757990155,
                0.05122321189514453,
                0.04541450900910324,
                0.04024281072318171,
                0.03564304500859641,
                0.03155571346362308,
                0.02792666727004246,
                0.02470682252312967,
                0.0218518387813165,
                0.01932177892692426,
                0.01708076378558072,
                0.01509663125499814,
                0.01334060678887856,
                0.01178698982904688,
                0.01041285905618051,
                0.009197798032162694,
                0.008123641847423056,
                0.007174244692156669,
                0.006335267781889611,
                0.005593986737762284,
                0.004939117312008758,
                0.00436065822924517,
                0.003849749860668619,
                0.003398547442698921,
                0.003000107579779328,
                0.002648286822157286,
                0.002337651175312665,
                0.002063395472185496,
                0.001821271617992433,
                0.001607524796972404,
                0.001418836808586197,
                0.001252275775956836,
                0.001105251540669696,
                9.754761248517305e-4,
                8.609287034153531e-4,
                7.598245863965611e-4,
                6.705877635032501e-4,
            ];
            ddouble[] expected_dist_n_2_m_4 = [
                6.705877635032503e-4,
                7.598245863965613e-4,
                8.609287034153532e-4,
                9.754761248517306e-4,
                0.001105251540669696,
                0.001252275775956836,
                0.001418836808586196,
                0.001607524796972405,
                0.001821271617992432,
                0.002063395472185496,
                0.002337651175312665,
                0.002648286822157286,
                0.003000107579779327,
                0.00339854744269892,
                0.003849749860668619,
                0.004360658229245171,
                0.004939117312008759,
                0.005593986737762282,
                0.006335267781889613,
                0.007174244692156671,
                0.008123641847423053,
                0.009197798032162691,
                0.0104128590561805,
                0.01178698982904688,
                0.01334060678887856,
                0.01509663125499814,
                0.01708076378558072,
                0.01932177892692427,
                0.0218518387813165,
                0.02470682252312967,
                0.02792666727004247,
                0.03155571346362309,
                0.03564304500859639,
                0.0402428107231817,
                0.04541450900910324,
                0.05122321189514452,
                0.05773969757990154,
                0.06504045215491189,
                0.07320749123410276,
                0.08232794074582743,
                0.09249330330748826,
                0.1037983227826422,
                0.1163393455440822,
                0.1302120638441729,
                0.1455085163829615,
                0.1623132163483016,
                0.1806982815595196,
                0.2007174596708,
                0.2223989795882068,
                0.2457372251165034,
                0.2706833254706296,
                0.2971348959505115,
                0.3249253444951196,
                0.353813384587332,
                0.3834736522913282,
                0.4134895933173491,
                0.4433500280290976,
                0.4724509647494806,
                0.5001042465817956,
                0.5255544093368896,
                0.5480046308567421,
                0.5666518272106306,
                0.5807298161845738,
                0.5895581189811122,
                0.592592592592593,
                0.5894729411942855,
                0.5800615437854779,
                0.5644682199555475,
                0.543056677515785,
                0.5164303922113617,
                0.4853982853084489,
                0.4509233283973815,
                0.4140595729243272,
                0.3758845915091379,
                0.3374346399200174,
                0.2996489856263995,
                0.2633280504522462,
                0.2291077123118621,
                0.1974497889683546,
                0.1686467970975555,
                0.142837797399902,
                0.1200315733857106,
                0.1001334653205131,
                0.08297271336915188,
                0.06832794598022349,
                0.05594929255696263,
                0.04557636558222677,
                0.03695196760885205,
                0.02983180576694195,
                0.02399075070079264,
                0.01922628926942745,
                0.01535982978615018,
                0.01223646245492112,
                0.009723686971090705,
                0.007709516785150632,
                0.006100270204503005,
                0.004818270768534717,
                0.003799606849308676,
                0.002992043728471204,
                0.002353139168721095,
                0.001848583541739916,
                0.001450765447676211,
                0.001137551137113728,
                8.912589043004906e-4,
                6.978063125276458e-4,
                5.460073591680046e-4,
                4.269975354978663e-4,
                3.337665015155736e-4,
                2.607803074754582e-4,
                2.036774412026253e-4,
                1.5902526981985e-4,
                1.241255650292299e-4,
                9.685969722139055e-5,
                7.556573658943394e-5,
                5.894111283361476e-5,
                4.596567562524918e-5,
                3.58409889034294e-5,
                2.794250876753357e-5,
                2.178196242087696e-5,
                1.697778783520644e-5,
                1.32319316336605e-5,
                1.031165453227226e-5,
                8.035275266982893e-6,
                6.26100850244885e-6,
                4.878230775106959e-6,
                3.800650123517524e-6,
                2.960967098844812e-6,
                2.306703324606908e-6,
                1.796943523952784e-6,
            ];
            ddouble[] expected_dist_n_4_m_4 = [
                1.348611550730717e-6,
                1.731342260580525e-6,
                2.222637621806999e-6,
                2.853268853326973e-6,
                3.662717952731604e-6,
                4.701638599762298e-6,
                6.035010041436186e-6,
                7.746178075733356e-6,
                9.942031160908459e-6,
                1.275962834768944e-5,
                1.637468310632984e-5,
                2.101241815384595e-5,
                2.696144728046977e-5,
                3.459151866151135e-5,
                4.437617982001338e-5,
                5.692170912601345e-5,
                7.300401701238544e-5,
                9.361566963852468e-5,
                1.200257498524843e-4,
                1.538559703659121e-4,
                1.971773218253925e-4,
                2.52632608157259e-4,
                3.2359153148618e-4,
                4.143465803639865e-4,
                5.303598899764508e-4,
                6.785735200414289e-4,
                8.677982638284015e-4,
                0.001109199168111146,
                0.001416899380514055,
                0.001808727659727507,
                0.002307138705283289,
                0.002940339069459819,
                0.003743654289324395,
                0.004761174231760971,
                0.006047712318016817,
                0.007671108645491233,
                0.009714894814809633,
                0.01228131656171164,
                0.01549467539522529,
                0.01950489796756711,
                0.02449116701331145,
                0.03066534569032967,
                0.03827479451025203,
                0.04760401613157269,
                0.05897437288124253,
                0.07274091851644066,
                0.08928519575347552,
                0.1090027175624405,
                0.1322838357106011,
                0.1594868858307482,
                0.190902977354232,
                0.2267126569494818,
                0.2669359699820174,
                0.3113791565044889,
                0.3595832073566136,
                0.4107814756884666,
                0.4638750275154356,
                0.5174348403009311,
                0.5697387396775323,
                0.6188477094411395,
                0.662720936982359,
                0.6993622666964135,
                0.7269838402209476,
                0.7441672347777948,
                0.7500000000000009,
                0.7441672347777951,
                0.726983840220948,
                0.699362266696414,
                0.6627209369823589,
                0.6188477094411396,
                0.5697387396775323,
                0.517434840300931,
                0.4638750275154357,
                0.4107814756884667,
                0.3595832073566136,
                0.311379156504489,
                0.2669359699820175,
                0.2267126569494817,
                0.1909029773542319,
                0.1594868858307482,
                0.1322838357106011,
                0.1090027175624405,
                0.08928519575347547,
                0.07274091851644067,
                0.05897437288124253,
                0.04760401613157268,
                0.03827479451025205,
                0.03066534569032967,
                0.02449116701331144,
                0.0195048979675671,
                0.01549467539522529,
                0.01228131656171164,
                0.009714894814809638,
                0.007671108645491238,
                0.006047712318016817,
                0.004761174231760973,
                0.003743654289324397,
                0.00294033906945982,
                0.00230713870528329,
                0.001808727659727508,
                0.001416899380514055,
                0.001109199168111145,
                8.677982638284012e-4,
                6.785735200414287e-4,
                5.303598899764504e-4,
                4.143465803639866e-4,
                3.2359153148618e-4,
                2.52632608157259e-4,
                1.971773218253925e-4,
                1.538559703659121e-4,
                1.200257498524844e-4,
                9.361566963852475e-5,
                7.300401701238544e-5,
                5.692170912601345e-5,
                4.43761798200134e-5,
                3.459151866151135e-5,
                2.696144728046977e-5,
                2.101241815384595e-5,
                1.637468310632985e-5,
                1.275962834768944e-5,
                9.942031160908461e-6,
                7.746178075733353e-6,
                6.035010041436184e-6,
                4.701638599762299e-6,
                3.662717952731603e-6,
                2.853268853326972e-6,
                2.222637621806998e-6,
                1.731342260580525e-6,
                1.348611550730716e-6,
            ];
            ddouble[] expected_dist_n_6_m_8 = [
                1.907799350134987e-9,
                2.775180998540742e-9,
                4.036792048851872e-9,
                5.871730128770446e-9,
                8.540403641605524e-9,
                1.242141277780554e-8,
                1.806513683953513e-8,
                2.627158110261171e-8,
                3.820344208078902e-8,
                5.555028523006519e-8,
                8.076687687884299e-8,
                1.174190580439348e-7,
                1.706855121947189e-7,
                2.480854064002926e-7,
                3.605331138809841e-7,
                5.238662713544807e-7,
                7.610583230153068e-7,
                1.105420078427086e-6,
                1.605228952834666e-6,
                2.330416924115811e-6,
                3.382223548458613e-6,
                4.907113480955026e-6,
                7.116817764723603e-6,
                1.031715296058887e-5,
                1.494939667405096e-5,
                2.16495824979557e-5,
                3.133329949719179e-5,
                4.531668068853434e-5,
                6.5488560167513e-5,
                9.455468624871338e-5,
                1.363829311629502e-4,
                1.964892986735634e-4,
                2.827189895968032e-4,
                4.061957293024347e-4,
                5.826368919492099e-4,
                8.341624130591228e-4,
                0.001191762322764684,
                0.001698630192443428,
                0.002414615228008171,
                0.003422088379731289,
                0.004833546971842952,
                0.00680128008912589,
                0.00952935557548729,
                0.01328802901136476,
                0.0184303619938416,
                0.02541030656584552,
                0.03480069668911247,
                0.04730843359887894,
                0.06378265574784447,
                0.08520994129881937,
                0.1126888625397822,
                0.1473749912360863,
                0.1903875091214556,
                0.2426709104105511,
                0.3048109472197264,
                0.3768136859873713,
                0.4578701172883027,
                0.5461444097998582,
                0.638637790438139,
                0.7311864747911762,
                0.8186447785880486,
                0.8952790857770353,
                0.9553552398147589,
                0.9938489251154415,
                1.007160524708483,
                0.9936907193013577,
                0.9541447803534664,
                0.8914849401659526,
                0.8105294044107927,
                0.7172796529730157,
                0.6181179919586438,
                0.519036405235845,
                0.4250326810636758,
                0.3397532240545252,
                0.2653954130643577,
                0.2028266761016035,
                0.1518453912965848,
                0.1115024999168693,
                0.08041622947304676,
                0.05703577731329985,
                0.03983407838069171,
                0.02742895171407811,
                0.01864372693962859,
                0.01252339804978777,
                0.00832235756115234,
                0.005477019705592283,
                0.00357292854746214,
                0.002312405622331531,
                0.001485971940261267,
                9.488159420386065e-4,
                6.023762817970967e-4,
                3.804796447238474e-4,
                2.392273686310736e-4,
                1.498032225202468e-4,
                9.346646903553194e-5,
                5.812844739504763e-5,
                3.604753839444318e-5,
                2.229748588740955e-5,
                1.376112983654043e-5,
                8.475811059941002e-6,
                5.211183591047293e-6,
                3.19895014857922e-6,
                1.96097858947424e-6,
                1.200610275536846e-6,
                7.342717355889965e-7,
                4.486336754497461e-7,
                2.738771296893594e-7,
                1.670673212933932e-7,
                1.018444057862885e-7,
                6.204781449574237e-8,
                3.778237671236895e-8,
                2.299598013621665e-8,
                1.399064645325165e-8,
                8.50878366308268e-9,
                5.173199965802904e-9,
                3.144338234379475e-9,
                1.910696462996732e-9,
                1.160804763108837e-9,
                7.050871838965372e-10,
                4.282056944401678e-10,
                2.600139854962382e-10,
                1.578640680116257e-10,
                9.583385263987423e-11,
                5.817141843764679e-11,
                3.530698890029309e-11,
                2.142775564962309e-11,
                1.300354534113681e-11,
                7.890773590734631e-12,
                4.787990789357376e-12,
            ];
            ddouble[] expected_dist_n_8_m_6 = [
                4.787990789357373e-12,
                7.890773590734638e-12,
                1.300354534113681e-11,
                2.142775564962309e-11,
                3.530698890029311e-11,
                5.817141843764682e-11,
                9.583385263987423e-11,
                1.578640680116258e-10,
                2.600139854962382e-10,
                4.282056944401678e-10,
                7.050871838965372e-10,
                1.160804763108838e-9,
                1.910696462996732e-9,
                3.144338234379475e-9,
                5.173199965802897e-9,
                8.508783663082684e-9,
                1.399064645325164e-8,
                2.299598013621662e-8,
                3.778237671236895e-8,
                6.204781449574239e-8,
                1.018444057862885e-7,
                1.670673212933932e-7,
                2.738771296893593e-7,
                4.486336754497463e-7,
                7.34271735588996e-7,
                1.200610275536846e-6,
                1.960978589474243e-6,
                3.198950148579219e-6,
                5.211183591047298e-6,
                8.475811059941004e-6,
                1.376112983654044e-5,
                2.229748588740953e-5,
                3.604753839444316e-5,
                5.812844739504768e-5,
                9.346646903553193e-5,
                1.498032225202467e-4,
                2.392273686310735e-4,
                3.804796447238477e-4,
                6.023762817970965e-4,
                9.488159420386073e-4,
                0.001485971940261267,
                0.002312405622331532,
                0.00357292854746214,
                0.005477019705592286,
                0.008322357561152335,
                0.01252339804978777,
                0.01864372693962861,
                0.0274289517140781,
                0.0398340783806917,
                0.05703577731329985,
                0.08041622947304675,
                0.1115024999168693,
                0.1518453912965849,
                0.2028266761016035,
                0.2653954130643576,
                0.339753224054525,
                0.4250326810636758,
                0.5190364052358452,
                0.6181179919586436,
                0.7172796529730155,
                0.8105294044107922,
                0.8914849401659524,
                0.9541447803534654,
                0.9936907193013577,
                1.007160524708483,
                0.9938489251154418,
                0.9553552398147591,
                0.8952790857770361,
                0.8186447785880488,
                0.7311864747911762,
                0.6386377904381391,
                0.546144409799858,
                0.4578701172883026,
                0.3768136859873714,
                0.3048109472197264,
                0.2426709104105511,
                0.1903875091214557,
                0.1473749912360861,
                0.1126888625397822,
                0.08520994129881938,
                0.06378265574784446,
                0.04730843359887894,
                0.03480069668911247,
                0.02541030656584553,
                0.01843036199384161,
                0.01328802901136476,
                0.009529355575487302,
                0.006801280089125884,
                0.004833546971842951,
                0.003422088379731288,
                0.00241461522800817,
                0.001698630192443427,
                0.001191762322764684,
                8.341624130591234e-4,
                5.826368919492095e-4,
                4.061957293024349e-4,
                2.827189895968034e-4,
                1.964892986735636e-4,
                1.363829311629502e-4,
                9.45546862487133e-5,
                6.5488560167513e-5,
                4.531668068853432e-5,
                3.133329949719177e-5,
                2.16495824979557e-5,
                1.494939667405097e-5,
                1.031715296058888e-5,
                7.116817764723605e-6,
                4.907113480955032e-6,
                3.382223548458611e-6,
                2.330416924115809e-6,
                1.605228952834665e-6,
                1.105420078427086e-6,
                7.610583230153072e-7,
                5.23866271354481e-7,
                3.605331138809843e-7,
                2.480854064002928e-7,
                1.706855121947189e-7,
                1.174190580439348e-7,
                8.076687687884296e-8,
                5.555028523006517e-8,
                3.820344208078905e-8,
                2.627158110261168e-8,
                1.806513683953514e-8,
                1.242141277780554e-8,
                8.540403641605532e-9,
                5.871730128770443e-9,
                4.03679204885187e-9,
                2.775180998540739e-9,
                1.907799350134987e-9,
            ];
            ddouble[] expected_dist_n_8_m_8 = [
                3.536464389819479e-12,
                5.828561711917919e-12,
                9.605784995861947e-12,
                1.583000056821128e-11,
                2.608569989134347e-11,
                4.298273296095085e-11,
                7.08192842782357e-11,
                1.166730342963344e-10,
                1.921966347864783e-10,
                3.165713358328102e-10,
                5.213643688414061e-10,
                8.585144490845877e-10,
                1.41345485450079e-9,
                2.326670039768831e-9,
                3.829088152201972e-9,
                6.300157441329256e-9,
                1.036308486100349e-8,
                1.70409042258571e-8,
                2.801201788709939e-8,
                4.602822703351512e-8,
                7.55978538043445e-8,
                1.241007341473258e-7,
                2.036056540963884e-7,
                3.338282279486953e-7,
                5.469364695196732e-7,
                8.953428207527496e-7,
                1.464310218590306e-6,
                2.392294322713661e-6,
                3.903674161529931e-6,
                6.361241730400928e-6,
                1.035006195497602e-5,
                1.681087691770629e-5,
                2.725128668495509e-5,
                4.407818346008119e-5,
                7.111771388067932e-5,
                1.144225985990309e-4,
                1.835150746776955e-4,
                2.932819876174458e-4,
                4.668318775621656e-4,
                7.397464758545604e-4,
                0.00116631134214372,
                0.001828484440042201,
                0.002848533128781695,
                0.004406387906384772,
                0.006762732388097438,
                0.01028852460730781,
                0.0155008120180986,
                0.02310309640332776,
                0.03402585898115688,
                0.04945901868442506,
                0.07086322981638114,
                0.09994177826323697,
                0.1385510234699117,
                0.188527459371702,
                0.2514168280805786,
                0.3281083181615435,
                0.4184056355741995,
                0.520603249361318,
                0.6311710056737205,
                0.7446687256566132,
                0.8539981339453951,
                0.9510425168197801,
                1.027649590999101,
                1.076803920338277,
                1.09375,
                1.076803920338278,
                1.027649590999102,
                0.951042516819781,
                0.853998133945395,
                0.7446687256566136,
                0.6311710056737206,
                0.5206032493613179,
                0.4184056355741997,
                0.3281083181615437,
                0.2514168280805786,
                0.1885274593717021,
                0.1385510234699118,
                0.09994177826323684,
                0.07086322981638109,
                0.04945901868442509,
                0.0340258589811569,
                0.02310309640332776,
                0.01550081201809858,
                0.01028852460730781,
                0.006762732388097437,
                0.004406387906384771,
                0.002848533128781698,
                0.001828484440042201,
                0.00116631134214372,
                7.397464758545602e-4,
                4.668318775621652e-4,
                2.932819876174458e-4,
                1.835150746776957e-4,
                1.144225985990311e-4,
                7.111771388067938e-5,
                4.407818346008121e-5,
                2.725128668495511e-5,
                1.68108769177063e-5,
                1.035006195497602e-5,
                6.361241730400933e-6,
                3.903674161529931e-6,
                2.392294322713659e-6,
                1.464310218590305e-6,
                8.953428207527495e-7,
                5.46936469519673e-7,
                3.338282279486955e-7,
                2.036056540963883e-7,
                1.241007341473258e-7,
                7.55978538043445e-8,
                4.602822703351516e-8,
                2.801201788709939e-8,
                1.704090422585713e-8,
                1.036308486100348e-8,
                6.300157441329256e-9,
                3.829088152201976e-9,
                2.326670039768831e-9,
                1.41345485450079e-9,
                8.585144490845878e-10,
                5.213643688414062e-10,
                3.165713358328101e-10,
                1.921966347864784e-10,
                1.166730342963343e-10,
                7.081928427823565e-11,
                4.298273296095086e-11,
                2.608569989134347e-11,
                1.583000056821126e-11,
                9.605784995861933e-12,
                5.828561711917917e-12,
                3.536464389819475e-12,
            ];
            ddouble[] expected_dist_n_10_m_10 = [
                5.335002381403354e-15,
                9.962647281391264e-15,
                1.860326116644764e-14,
                3.473554913250867e-14,
                6.48524104765064e-14,
                1.210711138810465e-13,
                2.260020729358672e-13,
                4.218286972746014e-13,
                7.872365147885668e-13,
                1.468968530157564e-12,
                2.740625472859578e-12,
                5.11219624548512e-12,
                9.534006268548882e-12,
                1.777630539715369e-11,
                3.313539955390412e-11,
                6.174648775599431e-11,
                1.150229029356802e-10,
                2.141848756212807e-10,
                3.986607685635434e-10,
                7.416573655720106e-10,
                1.378985941683875e-9,
                2.562364709309945e-9,
                4.757845098664761e-9,
                8.827278470579498e-9,
                1.636229090109911e-8,
                3.029770275118765e-8,
                5.60356446172463e-8,
                1.035002188183064e-7,
                1.908819908995471e-7,
                3.514393443761759e-7,
                6.458054307182364e-7,
                1.184161580427877e-6,
                2.165991617927408e-6,
                3.950959848046327e-6,
                7.184478349530561e-6,
                1.301855446002451e-5,
                2.349701460943174e-5,
                4.222111950597526e-5,
                7.548725552642356e-5,
                1.342074538201106e-4,
                2.371052278994868e-4,
                4.159461340119209e-4,
                7.239350423704685e-4,
                0.001248896401413519,
                0.002133417034825229,
                0.003604660617632211,
                0.006016806818422944,
                0.0099085645698111,
                0.016076236188896,
                0.02565841794770776,
                0.04022065921933825,
                0.06181684654128648,
                0.09298977111562878,
                0.1366599553885189,
                0.1958465541204807,
                0.2731772676317286,
                0.3701859340021854,
                0.4864706003559935,
                0.6188805105476112,
                0.7609864073682961,
                0.9031172926068138,
                1.033172699401681,
                1.138228152553046,
                1.206684657723268,
                1.230468750000003,
                1.206684657723267,
                1.138228152553047,
                1.033172699401683,
                0.9031172926068127,
                0.7609864073682965,
                0.6188805105476115,
                0.4864706003559935,
                0.3701859340021854,
                0.2731772676317287,
                0.1958465541204807,
                0.1366599553885189,
                0.09298977111562876,
                0.06181684654128643,
                0.04022065921933821,
                0.02565841794770775,
                0.016076236188896,
                0.00990856456981109,
                0.006016806818422938,
                0.003604660617632208,
                0.002133417034825229,
                0.001248896401413519,
                7.239350423704682e-4,
                4.159461340119207e-4,
                2.371052278994867e-4,
                1.342074538201106e-4,
                7.548725552642358e-5,
                4.222111950597519e-5,
                2.349701460943176e-5,
                1.301855446002451e-5,
                7.184478349530561e-6,
                3.950959848046327e-6,
                2.16599161792741e-6,
                1.184161580427877e-6,
                6.458054307182367e-7,
                3.51439344376176e-7,
                1.908819908995471e-7,
                1.035002188183062e-7,
                5.603564461724618e-8,
                3.029770275118764e-8,
                1.636229090109909e-8,
                8.827278470579502e-9,
                4.757845098664759e-9,
                2.562364709309946e-9,
                1.378985941683875e-9,
                7.41657365572011e-10,
                3.986607685635432e-10,
                2.141848756212808e-10,
                1.150229029356801e-10,
                6.174648775599425e-11,
                3.313539955390414e-11,
                1.777630539715372e-11,
                9.534006268548891e-12,
                5.112196245485121e-12,
                2.740625472859578e-12,
                1.468968530157564e-12,
                7.872365147885676e-13,
                4.21828697274601e-13,
                2.260020729358671e-13,
                1.210711138810466e-13,
                6.485241047650644e-14,
                3.473554913250866e-14,
                1.860326116644764e-14,
                9.962647281391247e-15,
                5.335002381403349e-15,

            ];

            foreach ((FisherZDistribution dist, ddouble[] expecteds) in new[]{
                 (dist_n_1_m_1,   expected_dist_n_1_m_1),
                 (dist_n_2_m_1,   expected_dist_n_2_m_1),
                 (dist_n_1_m_2,   expected_dist_n_1_m_2),
                 (dist_n_2_m_2,   expected_dist_n_2_m_2),
                 (dist_n_3_m_4,   expected_dist_n_3_m_4),
                 (dist_n_4_m_2,   expected_dist_n_4_m_2),
                 (dist_n_2_m_4,   expected_dist_n_2_m_4),
                 (dist_n_4_m_4,   expected_dist_n_4_m_4),
                 (dist_n_6_m_8,   expected_dist_n_6_m_8),
                 (dist_n_8_m_6,   expected_dist_n_8_m_6),
                 (dist_n_8_m_8,   expected_dist_n_8_m_8),
                 (dist_n_10_m_10, expected_dist_n_10_m_10),
            }) {
                for ((ddouble x, int i) = (-4, 0); i < expecteds.Length; x += 1d / 16, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist_n_1_m_1 = [
                0.01165879428012755,
                0.01241053718704674,
                0.01321072526350064,
                0.01406247510539273,
                0.01496910269478434,
                0.01593413592634825,
                0.01696132787329559,
                0.01805467082644291,
                0.0192184111393965,
                0.02045706491151714,
                0.0217754345382357,
                0.02317862615523129,
                0.02467206799873053,
                0.02626152969846986,
                0.02795314251235409,
                0.02975342050215628,
                0.03166928263726923,
                0.03370807579799004,
                0.03587759863043784,
                0.03818612618120501,
                0.04064243521031689,
                0.04325583004496759,
                0.04603616879258496,
                0.04899388967863642,
                0.05214003721060743,
                0.05548628779292216,
                0.05904497432619887,
                0.06282910921586297,
                0.0668524050873682,
                0.07112929235552785,
                0.07567493262117249,
                0.08050522666706367,
                0.08563681559461982,
                0.09108707338209764,
                0.09687408885311768,
                0.1030166347231771,
                0.1095341210449259,
                0.1164465300077956,
                0.1237743286760869,
                0.1315383558899993,
                0.1397596792323406,
                0.148459417715425,
                0.1576585257150231,
                0.1673775337310911,
                0.1776362418619386,
                0.1884533625260042,
                0.1998461100503406,
                0.2118297363685037,
                0.2244170143285849,
                0.2376176730799612,
                0.2514377937193,
                0.2658791778002226,
                0.2809387063190266,
                0.2966077121294223,
                0.3128713940156171,
                0.3297083053176146,
                0.3470899533760957,
                0.3649805473902333,
                0.383336930819039,
                0.4021087296084414,
                0.4212387389881064,
                0.4406635594845659,
                0.4603144778025233,
                0.4801185715417745,
                0.4999999999999994,
                0.5198814284582255,
                0.5396855221974766,
                0.5593364405154341,
                0.5787612610118936,
                0.5978912703915581,
                0.616663069180961,
                0.6350194526097667,
                0.6529100466239043,
                0.6702916946823853,
                0.6871286059843831,
                0.7033922878705781,
                0.7190612936809733,
                0.7341208221997776,
                0.7485622062806999,
                0.7623823269200389,
                0.775582985671415,
                0.7881702636314962,
                0.8001538899496595,
                0.8115466374739959,
                0.8223637581380612,
                0.8326224662689089,
                0.842341474284977,
                0.8515405822845749,
                0.8602403207676595,
                0.8684616441100007,
                0.876225671323913,
                0.8835534699922042,
                0.8904658789550742,
                0.8969833652768228,
                0.9031259111468823,
                0.9089129266179022,
                0.9143631844053801,
                0.9194947733329366,
                0.9243250673788278,
                0.9288707076444723,
                0.9331475949126318,
                0.937170890784137,
                0.9409550256738008,
                0.9445137122070781,
                0.9478599627893926,
                0.9510061103213635,
                0.9539638312074153,
                0.956744169955032,
                0.9593575647896835,
                0.9618138738187951,
                0.9641224013695616,
                0.9662919242020099,
                0.9683307173627308,
                0.9702465794978438,
                0.9720468574876459,
                0.9737384703015304,
                0.9753279320012702,
                0.9768213738447682,
                0.9782245654617643,
                0.9795429350884823,
                0.9807815888606027,
                0.9819453291735563,
                0.9830386721267038,
                0.9840658640736517,
                0.9850308973052156,
                0.9859375248946081,
                0.9867892747364986,
                0.9875894628129536,
                0.9883412057198724,
            ];
            ddouble[] expected_dist_n_2_m_1 = [
                3.35293919463424e-4,
                3.799123480609697e-4,
                4.304644315198003e-4,
                4.877381785310221e-4,
                5.526259392325724e-4,
                6.26138133666654e-4,
                7.094187616742462e-4,
                8.037629183192264e-4,
                9.106365650958742e-4,
                0.00103169883579446,
                0.00116882718702609,
                0.001324145737016319,
                0.001500057172244708,
                0.001699278639575856,
                0.001924882081252796,
                0.002180339510816144,
                0.002469573768657169,
                0.0027970153350725,
                0.003167665814380074,
                0.003587168733203546,
                0.004061888315881493,
                0.004598996905460311,
                0.005206571683883892,
                0.005893701302149815,
                0.006670602950729136,
                0.007548750270472452,
                0.008541012309869851,
                0.009661803458169025,
                0.0109272439044492,
                0.0123553296658584,
                0.01396611056618058,
                0.01578187369844425,
                0.01782732884084789,
                0.02012979098323563,
                0.02271935353557189,
                0.02562904391393389,
                0.02889495103412618,
                0.03255631181564348,
                0.03665554117610578,
                0.04123818729914917,
                0.04635279137789015,
                0.05205062884818733,
                0.05838530770568431,
                0.0654121993242603,
                0.07318767882726657,
                0.08176815612849644,
                0.0912088858689903,
                0.101562555128401,
                0.1128776622350226,
                0.1251967180699987,
                0.138554322207244,
                0.1529751885829215,
                0.168472216918624,
                0.1850447239449007,
                0.2026769593339281,
                0.2213370320184551,
                0.2409763608649405,
                0.2615297385082935,
                0.2829160595025981,
                0.3050397168949293,
                0.3277926198875781,
                0.3510567356132954,
                0.374707016543899,
                0.398614546989802,
                0.4226497308103745,
                0.4466853485453122,
                0.470599333818577,
                0.494277152133755,
                0.5176137049843783,
                0.5405147232868838,
                0.562897651942804,
                0.5846920585511641,
                0.6058396221118065,
                0.6262937715799218,
                0.6460190500544384,
                0.6649902796289169,
                0.6831915962550054,
                0.7006154151320746,
                0.7172613767075425,
                0.7331353125979753,
                0.7482482605163622,
                0.7626155481814206,
                0.7762559584806603,
                0.789190981942245,
                0.801444157780583,
                0.8130405012695413,
                0.824006012774912,
                0.8343672622425437,
                0.8441510420976027,
                0.8533840811915674,
                0.8620928124906668,
                0.8703031875133572,
                0.8780405310014423,
                0.8853294298783253,
                0.8921936511564227,
                0.898656084066987,
                0.9047387022746705,
                0.9104625425904589,
                0.9158476971012657,
                0.9209133160886606,
                0.925677619512226,
                0.930157915186785,
                0.9343706220902245,
                0.9383312975037625,
                0.9420546669135241,
                0.9455546557955269,
                0.9488444225695836,
                0.9519363921453796,
                0.9548422895992279,
                0.9575731736162832,
                0.9601394694129002,
                0.9625510009198175,
                0.9648170220612912,
                0.9669462470097694,
                0.968946879332018,
                0.9708266399718961,
                0.9725927940387669,
                0.9742521763892346,
                0.9758112160049317,
                0.9772759591807046,
                0.9786520915465633,
                0.9799449589535594,
                0.981159587258724,
                0.9823007010478625,
                0.9833727413372866,
                0.9843798822971231,
                0.9853260470393426,
                0.9862149225140652,
                0.9870499735569502,
            ];
            ddouble[] expected_dist_n_1_m_2 = [
                0.01295002644305033,
                0.013785077485936,
                0.01467395296065709,
                0.01562011770287806,
                0.01662725866271011,
                0.01769929895213829,
                0.01884041274127478,
                0.02005504104643931,
                0.02134790845343618,
                0.02272404081929753,
                0.02418878399506879,
                0.02574782361076443,
                0.02740720596123289,
                0.02917336002810471,
                0.03105312066798284,
                0.03305375299022961,
                0.0351829779387103,
                0.03744899908018293,
                0.03986053058709971,
                0.04242682638371677,
                0.04515771040077284,
                0.04806360785461979,
                0.05115557743041655,
                0.05444534420447406,
                0.05794533308647566,
                0.06166870249623796,
                0.06562937790977519,
                0.06984208481321554,
                0.07432238048777447,
                0.07908668391133944,
                0.08415230289873447,
                0.08953745740954111,
                0.09526129772532882,
                0.1013439159330132,
                0.1078063488435774,
                0.1146705701216745,
                0.1219594689985574,
                0.1296968124866429,
                0.1379071875093336,
                0.1466159188084325,
                0.1558489579023973,
                0.1656327377574564,
                0.1759939872250882,
                0.1869594987304586,
                0.198555842219417,
                0.210809018057755,
                0.2237440415193395,
                0.2373844518185794,
                0.251751739483638,
                0.2668646874020248,
                0.2827386232924576,
                0.2993845848679256,
                0.3168084037449946,
                0.3350097203710832,
                0.3539809499455614,
                0.3737062284200782,
                0.3941603778881935,
                0.4153079414488359,
                0.4371023480571959,
                0.4594852767131163,
                0.4823862950156217,
                0.505722847866245,
                0.529400666181423,
                0.553314651454688,
                0.5773502691896255,
                0.6013854530101982,
                0.6252929834561007,
                0.6489432643867046,
                0.6722073801124219,
                0.6949602831050707,
                0.7170839404974024,
                0.7384702614917066,
                0.7590236391350597,
                0.7786629679815448,
                0.797323040666072,
                0.8149552760550994,
                0.831527783081376,
                0.8470248114170785,
                0.861445677792756,
                0.8748032819300012,
                0.8871223377649773,
                0.898437444871599,
                0.9087911141310097,
                0.9182318438715035,
                0.9268123211727334,
                0.9345878006757397,
                0.9416146922943157,
                0.9479493711518127,
                0.9536472086221098,
                0.9587618127008507,
                0.9633444588238942,
                0.9674436881843566,
                0.9711050489658738,
                0.974370956086066,
                0.9772806464644281,
                0.9798702090167644,
                0.9821726711591521,
                0.9842181263015557,
                0.9860338894338194,
                0.9876446703341416,
                0.9890727560955508,
                0.990338196541831,
                0.9914589876901302,
                0.9924512497295276,
                0.9933293970492708,
                0.9941062986978502,
                0.9947934283161162,
                0.9954010030945397,
                0.9959381116841185,
                0.9964128312667965,
                0.9968323341856199,
                0.9972029846649275,
                0.9975304262313428,
                0.9978196604891838,
                0.9980751179187473,
                0.9983007213604241,
                0.9984999428277552,
                0.9986758542629838,
                0.998831172812974,
                0.9989683011642055,
                0.9990893634349042,
                0.9991962370816807,
                0.9992905812383257,
                0.9993738618663333,
                0.9994473740607674,
                0.9995122618214689,
                0.9995695355684802,
                0.9996200876519391,
                0.9996647060805366,
            ];
            ddouble[] expected_dist_n_2_m_2 = [
                3.35350130466478e-4,
                3.799845147518643e-4,
                4.305570813246147e-4,
                4.878571227822658e-4,
                5.527786369235993e-4,
                6.263341581094198e-4,
                7.09670399100588e-4,
                8.04085935629235e-4,
                9.11051194400645e-4,
                0.001032231036754819,
                0.001169510265055514,
                0.00132502241721316,
                0.001501182256736991,
                0.001700722411435287,
                0.001926734663327474,
                0.002182716445345179,
                0.002472623156634773,
                0.002800926967120972,
                0.003172682842485187,
                0.003593602581420087,
                0.004070137715896126,
                0.004609572179374207,
                0.005220125693558396,
                0.005911068856243793,
                0.006692850924284853,
                0.007577241267860808,
                0.008577485413711982,
                0.009708476481474063,
                0.01098694263059317,
                0.01243165085318581,
                0.01406362704324546,
                0.0159063917118147,
                0.01798620996209155,
                0.02033235334265874,
                0.0229773699100256,
                0.02595735719779684,
                0.02931223075135631,
                0.03308597838870411,
                0.03732688734412944,
                0.04208772791561882,
                0.04742587317756676,
                0.05340332979982421,
                0.06008665017400758,
                0.06754669113962908,
                0.07585818002124353,
                0.0850990450070202,
                0.09534946489910943,
                0.1066905939456512,
                0.1192029220221175,
                0.1329642401978292,
                0.1480471980316895,
                0.1645164628965631,
                0.1824255238063562,
                0.2018132222603787,
                0.2227001388253087,
                0.2450850131323716,
                0.268941421369995,
                0.2942149721629886,
                0.3208213008246069,
                0.3486451353339456,
                0.3775406687981453,
                0.40733340004593,
                0.4378234991142015,
                0.4687906266262436,
                0.4999999999999998,
                0.5312093733737566,
                0.5621765008857983,
                0.59266659995407,
                0.6224593312018547,
                0.6513548646660543,
                0.6791786991753931,
                0.7057850278370114,
                0.7310585786300049,
                0.7549149868676284,
                0.7772998611746912,
                0.7981867777396213,
                0.8175744761936438,
                0.835483537103437,
                0.8519528019683107,
                0.867035759802171,
                0.8807970779778824,
                0.8933094060543487,
                0.9046505351008906,
                0.9149009549929799,
                0.9241418199787563,
                0.9324533088603709,
                0.9399133498259924,
                0.9465966702001757,
                0.9525741268224333,
                0.9579122720843811,
                0.9626731126558705,
                0.9669140216112958,
                0.9706877692486438,
                0.9740426428022031,
                0.9770226300899744,
                0.9796676466573412,
                0.9820137900379085,
                0.9840936082881854,
                0.9859363729567546,
                0.9875683491468142,
                0.9890130573694068,
                0.9902915235185259,
                0.9914225145862879,
                0.9924227587321393,
                0.9933071490757152,
                0.9940889311437562,
                0.9947798743064417,
                0.9953904278206257,
                0.995929862284104,
                0.99640639741858,
                0.9968273171575147,
                0.997199073032879,
                0.9975273768433652,
                0.9978172835546548,
                0.9980732653366725,
                0.9982992775885647,
                0.9984988177432631,
                0.9986749775827868,
                0.9988304897349445,
                0.9989677689632451,
                0.9990889488055993,
                0.9991959140643707,
                0.9992903296008994,
                0.9993736658418906,
                0.9994472213630764,
                0.9995121428772178,
                0.9995694429186753,
                0.9996200154852481,
                0.9996646498695335,
            ];
            ddouble[] expected_dist_n_3_m_4 = [
                9.971688239365843e-6,
                1.202730610069793e-5,
                1.450654437395625e-5,
                1.749665269218941e-5,
                2.110283252876802e-5,
                2.545192414445807e-5,
                3.069684830657368e-5,
                3.702195639375482e-5,
                4.464947343372118e-5,
                5.384725566297334e-5,
                6.493812850787533e-5,
                7.831112383076125e-5,
                9.443499846072655e-5,
                1.138744912987055e-4,
                1.373098658076113e-4,
                1.655603909527213e-4,
                1.996125394764571e-4,
                2.406538309711286e-4,
                2.901134221124668e-4,
                3.497107515319083e-4,
                4.215137863029231e-4,
                5.080086952084236e-4,
                6.121830950924738e-4,
                7.376253845421182e-4,
                8.886430968790673e-4,
                0.001070403673362454,
                0.001289101576410963,
                0.001552156226341681,
                0.001868445842474423,
                0.002248582880865316,
                0.002705237354961824,
                0.003253514854465688,
                0.00391139647232279,
                0.00470024801229005,
                0.005645405645807214,
                0.006776844437268749,
                0.008129934626400489,
                0.009746287945999854,
                0.01167469219201392,
                0.01397212630664492,
                0.01670483987400377,
                0.01994946960969959,
                0.02379415060424223,
                0.02833956129731128,
                0.03369981817612384,
                0.04000310917319677,
                0.04739192451444751,
                0.05602271214368678,
                0.06606475496623208,
                0.07769804383617558,
                0.09110991019841103,
                0.1064901942168351,
                0.1240247681020865,
                0.1438873204403983,
                0.1662294440132136,
                0.1911692604208467,
                0.2187790547452908,
                0.2490726651367889,
                0.2819936432546965,
                0.3174054247438459,
                0.3550848668002364,
                0.3947204642355542,
                0.4359163022815229,
                0.4782023306271486,
                0.5210508807675741,
                0.5638985797139819,
                0.6061720610789071,
                0.6473152812445606,
                0.6868159398073169,
                0.7242285556443976,
                0.7591921649051143,
                0.7914413098081164,
                0.8208098434012021,
                0.8472279275034141,
                0.8707133062726071,
                0.8913584001109577,
                0.909314949123266,
                0.9247778652311721,
                0.9379696914757479,
                0.9491266983506326,
                0.9584872496255367,
                0.9662827061164815,
                0.9727308436789529,
                0.97803155685506,
                0.982364499725398,
                0.9858882670262621,
                0.9887407229679543,
                0.9910401236671698,
                0.9928867355590786,
                0.9943647143565861,
                0.9955440688661784,
                0.9964825865113168,
                0.9972276406590944,
                0.997817833499222,
                0.9982844530737544,
                0.9986527404254615,
                0.9989429742115661,
                0.999171386944954,
                0.9993509305236812,
                0.9994919099125095,
                0.999602503541787,
                0.9996891877809142,
                0.999757081148504,
                0.9998102220280048,
                0.9998517917536482,
                0.9998842931309625,
                0.9999096928207466,
                0.9999295345724897,
                0.99994502904726,
                0.9999571249121376,
                0.9999665650018235,
                0.9999739306083286,
                0.9999796763560724,
                0.9999841576275313,
                0.9999876521057508,
                0.9999903766785261,
                0.9999925006910768,
                0.9999941563278057,
                0.9999954467394326,
                0.9999964524012607,
                0.999997236084894,
                0.9999978467439323,
                0.9999983225496031,
                0.999998693261427,
                0.9999989820779781,
                0.9999992070813453,
                0.9999993823642058,
                0.9999995189090536,
                0.999999625273951,
            ];
            ddouble[] expected_dist_n_4_m_2 = [
                4.495372846865647e-7,
                5.771142535171754e-7,
                7.408794819565615e-7,
                9.510900705031735e-7,
                1.220906730374582e-6,
                1.567214096206061e-6,
                2.011672040096679e-6,
                2.582062697463625e-6,
                3.314015888328217e-6,
                4.253218512841401e-6,
                5.458242633168959e-6,
                7.004163978796679e-6,
                8.987189599573592e-6,
                1.15305729237736e-5,
                1.479216976593544e-5,
                1.897408383617265e-5,
                2.433496989800702e-5,
                3.12057128405306e-5,
                4.000938874243368e-5,
                5.128664807619601e-5,
                6.572795162501682e-5,
                8.421444815114052e-5,
                1.078697225864317e-4,
                1.381251790099243e-4,
                1.768024691066307e-4,
                2.262171489289886e-4,
                2.893086571365676e-4,
                3.698027639125062e-4,
                4.724138395178991e-4,
                6.030956174663258e-4,
                7.693505379222347e-4,
                9.806091747001481e-4,
                0.001248692545865991,
                0.00158837108559831,
                0.002018034424500562,
                0.002560485483053099,
                0.003243870187972307,
                0.004102749682972313,
                0.005179314385339653,
                0.006524727685756382,
                0.008200570518363275,
                0.01028033558199304,
                0.01285089118218006,
                0.01601379971877297,
                0.01988633617093611,
                0.0246020106185152,
                0.03031036112886549,
                0.03717575689401764,
                0.04537494623398033,
                0.05509311126308841,
                0.06651826147333326,
                0.07983391979473016,
                0.09521022764755324,
                0.1127938106111404,
                0.1326969814619423,
                0.1549870779149979,
                0.1796768953806256,
                0.2067172367972892,
                0.235992528695888,
                0.2673202327856783,
                0.3004544318164463,
                0.3350935328857229,
                0.370891578211238,
                0.4074722576792649,
                0.4444444444444441,
                0.4814179650034952,
                0.5180183761508393,
                0.5538997286372492,
                0.588754603382026,
                0.6223210526613835,
                0.6543864108063137,
                0.6847882146615937,
                0.713412669426426,
                0.7401912044235184,
                0.7650956938964354,
                0.7881328869663843,
                0.8093385186735834,
                0.8287714800904272,
                0.8465083259193644,
                0.8626383043374053,
                0.8772590131581478,
                0.8904727218681625,
                0.902383351150208,
                0.9130940687046024,
                0.9227054401289149,
                0.9313140635899373,
                0.9390116143827424,
                0.9458842279050137,
                0.9520121551919473,
                0.9574696325070146,
                0.9623249145147462,
                0.9666404285562166,
                0.9704730150533007,
                0.9738742258292247,
                0.9768906580366097,
                0.979564306411225,
                0.9819329207608779,
                0.9840303590292545,
                0.9858869290350493,
                0.9875297141725905,
                0.9889828800631295,
                0.990267960450303,
                0.991404121613517,
                0.9924084052934287,
                0.9932959506385928,
                0.9940801960367571,
                0.9947730619250299,
                0.9953851158100547,
                0.9959257207960696,
                0.9964031689341624,
                0.9968248006847629,
                0.9971971117387678,
                0.9975258483793887,
                0.9978160924933063,
                0.9980723372609199,
                0.9982985544749085,
                0.9984982543565389,
                0.9986745386618782,
                0.9988301477964966,
                0.9989675025880881,
                0.9990887413020727,
                0.9991957524258488,
                0.9992902036928963,
                0.9993735677682809,
                0.9994471449720267,
                0.9995120833760783,
                0.9995693965738275,
                0.9996199793881917,
                0.9996646217546068,
            ];
            ddouble[] expected_dist_n_2_m_4 = [
                3.353782453931887e-4,
                3.800206118084242e-4,
                4.306034261725358e-4,
                4.879166239217864e-4,
                5.528550279731208e-4,
                6.264322317191997e-4,
                7.097963071035643e-4,
                8.042475741510566e-4,
                9.112586979272533e-4,
                0.001032497411912101,
                0.001169852203503474,
                0.001325461338121783,
                0.001501745643461096,
                0.001701445525091693,
                0.001927662739080206,
                0.002183907506693646,
                0.002474151620611461,
                0.002802888261232274,
                0.003175199315237134,
                0.003596831065837651,
                0.004074279203930629,
                0.004614884189945144,
                0.005226938074970148,
                0.005919803963243135,
                0.006704049361407146,
                0.007591594706571463,
                0.00859587838648294,
                0.009732039549697211,
                0.01101711993687063,
                0.01247028582740951,
                0.01411307096495082,
                0.01596964097074554,
                0.01806707923912189,
                0.02043569358877511,
                0.02310934196339038,
                0.02612577417077531,
                0.02952698494669912,
                0.03335957144378353,
                0.03767508548525397,
                0.04253036749298542,
                0.04798784480805274,
                0.05411577209498635,
                0.06098838561725774,
                0.06868593641006268,
                0.07729455987108508,
                0.08690593129539748,
                0.09761664884979228,
                0.1095272781318374,
                0.1227409868418523,
                0.1373616956625947,
                0.1534916740806357,
                0.1712285199095729,
                0.1906614813264166,
                0.2118671130336158,
                0.2349043061035646,
                0.2598087955764818,
                0.2865873305735741,
                0.315211785338406,
                0.3456135891936863,
                0.3776789473386165,
                0.4112453966179739,
                0.4461002713627507,
                0.4819816238491604,
                0.5185820349965051,
                0.555555555555556,
                0.5925277423207352,
                0.6291084217887618,
                0.6649064671142769,
                0.6995455681835537,
                0.7326797672143217,
                0.7640074713041122,
                0.7932827632027107,
                0.8203231046193745,
                0.845012922085002,
                0.8673030185380577,
                0.8872061893888596,
                0.9047897723524468,
                0.9201660802052698,
                0.9334817385266668,
                0.9449068887369116,
                0.9546250537660197,
                0.9628242431059824,
                0.9696896388711346,
                0.9753979893814848,
                0.980113663829064,
                0.9839862002812271,
                0.9871491088178199,
                0.989719664418007,
                0.9917994294816367,
                0.9934752723142436,
                0.9948206856146603,
                0.9958972503170277,
                0.9967561298120277,
                0.9974395145169469,
                0.9979819655754995,
                0.9984116289144017,
                0.998751307454134,
                0.9990193908252999,
                0.9992306494620777,
                0.9993969043825337,
                0.9995275861604821,
                0.9996301972360875,
                0.9997106913428634,
                0.999773782851071,
                0.9998231975308933,
                0.9998618748209901,
                0.9998921302774135,
                0.9999157855518489,
                0.999934272048375,
                0.9999487133519238,
                0.9999599906112576,
                0.9999687942871595,
                0.999975665030102,
                0.9999810259161638,
                0.999985207830234,
                0.9999884694270762,
                0.9999910128104005,
                0.9999929958360212,
                0.9999945417573668,
                0.9999957467814872,
                0.9999966859841116,
                0.9999974179373026,
                0.9999979883279599,
                0.9999984327859038,
                0.9999987790932696,
                0.9999990489099295,
                0.999999259120518,
                0.9999994228857465,
                0.9999995504627153,
            ];
            ddouble[] expected_dist_n_4_m_4 = [
                3.373037032548083e-7,
                4.330549637695026e-7,
                5.559785680092704e-7,
                7.137814922965201e-7,
                9.163548455696996e-7,
                1.176392017981174e-6,
                1.510181400526926e-6,
                1.938622805365612e-6,
                2.488530465456356e-6,
                3.194303053495119e-6,
                4.100063574916216e-6,
                5.262400575960915e-6,
                6.753878530777078e-6,
                8.667531630336591e-6,
                1.112261412951713e-5,
                1.427195522397337e-5,
                1.83113612544699e-5,
                2.349162800646584e-5,
                3.013387733636684e-5,
                3.864912311933743e-5,
                4.956321110511707e-5,
                6.354857721604001e-5,
                8.146464292346075e-5,
                1.044091308885456e-4,
                1.337831579622927e-4,
                1.713736673649343e-4,
                2.194576210065823e-4,
                2.809334112782231e-4,
                3.594861935058165e-4,
                4.597953063998461e-4,
                5.877936508508316e-4,
                7.509908346390888e-4,
                9.588740337024287e-4,
                0.001223402800857809,
                0.001559616341202517,
                0.001986373853771132,
                0.002527250074694082,
                0.003211608650078349,
                0.004075874712015472,
                0.005165024070249069,
                0.006534298516623312,
                0.008251143318829948,
                0.01039734223937002,
                0.01307129539957885,
                0.0163903441758095,
                0.02049299377726718,
                0.02554081814833752,
                0.03171975544815278,
                0.03924042096596454,
                0.04833698782463994,
                0.05926412960261898,
                0.07229150423389595,
                0.08769531102160376,
                0.1057465994419683,
                0.1266962720219212,
                0.1507571128814001,
                0.178083673697047,
                0.208751411991669,
                0.2427370177464629,
                0.2799022667974104,
                0.3199838739458251,
                0.3625915745576133,
                0.4072159870874837,
                0.453246737358317,
                0.5000000000000004,
                0.5467532626416831,
                0.5927840129125165,
                0.6374084254423867,
                0.6800161260541748,
                0.7200977332025897,
                0.7572629822535372,
                0.791248588008331,
                0.821916326302953,
                0.8492428871185999,
                0.8733037279780788,
                0.8942534005580317,
                0.9123046889783963,
                0.9277084957661041,
                0.940735870397381,
                0.9516630121753601,
                0.9607595790340354,
                0.9682802445518471,
                0.9744591818516625,
                0.9795070062227329,
                0.9836096558241905,
                0.9869287046004211,
                0.9896026577606301,
                0.99174885668117,
                0.9934657014833767,
                0.994834975929751,
                0.9959241252879845,
                0.9967883913499216,
                0.9974727499253059,
                0.9980136261462289,
                0.9984403836587975,
                0.9987765971991422,
                0.9990411259662976,
                0.9992490091653609,
                0.9994122063491492,
                0.9995402046936002,
                0.9996405138064941,
                0.9997190665887217,
                0.9997805423789934,
                0.999828626332635,
                0.9998662168420377,
                0.9998955908691114,
                0.9999185353570765,
                0.999936451422784,
                0.9999504367888948,
                0.9999613508768805,
                0.9999698661226636,
                0.9999765083719935,
                0.9999816886387455,
                0.999985728044776,
                0.9999888773858704,
                0.9999913324683697,
                0.9999932461214692,
                0.999994737599424,
                0.999995899936425,
                0.9999968056969464,
                0.9999975114695344,
                0.9999980613771947,
                0.9999984898185994,
                0.999998823607982,
                0.9999990836451544,
                0.9999992862185078,
                0.9999994440214319,
                0.9999995669450362,
                0.9999996626962967,
            ];
            ddouble[] expected_dist_n_6_m_8 = [
                3.18106578481739e-10,
                4.627609711085166e-10,
                6.73179114995849e-10,
                9.792487553717342e-10,
                1.424434143715122e-9,
                2.071938875101302e-9,
                3.013663467662883e-9,
                4.383223252392352e-9,
                6.374864074881615e-9,
                9.270942956947071e-9,
                1.348184386293577e-8,
                1.960394227214879e-8,
                2.850375795219494e-8,
                4.144009184292673e-8,
                6.024123302638634e-8,
                8.756196929850519e-8,
                1.272561808259131e-7,
                1.849167351439273e-7,
                2.686573746337008e-7,
                3.902443563315892e-7,
                5.667331354944771e-7,
                8.228335899698066e-7,
                1.194324967461263e-6,
                1.732981338176346e-6,
                2.513667337685513e-6,
                3.644546852263888e-6,
                5.281748050382282e-6,
                7.650393774046266e-6,
                1.107470109622047e-5,
                1.602096502743875e-5,
                2.315878570493435e-5,
                3.344803001667984e-5,
                4.826193704622672e-5,
                6.95607342194697e-5,
                1.001354363697346e-4,
                1.439485143919316e-4,
                2.066072383341255e-4,
                2.960171039827702e-4,
                4.232771236077006e-4,
                6.038959265351277e-4,
                8.594270950971273e-4,
                0.001219642597204056,
                0.001725381797769664,
                0.002432225462000461,
                0.003415141608849584,
                0.004774221516284365,
                0.006641553885614889,
                0.009189153502228917,
                0.01263764606052975,
                0.01726509407657816,
                0.02341492168217523,
                0.03150137353763011,
                0.04201037943276122,
                0.05549320148306529,
                0.0725499909657692,
                0.09380061063351808,
                0.1198410395350444,
                0.1511855661651147,
                0.1881978130969416,
                0.2310171420009207,
                0.2794904978335599,
                0.3331222505902862,
                0.3910549298105733,
                0.4520910197747797,
                0.5147600064598922,
                0.5774265088612192,
                0.6384264959270569,
                0.6962117546544099,
                0.7494801204303492,
                0.7972715391861003,
                0.8390171979238094,
                0.8745386680955817,
                0.9040034980344214,
                0.9278505333888929,
                0.9467011206986669,
                0.961271312951061,
                0.9722963786300708,
                0.9804739160147948,
                0.9864271486609454,
                0.9906864600263801,
                0.9936852391754186,
                0.9957655020255183,
                0.9971891165181224,
                0.9981513399418716,
                0.9987943996354786,
                0.9992197749600523,
                0.9994985556460603,
                0.9996797378823322,
                0.9997966053971965,
                0.9998714792544239,
                0.9999191584652536,
                0.999949355707639,
                0.9999683882166659,
                0.9999803320136977,
                0.9999877984115872,
                0.9999924498398344,
                0.9999953387447491,
                0.9999971281137193,
                0.999998233766155,
                0.9999989154885669,
                0.9999993350273123,
                0.9999995927816266,
                0.9999997509037452,
                0.9999998477775333,
                0.9999999070581587,
                0.9999999432966865,
                0.999999965429235,
                0.9999999789356887,
                0.999999987172156,
                0.9999999921917243,
                0.9999999952491041,
                0.9999999971104124,
                0.9999999982430685,
                0.9999999989320549,
                0.9999999993510179,
                0.9999999996057068,
                0.9999999997604923,
                0.9999999998545399,
                0.9999999999116713,
                0.999999999946371,
                0.9999999999674429,
                0.9999999999802373,
                0.9999999999880048,
                0.99999999999272,
                0.9999999999955821,
                0.999999999997319,
                0.9999999999983732,
                0.9999999999990129,
                0.9999999999994011,
            ];
            ddouble[] expected_dist_n_8_m_6 = [
                5.988736826775332e-13,
                9.870467031199051e-13,
                1.626750359901658e-12,
                2.68091036895689e-12,
                4.417931206239572e-12,
                7.279936443413367e-12,
                1.199511696750361e-11,
                1.976266140446664e-11,
                3.255709442758035e-11,
                5.362900081171653e-11,
                8.832863177087952e-11,
                1.454601717291314e-10,
                2.395077829333737e-10,
                3.942931359259672e-10,
                6.489822082987418e-10,
                1.067945189356655e-9,
                1.756931572639695e-9,
                2.889587568922285e-9,
                4.750895843272846e-9,
                7.808275750168485e-9,
                1.282784404669021e-8,
                2.106431125235356e-8,
                3.457076498313302e-8,
                5.670331341562634e-8,
                9.294184138227873e-8,
                1.522224667345913e-7,
                2.490962548058998e-7,
                4.072183733489348e-7,
                6.649726877880635e-7,
                1.084511433240503e-6,
                1.766233844953045e-6,
                2.871886280587906e-6,
                4.66125525098401e-6,
                7.550160165524111e-6,
                1.220158841267373e-5,
                1.96679863022472e-5,
                3.161178333406934e-5,
                5.06442923609594e-5,
                8.084153474632866e-5,
                1.285207455761027e-4,
                2.033946028035575e-4,
                3.202621176676876e-4,
                5.014443539397353e-4,
                7.802250399476878e-4,
                0.001205600364521411,
                0.001848660058128377,
                0.002810883481877521,
                0.004234497974481757,
                0.006314760824581355,
                0.009313539973619974,
                0.01357285133905448,
                0.01952608398520514,
                0.02770362136992919,
                0.03872868704893895,
                0.05329887930133325,
                0.072149466611107,
                0.0959965019655787,
                0.1254613319044183,
                0.1609828020761906,
                0.2027284608138997,
                0.2505198795696509,
                0.3037882453455902,
                0.361573504072943,
                0.4225734911387808,
                0.4852399935401074,
                0.5479089802252204,
                0.6089450701894268,
                0.6668777494097136,
                0.72050950216644,
                0.7689828579990793,
                0.8118021869030584,
                0.8488144338348852,
                0.8801589604649556,
                0.906199389366482,
                0.9274500090342308,
                0.9445067985169349,
                0.9579896205672387,
                0.96849862646237,
                0.9765850783178249,
                0.9827349059234218,
                0.9873623539394701,
                0.9908108464977711,
                0.9933584461143852,
                0.9952257784837155,
                0.9965848583911503,
                0.9975677745379996,
                0.9982746182022303,
                0.9987803574027959,
                0.9991405729049028,
                0.9993961040734649,
                0.9995767228763923,
                0.9997039828960173,
                0.9997933927616658,
                0.9998560514856081,
                0.9998998645636303,
                0.9999304392657806,
                0.9999517380629539,
                0.9999665519699833,
                0.9999768412142951,
                0.9999839790349725,
                0.9999889252989038,
                0.9999923496062258,
                0.9999947182519496,
                0.9999963554531478,
                0.9999974863326624,
                0.9999982670186618,
                0.9999988056750325,
                0.99999917716641,
                0.9999994332668646,
                0.9999996097556436,
                0.9999997313426253,
                0.999999815083265,
                0.9999998727438192,
                0.9999999124380307,
                0.999999939758767,
                0.9999999585599082,
                0.9999999714962421,
                0.9999999803960578,
                0.9999999865181562,
                0.999999990729057,
                0.9999999936251358,
                0.9999999956167769,
                0.9999999969863366,
                0.9999999979280612,
                0.9999999985755659,
                0.9999999990207512,
                0.999999999326821,
                0.9999999995372392,
                0.9999999996818935,
            ];
            ddouble[] expected_dist_n_8_m_8 = [
                4.422953588564517e-13,
                7.290134192383387e-13,
                1.201550826776251e-12,
                1.980295757804599e-12,
                3.263598803090508e-12,
                5.378230993988075e-12,
                8.862472915644415e-12,
                1.460291497288704e-11,
                2.405964746319666e-11,
                3.963687327228576e-11,
                6.529270858890944e-11,
                1.07542269355307e-10,
                1.77107185122371e-10,
                2.916271828016669e-10,
                4.801158225931232e-10,
                7.90279004439358e-10,
                1.300529483266889e-9,
                2.139699361719695e-9,
                3.519361860659072e-9,
                5.786789052562334e-9,
                9.511648364268039e-9,
                1.562779834276665e-8,
                2.56649531440767e-8,
                4.212671387417529e-8,
                6.91065923506745e-8,
                1.132902887205767e-7,
                1.855835182155619e-7,
                3.037504932145684e-7,
                4.966807790272244e-7,
                8.11271623640519e-7,
                1.323496336127249e-6,
                2.156145349253627e-6,
                3.507154754565558e-6,
                5.694645557614368e-6,
                9.228179816540879e-6,
                1.492086469598271e-5,
                2.406459868469941e-5,
                3.870203695518464e-5,
                6.204515858391157e-5,
                9.911335503886542e-5,
                1.576955999520225e-4,
                2.497831749824046e-4,
                3.936723304543743e-4,
                6.169985726890146e-4,
                9.610299815071999e-4,
                0.001486602574021249,
                0.002282101453865145,
                0.003473837451620932,
                0.005238983287545502,
                0.007820845217110616,
                0.01154558395919976,
                0.01683851769123961,
                0.02423686790254562,
                0.03439440579076447,
                0.0480722699950521,
                0.06610980725469749,
                0.08937032126906182,
                0.1186597208100888,
                0.1546214604325339,
                0.1976183221965225,
                0.2476189484091354,
                0.3041121924541111,
                0.3660726925340931,
                0.4319948632384634,
                0.4999999999999998,
                0.5680051367615366,
                0.6339273074659068,
                0.6958878075458887,
                0.7523810515908643,
                0.8023816778034776,
                0.8453785395674661,
                0.8813402791899112,
                0.9106296787309381,
                0.9338901927453024,
                0.9519277300049478,
                0.9656055942092355,
                0.9757631320974544,
                0.9831614823087604,
                0.9884544160408002,
                0.9921791547828893,
                0.9947610167124545,
                0.996526162548379,
                0.9977178985461348,
                0.9985133974259788,
                0.9990389700184927,
                0.9993830014273111,
                0.9996063276695456,
                0.9997502168250175,
                0.999842304400048,
                0.9999008866449611,
                0.9999379548414161,
                0.9999612979630448,
                0.9999759354013154,
                0.999985079135304,
                0.9999907718201834,
                0.9999943053544424,
                0.9999964928452454,
                0.9999978438546508,
                0.9999986765036638,
                0.9999991887283763,
                0.9999995033192209,
                0.9999996962495068,
                0.9999998144164818,
                0.9999998867097113,
                0.9999999308934077,
                0.9999999578732861,
                0.999999974335047,
                0.9999999843722016,
                0.9999999904883516,
                0.999999994213211,
                0.9999999964806381,
                0.9999999978603006,
                0.9999999986994705,
                0.999999999209721,
                0.9999999995198842,
                0.9999999997083727,
                0.9999999998228928,
                0.9999999998924577,
                0.9999999999347073,
                0.9999999999603632,
                0.9999999999759404,
                0.9999999999853971,
                0.9999999999911375,
                0.9999999999946217,
                0.9999999999967364,
                0.9999999999980197,
                0.9999999999987984,
                0.9999999999992709,
                0.9999999999995578,
            ];
            ddouble[] expected_dist_n_10_m_10 = [
                5.337985776459294e-16,
                9.968960470499172e-16,
                1.861661981421127e-15,
                3.476381410903632e-15,
                6.491221079857277e-15,
                1.211976233480463e-14,
                2.262696829939815e-14,
                4.223947233146012e-14,
                7.884335830737774e-14,
                1.471499827329017e-13,
                2.745977290322207e-13,
                5.123509423681573e-13,
                9.557916468412078e-13,
                1.782682800725428e-12,
                3.324212785822847e-12,
                6.19718858706481e-12,
                1.154987654182601e-11,
                2.151891553513798e-11,
                4.007793690509555e-11,
                7.461246224440152e-11,
                1.388400577274452e-10,
                2.58219397242288e-10,
                4.799581586037187e-10,
                8.915057909790304e-10,
                1.654674724602784e-9,
                3.068493269055763e-9,
                5.684765777050623e-9,
                1.052008616756849e-8,
                1.944386985129833e-8,
                3.58865913866676e-8,
                6.612844455756478e-8,
                1.216358328583768e-7,
                2.232807599593628e-7,
                4.08925925307445e-7,
                7.469900862038967e-7,
                1.360566936937643e-6,
                2.470023403813716e-6,
                4.467668879030694e-6,
                8.047519114243775e-6,
                1.442860765762155e-5,
                2.573501563357402e-5,
                4.563440937348468e-5,
                8.03953927612071e-5,
                1.406093151294106e-4,
                2.439405757279679e-4,
                4.194229027610548e-4,
                7.139984844596698e-4,
                0.001202171170518635,
                0.001999746368617501,
                0.003282538091633706,
                0.005310455886599858,
                0.008456312372200118,
                0.01323680072640808,
                0.02034030688439325,
                0.0306428071141208,
                0.04519987535087029,
                0.06520126840742237,
                0.0918766322696248,
                0.1263483604940737,
                0.1694410136483228,
                0.2214739383264899,
                0.2820797233427494,
                0.350098778607833,
                0.423593269338424,
                0.5000000000000016,
                0.5764067306615762,
                0.6499012213921672,
                0.7179202766572504,
                0.7785260616735101,
                0.8305589863516774,
                0.8736516395059261,
                0.9081233677303753,
                0.9347987315925775,
                0.9548001246491297,
                0.9693571928858791,
                0.9796596931156067,
                0.9867631992735919,
                0.9915436876277999,
                0.9946895441134002,
                0.9967174619083663,
                0.9980002536313825,
                0.9987978288294813,
                0.9992860015155404,
                0.9995805770972389,
                0.9997560594242719,
                0.9998593906848705,
                0.9999196046072387,
                0.9999543655906264,
                0.9999742649843665,
                0.9999855713923425,
                0.9999919524808858,
                0.999995532331121,
                0.9999975299765962,
                0.9999986394330631,
                0.9999992530099138,
                0.9999995910740747,
                0.99999977671924,
                0.9999998783641671,
                0.9999999338715555,
                0.9999999641134086,
                0.9999999805561302,
                0.9999999894799139,
                0.9999999943152342,
                0.9999999969315067,
                0.9999999983453253,
                0.9999999991084942,
                0.9999999995200419,
                0.9999999997417807,
                0.99999999986116,
                0.9999999999253876,
                0.9999999999599221,
                0.9999999999784811,
                0.9999999999884501,
                0.9999999999938028,
                0.9999999999966758,
                0.9999999999982174,
                0.9999999999990441,
                0.9999999999994877,
                0.9999999999997254,
                0.9999999999998529,
                0.9999999999999212,
                0.9999999999999578,
                0.9999999999999774,
                0.9999999999999878,
                0.9999999999999934,
                0.9999999999999966,
                0.9999999999999981,
                0.999999999999999,
                0.9999999999999994,
            ];

            foreach ((FisherZDistribution dist, ddouble[] expecteds) in new[]{
                 (dist_n_1_m_1,   expected_dist_n_1_m_1),
                 (dist_n_2_m_1,   expected_dist_n_2_m_1),
                 (dist_n_1_m_2,   expected_dist_n_1_m_2),
                 (dist_n_2_m_2,   expected_dist_n_2_m_2),
                 (dist_n_3_m_4,   expected_dist_n_3_m_4),
                 (dist_n_4_m_2,   expected_dist_n_4_m_2),
                 (dist_n_2_m_4,   expected_dist_n_2_m_4),
                 (dist_n_4_m_4,   expected_dist_n_4_m_4),
                 (dist_n_6_m_8,   expected_dist_n_6_m_8),
                 (dist_n_8_m_6,   expected_dist_n_8_m_6),
                 (dist_n_8_m_8,   expected_dist_n_8_m_8),
                 (dist_n_10_m_10, expected_dist_n_10_m_10),
            }) {
                for ((ddouble x, int i) = (-4, 0); i < expecteds.Length; x += 1d / 16, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}