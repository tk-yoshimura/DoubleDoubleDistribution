using DoubleDouble;
using DoubleDoubleStatistic;
using DoubleDoubleStatistic.Utils;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleStatisticTest.ContinuousDistribution {
    [TestClass()]
    public class BetaPrimeDistributionTests {
        readonly BetaPrimeDistribution dist_a1b1 = new(alpha: 1, beta: 1);
        readonly BetaPrimeDistribution dist_a2b1 = new(alpha: 2, beta: 1);
        readonly BetaPrimeDistribution dist_a1b2 = new(alpha: 1, beta: 2);
        readonly BetaPrimeDistribution dist_a2b2 = new(alpha: 2, beta: 2);
        readonly BetaPrimeDistribution dist_a3b4 = new(alpha: 3, beta: 4);
        readonly BetaPrimeDistribution dist_a5b6 = new(alpha: 5, beta: 6);
        readonly BetaPrimeDistribution dist_a7b8 = new(alpha: 7, beta: 8);

        BetaPrimeDistribution[] Dists => [
            dist_a1b1,
            dist_a2b1,
            dist_a1b2,
            dist_a2b2,
            dist_a3b4,
            dist_a5b6,
            dist_a7b8,
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"Alpha={dist.Alpha}");
                Console.WriteLine($"Beta={dist.Beta}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
                Console.WriteLine(dist.Formula);
            }
        }

        [TestMethod()]
        public void MeanTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mean)) {
                    continue;
                }

                ddouble actual = dist.Mean;
                ddouble expected = IntegrationStatistics.Mean(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void ModeTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mode)) {
                    continue;
                }

                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode - 1e-4), $"{dist}\n{dist.Mode}");
                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode + 1e-4), $"{dist}\n{dist.Mode}");
            }
        }

        [TestMethod()]
        public void MedianTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.Abs(dist.CDF(dist.Median) - 0.5) < 1e-20, $"{dist}\n{dist.Median}");
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Variance)) {
                    continue;
                }

                ddouble actual = dist.Variance;
                ddouble expected = IntegrationStatistics.Variance(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void SkewnessTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Skewness)) {
                    continue;
                }

                ddouble actual = dist.Skewness;
                ddouble expected = IntegrationStatistics.Skewness(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void KurtosisTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Kurtosis)) {
                    continue;
                }

                ddouble actual = dist.Kurtosis;
                ddouble expected = IntegrationStatistics.Kurtosis(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void EntropyTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Entropy;
                ddouble expected = IntegrationStatistics.Entropy(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = 0; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void IrregularValueTest() {
            foreach (BetaPrimeDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.NegativeInfinity)) && dist.PDF(ddouble.NegativeInfinity) >= 0d, "pdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue)) && dist.PDF(ddouble.MinValue) >= 0d, "pdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MinValue / 2)) && dist.PDF(ddouble.MinValue / 2) >= 0d, "pdf(-lval / 2)");

                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.PositiveInfinity)) && dist.PDF(ddouble.PositiveInfinity) >= 0d, "pdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue)) && dist.PDF(ddouble.MaxValue) >= 0d, "pdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.PDF(ddouble.MaxValue / 2)) && dist.PDF(ddouble.MaxValue / 2) >= 0d, "pdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.PDF(ddouble.NaN)), "pdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Lower) == 0d, "cdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Lower)) && dist.CDF(ddouble.MinValue, Interval.Lower) >= 0d, "cdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Lower)) && dist.CDF(ddouble.MinValue / 2, Interval.Lower) >= 0d, "cdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Lower) == 1d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Lower)) && dist.CDF(ddouble.MaxValue, Interval.Lower) <= 1d, "cdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Lower)) && dist.CDF(ddouble.MaxValue / 2, Interval.Lower) <= 1d, "cdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Lower)), "cdf(NaN)");

                Assert.IsTrue(dist.CDF(ddouble.NegativeInfinity, Interval.Upper) == 1d, "ccdf(-inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue, Interval.Upper)) && dist.CDF(ddouble.MinValue, Interval.Upper) <= 1d, "ccdf(-lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MinValue / 2, Interval.Upper)) && dist.CDF(ddouble.MinValue / 2, Interval.Upper) <= 1d, "ccdf(-lval / 2)");

                Assert.IsTrue(dist.CDF(ddouble.PositiveInfinity, Interval.Upper) == 0d, "cdf(+inf)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue, Interval.Upper)) && dist.CDF(ddouble.MaxValue, Interval.Upper) >= 0d, "ccdf(+lval)");
                Assert.IsTrue(ddouble.IsFinite(dist.CDF(ddouble.MaxValue / 2, Interval.Upper)) && dist.CDF(ddouble.MaxValue / 2, Interval.Upper) >= 0d, "ccdf(+lval / 2)");

                Assert.IsTrue(ddouble.IsNaN(dist.CDF(ddouble.NaN, Interval.Upper)), "ccdf(NaN)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(0d, Interval.Lower)), "quantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(1d, Interval.Lower)), "quantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(0d, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(0d, Interval.Upper)), "cquantile(0)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(1d, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(1d, Interval.Upper)), "cquantile(1)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Lower)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.Epsilon, Interval.Lower)), "quantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Lower)), "quantile(1-eps)");

                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.Epsilon, Interval.Upper)) || ddouble.IsPositiveInfinity(dist.Quantile(ddouble.Epsilon, Interval.Upper)), "cquantile(0+eps)");
                Assert.IsTrue(ddouble.IsFinite(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)) || ddouble.IsNegativeInfinity(dist.Quantile(ddouble.One - ddouble.Epsilon, Interval.Upper)), "cquantile(1-eps)");
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                1.000000000000000000e+00,
                4.444444444444444198e-01,
                2.500000000000000000e-01,
                1.599999999999999756e-01,
                1.111111111111110911e-01,
                8.163265306122448328e-02,
                6.250000000000000000e-02,
                4.938271604938270637e-02,
                4.000000000000000777e-02,
                3.305785123966942241e-02,
                2.777777777777777971e-02,
                2.366863905325444078e-02,
                2.040816326530612429e-02,
                1.777777777777778123e-02,
                1.562500000000000694e-02,
                1.384083044982699004e-02,
                1.234567901234567486e-02,
                1.108033240997229572e-02,
                9.999999999999995004e-03,
                9.070294784580500841e-03,
                8.264462809917353867e-03,
                7.561436672967865834e-03,
                6.944444444444444059e-03,
                6.399999999999997705e-03,
                5.917159763313609329e-03,
                5.486968449931413361e-03,
                5.102040816326532807e-03,
                4.756242568370986495e-03,
                4.444444444444444441e-03,
                4.162330905306972292e-03,
                3.906250000000000867e-03,
                3.673094582185492101e-03,
                3.460207612456746643e-03,
                3.265306122448978412e-03,
                3.086419753086420883e-03,
                2.921840759678598441e-03,
                2.770083102493076099e-03,
                2.629848783694938540e-03,
                2.500000000000000486e-03,
                2.379535990481855719e-03,
                2.267573696145124777e-03,
                2.163331530557058464e-03,
                2.066115702479338033e-03,
                1.975308641975309556e-03,
                1.890359168241966025e-03,
                1.810774105930284530e-03,
                1.736111111111110581e-03,
                1.665972511453560215e-03,
                1.600000000000000510e-03,
                1.537870049980777105e-03,
                1.479289940828402115e-03,
                1.423994304022783769e-03,
                1.371742112482853123e-03,
                1.322314049586776523e-03,
                1.275510204081632985e-03,
                1.231148045552477640e-03,
                1.189060642092746407e-03,
                1.149095087618500063e-03,
                1.111111111111110893e-03,
                1.074979844127922505e-03,
                1.040582726326742856e-03,
                1.007810531620055745e-03,
                9.765625000000000000e-04,
                9.467455621301773972e-04,
                9.182736455463728084e-04,
                8.910670527957228158e-04,
                8.650519031141865522e-04,
                8.401596303297622801e-04,
                8.163265306122451451e-04,
                7.934933544931562248e-04,
                7.716049382716051123e-04,
                7.506098705197970442e-04,
                7.304601899196495017e-04,
                7.111111111111110368e-04,
                6.925207756232688080e-04,
                6.746500252993757130e-04,
                6.574621959237345265e-04,
                6.409229290177857015e-04,
                6.250000000000000130e-04,
                6.096631611034905541e-04,
                5.948839976204638213e-04,
                5.806357961968358107e-04,
                5.668934240362810857e-04,
                5.536332179930794151e-04,
                5.408328826392645077e-04,
                5.284713964856653469e-04,
                5.165289256198348335e-04,
                5.049867440979672901e-04,
                4.938271604938272805e-04,
                4.830334500664170316e-04,
                4.725897920604914520e-04,
                4.624812117007748497e-04,
                4.526935264825714578e-04,
                4.432132963988921108e-04,
                4.340277777777775911e-04,
                4.251248804336274566e-04,
                4.164931278633903790e-04,
                4.081216202428321967e-04,
                4.000000000000000734e-04,
                3.921184197627682207e-04,
                3.844675124951941678e-04,
                3.770383636535017385e-04,
                3.698224852071004746e-04,
                3.628117913832199079e-04,
                3.559985760056958879e-04,
                3.493754913092846732e-04,
                3.429355281207132266e-04,
                3.366719973066239244e-04,
                3.305785123966940224e-04,
                3.246489732976221574e-04,
                3.188775510204079210e-04,
                3.132586733495182482e-04,
                3.077870113881193558e-04,
                3.024574669187145293e-04,
                2.972651605231868186e-04,
                2.922054204105485760e-04,
                2.872737719046249616e-04,
                2.824659275474895263e-04,
                2.777777777777779402e-04,
                2.732053821460281979e-04,
                2.687449610319805719e-04,
                2.643928878313171575e-04,
                2.601456815816856599e-04,
                2.559999999999998258e-04,
                2.519526329050139363e-04,
                2.480004960009920796e-04,
                2.441406250000001626e-04,
                2.403701700618954512e-04,
                2.366863905325445390e-04,
                2.330866499621232096e-04,
                2.295684113865933647e-04,
                2.261292328565775965e-04,
                2.227667631989308666e-04,
                2.194787379972564878e-04,
                2.162629757785466109e-04,
                2.131173743939474301e-04,
                2.100399075824405429e-04,
                2.070286217069511358e-04,
                2.040816326530610694e-04,
                2.011971228811427798e-04,
                1.983733386232890291e-04,
                1.956085872169789825e-04,
                1.929012345679012239e-04,
                1.902497027348395856e-04,
                1.876524676299493966e-04,
                1.851080568281735861e-04,
                1.826150474799121857e-04,
                1.801720643214269643e-04,
                1.777777777777778947e-04,
                1.754309021534143566e-04,
                1.731301939058171749e-04,
                1.708744499978641709e-04,
                1.686625063248439011e-04,
                1.664932362122788559e-04,
                1.643655489809336045e-04,
                1.622783885756012953e-04,
                1.602307322544463983e-04,
                1.582215893358649144e-04,
                1.562500000000001388e-04,
                1.543150341422013026e-04,
                1.524157902758724759e-04,
                1.505513944822914124e-04,
                1.487209994051159282e-04,
                1.469237832874197643e-04,
                1.451589490492087900e-04,
                1.434257234034923582e-04,
                1.417233560090703527e-04,
                1.400511186583103143e-04,
                1.384083044982698267e-04,
                1.367942272836085514e-04,
                1.352082206598162353e-04,
                1.336496374753582881e-04,
                1.321178491214163096e-04,
                1.306122448979590920e-04,
                1.291322314049585728e-04,
                1.276772319576112717e-04,
                1.262466860244919038e-04,
                1.248400486876190176e-04,
                1.234567901234567930e-04,
                1.220963951039344918e-04,
                1.207583625166043528e-04,
                1.194422049031024327e-04,
                1.181474480151228359e-04,
                1.168736303871438156e-04,
                1.156203029251935905e-04,
                1.143870285109668225e-04,
                1.131733816206428373e-04,
                1.119789479577839160e-04,
                1.108033240997230006e-04,
                1.096461171568762009e-04,
                1.085069444444444791e-04,
                1.073854331659910481e-04,
                1.062812201084068506e-04,
                1.051939513477975172e-04,
                1.041232819658474863e-04,
                1.030688757762374965e-04,
                1.020304050607081169e-04,
                1.010075503143860514e-04,
                9.999999999999990992e-05,
                9.900745031063590306e-05,
                9.802960494069204163e-05,
                9.706617486471406681e-05,
                9.611687812379860970e-05,
                9.518143961927420706e-05,
                9.425959091337542106e-05,
                9.335107003664036779e-05,
                9.245562130177518642e-05,
                9.157299512373803416e-05,
                9.070294784580504473e-05,
                8.984524157139326479e-05,
                8.899964400142403975e-05,
                8.816592827701729958e-05,
                8.734387282732123607e-05,
                8.653326122228239116e-05,
                8.573388203017829310e-05,
                8.494552867973409937e-05,
                8.416799932665604885e-05,
                8.340109672442191186e-05,
                8.264462809917349204e-05,
                8.189840502856199377e-05,
                8.116224332440552579e-05,
                8.043596291902108792e-05,
                7.971938775510210222e-05,
                7.901234567901236001e-05,
                7.831466833737954849e-05,
                7.762619107686931157e-05,
                7.694675284702982539e-05,
                7.627619610610014895e-05,
                7.561436672967861876e-05,
                7.496111392215293681e-05,
                7.431629013079669110e-05,
                7.367975096244168312e-05,
                7.305135510263713046e-05,
                7.243096423721142078e-05,
                7.181844297615622684e-05,
                7.121365877975393069e-05,
                7.061648188687236801e-05,
                7.002678524535631104e-05,
                6.944444444444447149e-05,
                6.886933764914519613e-05,
                6.830134553650703592e-05,
                6.774035123372118322e-05,
                6.718624025799514298e-05,
                6.663890045814239776e-05,
                6.609822195782939780e-05,
                6.556409710042778013e-05,
                6.503642039542141496e-05,
                6.451508846631509911e-05,
                6.399999999999995645e-05,
                6.349105569752855859e-05,
                6.298815822625347053e-05,
                6.249121217328812991e-05,
                6.200012400024800636e-05,
                6.151480199923101751e-05,
                6.103515625000002711e-05,
                6.056109857832818374e-05,
            ];
            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                2.962962962962963354e-01,
                2.500000000000000555e-01,
                1.920000000000000318e-01,
                1.481481481481481677e-01,
                1.166180758017492658e-01,
                9.375000000000006939e-02,
                7.681755829903980093e-02,
                6.400000000000004297e-02,
                5.409466566491360345e-02,
                4.629629629629629373e-02,
                4.005461993627673634e-02,
                3.498542274052481721e-02,
                3.081481481481482265e-02,
                2.734375000000003469e-02,
                2.442499491145938215e-02,
                2.194787379972565691e-02,
                1.982796325995041242e-02,
                1.799999999999998476e-02,
                1.641291437209803708e-02,
                1.502629601803155343e-02,
                1.380784088107175032e-02,
                1.273148148148147731e-02,
                1.177599999999999307e-02,
                1.092398725534819356e-02,
                1.016105268505817540e-02,
                9.475218658892135826e-03,
                8.856451679035634572e-03,
                8.296296296296303344e-03,
                7.787586855090476712e-03,
                7.324218750000009541e-03,
                6.900965578651527960e-03,
                6.513331976389167242e-03,
                6.157434402332349552e-03,
                5.829903978052135803e-03,
                5.527806842635187012e-03,
                5.248578509986881122e-03,
                4.989969487010903308e-03,
                4.749999999999999015e-03,
                4.526922128233769153e-03,
                4.319187992657375942e-03,
                4.125422918736715294e-03,
                3.944402704733279176e-03,
                3.775034293552812729e-03,
                3.616339278375936116e-03,
                3.467439777313311051e-03,
                3.327546296296293726e-03,
                3.195947266870096965e-03,
                3.072000000000002246e-03,
                2.955122841139534891e-03,
                2.844788347746926745e-03,
                2.740517339817435082e-03,
                2.641873698115123747e-03,
                2.548459804658149887e-03,
                2.459912536443151047e-03,
                2.375899737031099673e-03,
                2.296117101972201813e-03,
                2.220285423534052675e-03,
                2.148148148148149895e-03,
                2.079469206673688602e-03,
                2.014031083213050060e-03,
                1.951633092978519776e-03,
                1.892089843750001084e-03,
                1.835229858898498401e-03,
                1.780894342877814129e-03,
                1.728936072588717733e-03,
                1.679218400162833325e-03,
                1.631614354553450599e-03,
                1.586005830903790574e-03,
                1.542282858028953298e-03,
                1.500342935528118943e-03,
                1.460090433065905878e-03,
                1.421436045249047228e-03,
                1.384296296296295362e-03,
                1.348593089371628298e-03,
                1.314253296037744267e-03,
                1.281208381800099392e-03,
                1.249394064161252508e-03,
                1.218749999999999565e-03,
                1.189219499436437993e-03,
                1.160749263649685833e-03,
                1.133289144384185595e-03,
                1.106791923118453187e-03,
                1.081213108080602333e-03,
                1.056510747481353161e-03,
                1.032645257500725607e-03,
                1.009579263711495598e-03,
                9.872774547533286899e-04,
                9.657064471879294679e-04,
                9.448346605694744188e-04,
                9.246322018574830871e-04,
                9.050707583821617636e-04,
                8.861234986467366945e-04,
                8.677649803178305284e-04,
                8.499710648148138190e-04,
                8.327188379627754270e-04,
                8.159865362221529334e-04,
                7.997534780516107195e-04,
                7.840000000000008420e-04,
                7.687073971586953465e-04,
                7.538578676376363544e-04,
                7.394344607573531377e-04,
                7.254210286754661551e-04,
                7.118021811899365213e-04,
                6.985632434828750563e-04,
                6.856902165883164849e-04,
                6.731697403851040745e-04,
                6.609890589322708031e-04,
                6.491359879789634088e-04,
                6.375988844944297006e-04,
                6.263666180758017477e-04,
                6.154285441025926289e-04,
                6.047744785170061643e-04,
                5.943946741185178852e-04,
                5.842797982697112320e-04,
                5.744209119181728843e-04,
                5.648094498463800822e-04,
                5.554372020681721872e-04,
                5.462962962962968939e-04,
                5.373791814111964415e-04,
                5.286786118661911593e-04,
                5.201876329689328815e-04,
                5.118995669833170800e-04,
                5.038079999999993614e-04,
                4.959067695273300467e-04,
                4.881899527578582691e-04,
                4.806518554687513553e-04,
                4.732870015172201301e-04,
                4.660901228948569476e-04,
                4.590561503070812927e-04,
                4.521802042463207542e-04,
                4.454575865294994083e-04,
                4.388837722725201767e-04,
                4.324544022760760335e-04,
                4.261652757988996653e-04,
                4.200123436961015707e-04,
                4.139917019016219491e-04,
                4.080995852352855635e-04,
                4.023323615160347014e-04,
                3.966865259642387859e-04,
                3.911586958769073781e-04,
                3.857456055607559999e-04,
                3.804441015089163628e-04,
                3.752511378080283918e-04,
                3.701637717631876042e-04,
                3.651791597290500089e-04,
                3.602945531360424386e-04,
                3.555072947013393644e-04,
                3.508148148148150318e-04,
                3.462146280908443246e-04,
                3.417043300772706579e-04,
                3.372815941134310169e-04,
                3.329441683295618804e-04,
                3.286898727803697962e-04,
                3.245165967059456761e-04,
                3.204222959136078562e-04,
                3.164049902746030431e-04,
                3.124627613299469525e-04,
                3.085937500000006536e-04,
                3.047961543926708760e-04,
                3.010682277054271437e-04,
                2.974082762165509704e-04,
                2.938146573613266573e-04,
                2.902857778890840287e-04,
                2.868200920972320436e-04,
                2.834161001386373844e-04,
                2.800723463988773264e-04,
                2.767874179400926543e-04,
                2.735599430083450099e-04,
                2.703885896015183112e-04,
                2.672720640949857599e-04,
                2.642091099223844042e-04,
                2.611985063090069021e-04,
                2.582390670553936325e-04,
                2.553296393688952786e-04,
                2.524691027410392121e-04,
                2.496563678686583424e-04,
                2.468903756168556963e-04,
                2.441700960219478681e-04,
                2.414945273326436455e-04,
                2.388626950877888991e-04,
                2.362736512290880770e-04,
                2.337264732473081405e-04,
                2.312202633605115387e-04,
                2.287541477229636212e-04,
                2.263272756634101927e-04,
                2.239388189514846938e-04,
                2.215879710910642825e-04,
                2.192739466394518573e-04,
                2.169959805513047761e-04,
                2.147533275462965724e-04,
                2.125452614995263162e-04,
                2.103710748537537519e-04,
                2.082300780525633312e-04,
                2.061215989936163726e-04,
                2.040449825011810122e-04,
                2.019995898171598092e-04,
                1.999847981098901899e-04,
                1.979999999999995544e-04,
                1.960446031026521650e-04,
                1.941180295855286753e-04,
                1.922197157419462991e-04,
                1.903491115785029507e-04,
                1.885056804167086787e-04,
                1.866888985080442651e-04,
                1.848982546619449511e-04,
                1.831332498862086049e-04,
                1.813933970393660821e-04,
                1.796782204945470015e-04,
                1.779872558144186953e-04,
                1.763200494367834624e-04,
                1.746761583704287699e-04,
                1.730551499008611219e-04,
                1.714566013055458620e-04,
                1.698800995783162889e-04,
                1.683252411626066881e-04,
                1.667916316931900619e-04,
                1.652788857461146769e-04,
                1.637866265965436064e-04,
                1.623144859842089486e-04,
                1.608621038862089673e-04,
                1.594291282968939092e-04,
                1.580152150145771445e-04,
                1.566200274348421599e-04,
                1.552432363502034916e-04,
                1.538845197559080100e-04,
                1.525435626616557586e-04,
                1.512200569090367335e-04,
                1.499137009944933002e-04,
                1.486241998976018947e-04,
                1.473512649145107306e-04,
                1.460946134963435035e-04,
                1.448539690924084970e-04,
                1.436290609980448753e-04,
                1.424196242069539946e-04,
                1.412253992678663857e-04,
                1.400461321453942167e-04,
                1.388815740849326009e-04,
                1.377314814814815968e-04,
                1.365956157522465976e-04,
                1.354737432129063607e-04,
                1.343656349574223936e-04,
                1.332710667412691870e-04,
                1.321898188679887477e-04,
                1.311216760789462113e-04,
                1.300664274461928052e-04,
                1.290238662683357111e-04,
                1.279937899693160827e-04,
                1.269759999999998902e-04,
                1.259703017425066744e-04,
                1.249765044171696315e-04,
                1.239944209920578030e-04,
                1.230238680949804391e-04,
                1.220646659278859161e-04,
                1.211166381835937500e-04,
                1.201796119647760298e-04,
            ];

            ddouble[] expected_dist_a1b2 = [
                2.000000000000000000e+00,
                5.925925925925925597e-01,
                2.500000000000000555e-01,
                1.280000000000000027e-01,
                7.407407407407406996e-02,
                4.664723032069970077e-02,
                3.125000000000001388e-02,
                2.194787379972565691e-02,
                1.600000000000001074e-02,
                1.202103681442524309e-02,
                9.259259259259257011e-03,
                7.282658170232133958e-03,
                5.830903790087466933e-03,
                4.740740740740744148e-03,
                3.906250000000004337e-03,
                3.256665988194586223e-03,
                2.743484224965706247e-03,
                2.332701559994166448e-03,
                1.999999999999998741e-03,
                1.727675197062951808e-03,
                1.502629601803155170e-03,
                1.315032464863976789e-03,
                1.157407407407406909e-03,
                1.023999999999999520e-03,
                9.103322712790165279e-04,
                8.128842148046539276e-04,
                7.288629737609338003e-04,
                6.560334577063432976e-04,
                5.925925925925929101e-04,
                5.370749555234808834e-04,
                4.882812500000004337e-04,
                4.452235857194534780e-04,
                4.070832485243227900e-04,
                3.731778425655971347e-04,
                3.429355281207138229e-04,
                3.158746767220106276e-04,
                2.915876949992712397e-04,
                2.697280803789679163e-04,
                2.500000000000000052e-04,
                2.321498527299369443e-04,
                2.159593996328689218e-04,
                2.012401423774007401e-04,
                1.878287002253943420e-04,
                1.755829903978053529e-04,
                1.643790581079970716e-04,
                1.541084345472583069e-04,
                1.446759259259258095e-04,
                1.359977560370253082e-04,
                1.280000000000001297e-04,
                1.206172588220218124e-04,
                1.137915339098770389e-04,
                1.074712682281346783e-04,
                1.016105268505817138e-04,
                9.616829451540183089e-05,
                9.110787172011669793e-05,
                8.639635407385815513e-05,
                8.200418221329289865e-05,
                7.790475170294921333e-05,
                7.407407407407410021e-05,
                7.049048158215892785e-05,
                6.713436944043497489e-05,
                6.398797026159080720e-05,
                6.103515625000002711e-05,
                5.826126536185709812e-05,
                5.565294821493166442e-05,
                5.319803300272974816e-05,
                5.088540606554042329e-05,
                4.870490610607312783e-05,
                4.664723032069971638e-05,
                4.470385095736096112e-05,
                4.286694101508913978e-05,
                4.112930797368748523e-05,
                3.948433459025131489e-05,
                3.792592592592590488e-05,
                3.644846187490889141e-05,
                3.504675456100652835e-05,
                3.371601004737103698e-05,
                3.245179387431824415e-05,
                3.124999999999999387e-05,
                3.010682277054273605e-05,
                2.901873159124216208e-05,
                2.798244800948608080e-05,
                2.699492495410860845e-05,
                2.605332790555668019e-05,
                2.515501779717508574e-05,
                2.429753547060530669e-05,
                2.347858752817432663e-05,
                2.269603344260526012e-05,
                2.194787379972566233e-05,
                2.123223956335898042e-05,
                2.054738226349962717e-05,
                1.989166501938817986e-05,
                1.926355431840731547e-05,
                1.866161247995334091e-05,
                1.808449074074072280e-05,
                1.753092290447948610e-05,
                1.699971950462819063e-05,
                1.648976243405382976e-05,
                1.600000000000001283e-05,
                1.552944236684232140e-05,
                1.507715735275272146e-05,
                1.464226654965055441e-05,
                1.422394173873462478e-05,
                1.382140157650362306e-05,
                1.343390852851683139e-05,
                1.306076603025364081e-05,
                1.270131585632271084e-05,
                1.235493568097702022e-05,
                1.202103681442524750e-05,
                1.169906210081522738e-05,
                1.138848396501456352e-05,
                1.108880259644312372e-05,
                1.079954425923224737e-05,
                1.052025971891182047e-05,
                1.025052277666160894e-05,
                9.989928902924737078e-06,
                9.738093962868633031e-06,
                9.494653026806360523e-06,
                9.259259259259276079e-06,
                9.031582880860435341e-06,
                8.811310197769847347e-06,
                8.598142693701367492e-06,
                8.391796180054383720e-06,
                8.191999999999985264e-06,
                7.998496282698862759e-06,
                7.811039244125737700e-06,
                7.629394531250015247e-06,
                7.453338606570396998e-06,
                7.282658170232135571e-06,
                7.117149617164059166e-06,
                6.956618526866469063e-06,
                6.800879183656470813e-06,
                6.649754125341216826e-06,
                6.503073718437234382e-06,
                6.360675758192540206e-06,
                6.222405091794091553e-06,
                6.088113263259150297e-06,
                5.957658178617301790e-06,
                5.830903790087452689e-06,
                5.707719798046603363e-06,
                5.587981369670108282e-06,
                5.471568873202211653e-06,
                5.358367626886150942e-06,
                5.248267661650748848e-06,
                5.141163496710944124e-06,
                5.036953927297242985e-06,
                4.935541823781404197e-06,
                4.836833941514822592e-06,
                4.740740740740745734e-06,
                4.647176215984483486e-06,
                4.556057734363610579e-06,
                4.467305882297103942e-06,
                4.380844320125814349e-06,
                4.296599644187841897e-06,
                4.214501255921371152e-06,
                4.134481237594939414e-06,
                4.056474234289786448e-06,
                3.980417341782765328e-06,
                3.906250000000005164e-06,
                3.833913891731708919e-06,
                3.763352846317841159e-06,
                3.694512748031688802e-06,
                3.627341448905263061e-06,
                3.561788685755635837e-06,
                3.497806001185752900e-06,
                3.435346668347118599e-06,
                3.374365619263581138e-06,
                3.314819376528058119e-06,
                3.256665988194584177e-06,
                3.199864965698444653e-06,
                3.144377224646890376e-06,
                3.090165028331980011e-06,
                3.037191933825662489e-06,
                2.985422740524778569e-06,
                2.934823441021784900e-06,
                2.885361174183304197e-06,
                2.837004180325661750e-06,
                2.789721758382548978e-06,
                2.743484224965706945e-06,
                2.698262875225069117e-06,
                2.654029945419876788e-06,
                2.610758577116992230e-06,
                2.568422782937452973e-06,
                2.526997413776081599e-06,
                2.486458127423517400e-06,
                2.446781358523352382e-06,
                2.407944289800909775e-06,
                2.369924824503363104e-06,
                2.332701559994171002e-06,
                2.296253762447669326e-06,
                2.260561342592593738e-06,
                2.225604832455773264e-06,
                2.191365363059935339e-06,
                2.157824643031744296e-06,
                2.124964938078519593e-06,
                2.092769051294164554e-06,
                2.061220304256732108e-06,
                2.030302518882132184e-06,
                1.999999999999997368e-06,
                1.970297518619620381e-06,
                1.941180295855285940e-06,
                1.912633987482053073e-06,
                1.884644669094089759e-06,
                1.857198821839496517e-06,
                1.830283318706318878e-06,
                1.803885411336048164e-06,
                1.777992717341830850e-06,
                1.752593208109819399e-06,
                1.727675197062952247e-06,
                1.703227328367643303e-06,
                1.679238566064606465e-06,
                1.655698183605958433e-06,
                1.632595753781707431e-06,
                1.609921139019209604e-06,
                1.587664482040338432e-06,
                1.565816196861456853e-06,
                1.544366960122129857e-06,
                1.523307702729168817e-06,
                1.502629601803152761e-06,
                1.482324072915148639e-06,
                1.462382762601900457e-06,
                1.442797541148360629e-06,
                1.423560495626822770e-06,
                1.404663923182440914e-06,
                1.386100324555390042e-06,
                1.367862397830294869e-06,
                1.349943032404033039e-06,
                1.332335303163320220e-06,
                1.315032464863974806e-06,
                1.298027946703947745e-06,
                1.281315347082703024e-06,
                1.264888428539771012e-06,
                1.248741112865591711e-06,
                1.232867476378067072e-06,
                1.217261745358580823e-06,
                1.201918291641416176e-06,
                1.186831628350796971e-06,
                1.171996405780021783e-06,
                1.157407407407407181e-06,
                1.143059546043904167e-06,
                1.128947860107554206e-06,
                1.115067510020103280e-06,
                1.101413774721232612e-06,
                1.087982048296203077e-06,
                1.074767836712672631e-06,
                1.061766754662797182e-06,
                1.048974522506795847e-06,
                1.036386963314299171e-06,
                1.023999999999999852e-06,
                1.011809652550254692e-06,
                9.998120353373559390e-07,
                9.880033545183894543e-07,
                9.763799055157167890e-07,
                9.649380705761733012e-07,
                9.536743164062500000e-07,
                9.425851918805950900e-07,
            ];

            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                5.925925925925925597e-01,
                3.750000000000000000e-01,
                2.303999999999999937e-01,
                1.481481481481481122e-01,
                9.995835068721363459e-02,
                7.031250000000002776e-02,
                5.121170553269317055e-02,
                3.840000000000001745e-02,
                2.950618127177106337e-02,
                2.314814814814815380e-02,
                1.848674766289696431e-02,
                1.499375260308205213e-02,
                1.232592592592591726e-02,
                1.025390625000000347e-02,
                8.620586439338608423e-03,
                7.315957933241876675e-03,
                6.261462082089608305e-03,
                5.399999999999995949e-03,
                4.689404106313724632e-03,
                4.098080732190424215e-03,
                3.602045447236106989e-03,
                3.182870370370368459e-03,
                2.826239999999996359e-03,
                2.520920135849582730e-03,
                2.258011707790704391e-03,
                2.030403998334027495e-03,
                1.832369312903922532e-03,
                1.659259259259258761e-03,
                1.507274875178799727e-03,
                1.373291015625000434e-03,
                1.254721014300276766e-03,
                1.149411525245147428e-03,
                1.055560183256974358e-03,
                9.716506630086871321e-04,
                8.964011096165175893e-04,
                8.287229226295080020e-04,
                7.676876133862932253e-04,
                7.124999999999999173e-04,
                6.624764090098195614e-04,
                6.170268560939108334e-04,
                5.756404072655887504e-04,
                5.378730960999922404e-04,
                5.033379058070415382e-04,
                4.716964276142522942e-04,
                4.426518864655285468e-04,
                4.159432870370366074e-04,
                3.913404816575625795e-04,
                3.686399999999999942e-04,
                3.476615107222979259e-04,
                3.282448093554145535e-04,
                3.102472460170678146e-04,
                2.935415220127913106e-04,
                2.780137968717981715e-04,
                2.635620574760516501e-04,
                2.500947091611677988e-04,
                2.375293553764343843e-04,
                2.257917379865136760e-04,
                2.148148148148147619e-04,
                2.045379547547889246e-04,
                1.949062338593274995e-04,
                1.858698183789068970e-04,
                1.773834228515625813e-04,
                1.694058331290921313e-04,
                1.618994857161648961e-04,
                1.548300960527208240e-04,
                1.481663294261321019e-04,
                1.418795090916044046e-04,
                1.359433569346104990e-04,
                1.303337626503337822e-04,
                1.250285779606766419e-04,
                1.200074328547318396e-04,
                1.152515712364093284e-04,
                1.107437037037036051e-04,
                1.064678754767074551e-04,
                1.024093477432007728e-04,
                9.855449090769981767e-05,
                9.489068841731036134e-05,
                9.140624999999988061e-05,
                8.809033329158808630e-05,
                8.493287294997687762e-05,
                8.192451646150731941e-05,
                7.905656593703227369e-05,
                7.632092527627777124e-05,
                7.371005214986184589e-05,
                7.121691431039484143e-05,
                6.883494979851099819e-05,
                6.655803065752775415e-05,
                6.438042981252860319e-05,
                6.229679080677851509e-05,
                6.030210012114016509e-05,
                5.839166183110716793e-05,
                5.656107438170651923e-05,
                5.480620928323142761e-05,
                5.312319155092579592e-05,
                5.150838172965614031e-05,
                4.995835936053993361e-05,
                4.846990776070362103e-05,
                4.704000000000001041e-05,
                4.566578596982341529e-05,
                4.434458044927268647e-05,
                4.307385208295262305e-05,
                4.185121319281534676e-05,
                4.067441035371061693e-05,
                3.954131566884193637e-05,
                3.844991868719527733e-05,
                3.739831891028353334e-05,
                3.638471884030847469e-05,
                3.540741752612521377e-05,
                3.446480456726642836e-05,
                3.355535453977506071e-05,
                3.267762181075716660e-05,
                3.183023571142138135e-05,
                3.101189604096610752e-05,
                3.022136887601956413e-05,
                2.945748266247038495e-05,
                2.871912456846000263e-05,
                2.800523707906750885e-05,
                2.731481481481481217e-05,
                2.664690155757992219e-05,
                2.600058746882908135e-05,
                2.537500648628938390e-05,
                2.476933388628949602e-05,
                2.418278399999996731e-05,
                2.361460807272997012e-05,
                2.306409225627676022e-05,
                2.253055572509769691e-05,
                2.201334890777769426e-05,
                2.151185182591648613e-05,
                2.102547253314875837e-05,
                2.055364564755999393e-05,
                2.009583097125556737e-05,
                1.965151219130688648e-05,
                1.922019565671446184e-05,
                1.880140922642204465e-05,
                1.839470118377084317e-05,
                1.799963921311396685e-05,
                1.761580943461663669e-05,
                1.724281549354434454e-05,
                1.688027770060589620e-05,
                1.652783222015102085e-05,
                1.618513030324849890e-05,
                1.585183756287149366e-05,
                1.552763328860806615e-05,
                1.521220979848718454e-05,
                1.490527182567550624e-05,
                1.460653593794766561e-05,
                1.431572998797337685e-05,
                1.403259259259259646e-05,
                1.375687263937130273e-05,
                1.348832881883962419e-05,
                1.322672918091885912e-05,
                1.297185071413876517e-05,
                1.272347894633688691e-05,
                1.248140756561330084e-05,
                1.224543806039263291e-05,
                1.201537937751655312e-05,
                1.179104759735650434e-05,
                1.157226562500002315e-05,
                1.135886289662126635e-05,
                1.115067510020098537e-05,
                1.094754390981169615e-05,
                1.074931673273146448e-05,
                1.055584646869395399e-05,
                1.036699128062281797e-05,
                1.018261437623847046e-05,
                1.000258379995990258e-05,
                9.826772234559490201e-06,
                9.655056812059227650e-06,
                9.487318933386615228e-06,
                9.323444096336711096e-06,
                9.163321731412175713e-06,
                9.006845045138163488e-06,
                8.853910870470615624e-06,
                8.704419523939603301e-06,
                8.558274669187776392e-06,
                8.415383186583984883e-06,
                8.275655048609670400e-06,
                8.139003200731591763e-06,
                8.005343447490950447e-06,
                7.874594343553477881e-06,
                7.746677089478277249e-06,
                7.621515431977433213e-06,
                7.499035568449015519e-06,
                7.379166055579465202e-06,
                7.261837721820649154e-06,
                7.146983583558024232e-06,
                7.034538764795686400e-06,
                6.924440420193207176e-06,
                6.816627661297529170e-06,
                6.711041485821765345e-06,
                6.607624709829830356e-06,
                6.506321902693410718e-06,
                6.407079324694252760e-06,
                6.309844867151515923e-06,
                6.214567994959819954e-06,
                6.121199691429077017e-06,
                6.029692405323319602e-06,
                5.939999999999991409e-06,
                5.852077704556778326e-06,
                5.765882066896891942e-06,
                5.681370908628948502e-06,
                5.598503281720678708e-06,
                5.517239426830503906e-06,
                5.437540733244004235e-06,
                5.359369700346225224e-06,
                5.282689900563707671e-06,
                5.207465943713866163e-06,
                5.133663442701346481e-06,
                5.061248980504798748e-06,
                4.990190078399525851e-06,
                4.920455165364178044e-06,
                4.852013548622269262e-06,
                4.784835385271042335e-06,
                4.718891654953226576e-06,
                4.654154133528295938e-06,
                4.590595367702476995e-06,
                4.528188650578477999e-06,
                4.466907998087552672e-06,
                4.406728126268111602e-06,
                4.347624429357001612e-06,
                4.289572958660820303e-06,
                4.232550402176176296e-06,
                4.176534064929126172e-06,
                4.121501850005398976e-06,
                4.067432240244265104e-06,
                4.014304280569882186e-06,
                3.962097560935460837e-06,
                3.910792199856347846e-06,
                3.860368828509139991e-06,
                3.810808575375272741e-06,
                3.762093051407983415e-06,
                3.714204335702785885e-06,
                3.667124961652207561e-06,
                3.620837903566620234e-06,
                3.575326563743450347e-06,
                3.530574759967915289e-06,
                3.486566713429267463e-06,
                3.443287037037041614e-06,
                3.400720724122320564e-06,
                3.358853137510072105e-06,
                3.317669998948697469e-06,
                3.277157378883662797e-06,
                3.237301686562984140e-06,
                3.198089660462104862e-06,
                3.159508359016829621e-06,
                3.121545151653283990e-06,
                3.084187710103995889e-06,
                3.047423999999991594e-06,
                3.011242272729242950e-06,
                2.975631057551659264e-06,
                2.940579153961843534e-06,
                2.906075624290869521e-06,
                2.872109786538486504e-06,
                2.838671207427980210e-06,
                2.805749695675700251e-06,
            ];

            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                8.779149519890258047e-01,
                4.687500000000000000e-01,
                2.211839999999997697e-01,
                1.097393689986281978e-01,
                5.828475258729656078e-02,
                3.295898437500002776e-02,
                1.966979087675457816e-02,
                1.228800000000000031e-02,
                7.980635054723956082e-03,
                5.358367626886144722e-03,
                3.702398257475949389e-03,
                2.622813866428345617e-03,
                1.899105624142664091e-03,
                1.401901245117189885e-03,
                1.052788899573208273e-03,
                8.028486072144709737e-04,
                6.207602005862263798e-04,
                4.860000000000001580e-04,
                3.848339402654612010e-04,
                3.078948709384240990e-04,
                2.486823519091252823e-04,
                2.026132758916327609e-04,
                1.664090111999998699e-04,
                1.376924971788575410e-04,
                1.147188796316975950e-04,
                9.619260925051894813e-05,
                8.114145138940651264e-05,
                6.882853223593975449e-05,
                5.869017002475285791e-05,
                5.029141902923596859e-05,
                4.329393265248479008e-05,
                3.743249420704735270e-05,
                3.249771293059370132e-05,
                2.832315032775670202e-05,
                2.477566093741975976e-05,
                2.174808661223378566e-05,
                1.915368883176914904e-05,
                1.692187500000001321e-05,
                1.499489557689698866e-05,
                1.332527493993976438e-05,
                1.187380064542198360e-05,
                1.060794047530037321e-05,
                9.500589278333195235e-06,
                8.529071593255169498e-06,
                7.674343793166740432e-06,
                6.920352721246993718e-06,
                6.253517713845590151e-06,
                5.662310399999999590e-06,
                5.136912356602695529e-06,
                4.668935044313486000e-06,
                4.251189786701904079e-06,
                3.877498131551379309e-06,
                3.542534932340870247e-06,
                3.241698046580446403e-06,
                2.970999768644450639e-06,
                2.726976075501321566e-06,
                2.506610523029377659e-06,
                2.307270233196158681e-06,
                2.126651892543002629e-06,
                1.962736066523389316e-06,
                1.813748442670905851e-06,
                1.678126864135261327e-06,
                1.554493216150434386e-06,
                1.441629391133729231e-06,
                1.338456690939626770e-06,
                1.244018133284745685e-06,
                1.157463218254293812e-06,
                1.078034783854643497e-06,
                1.005057639790124072e-06,
                9.379287184121402290e-07,
                8.761085230399652020e-07,
                8.191136881351056908e-07,
                7.665104943758582092e-07,
                7.179092055398344019e-07,
                6.729591140828875482e-07,
                6.313441990749340659e-07,
                5.927793142638129555e-07,
                5.570068359375001322e-07,
                5.237937103110559277e-07,
                4.929288486816904326e-07,
                4.642208258237492676e-07,
                4.374958432429446152e-07,
                4.125959241477588756e-07,
                3.893773114687007544e-07,
                3.677090440823243247e-07,
                3.474716896759922324e-07,
                3.285562155047904560e-07,
                3.108629807134440221e-07,
                2.943008359824510093e-07,
                2.787863180582019180e-07,
                2.642429282833742598e-07,
                2.506004855916807236e-07,
                2.377945455997913456e-07,
                2.257658784445098334e-07,
                2.144599988963112284e-07,
                2.038267430497429728e-07,
                1.938198865623172559e-07,
                1.843968000000004194e-07,
                1.755181373603453034e-07,
                1.671475542938717869e-07,
                1.592514529385008849e-07,
                1.517987506282418898e-07,
                1.447606700419289274e-07,
                1.381105486260321647e-07,
                1.318236653621303338e-07,
                1.258770831583748252e-07,
                1.202495053288539367e-07,
                1.149211447880249066e-07,
                1.098736047320381276e-07,
                1.050897697070671377e-07,
                1.005537060786474928e-07,
                9.625057101724135397e-08,
                9.216652920533712434e-08,
                8.828867655157661216e-08,
                8.460497026895011905e-08,
                8.110416473790783532e-08,
                7.777575263226551484e-08,
                7.460991083676311828e-08,
                7.159745073078523931e-08,
                6.872977245363004418e-08,
                6.599882280337102967e-08,
                6.339705645428425705e-08,
                6.091740020735989640e-08,
                5.855322001500749047e-08,
                5.629829054497343327e-08,
                5.414676707005139514e-08,
                5.209315948957244032e-08,
                5.013230830618671460e-08,
                4.825936239727294295e-08,
                4.646975843460093950e-08,
                4.475920181880140383e-08,
                4.312364900690096950e-08,
                4.155929112176846907e-08,
                4.006253874193068159e-08,
                3.863000777892527267e-08,
                3.725850635726128287e-08,
                3.594502261925430878e-08,
                3.468671338351486890e-08,
                3.348089359182484132e-08,
                3.232502648453305608e-08,
                3.121671444953170329e-08,
                3.015369049435970901e-08,
                2.913381029508005753e-08,
                2.815504477930481197e-08,
                2.721547320416634775e-08,
                2.631327669314202021e-08,
                2.544673219849628837e-08,
                2.461420685871069675e-08,
                2.381415272266517700e-08,
                2.304510181451766983e-08,
                2.230566151523484145e-08,
                2.159451023857084485e-08,
                2.091039338097594404e-08,
                2.025211952646337227e-08,
                1.961855688889444305e-08,
                1.900862997544404124e-08,
                1.842131645621426956e-08,
                1.785564422607424859e-08,
                1.731068864581880001e-08,
                1.678556995068275152e-08,
                1.627945081511050314e-08,
                1.579153406347931299e-08,
                1.532106051721284085e-08,
                1.486730696939715487e-08,
                1.442958427864567141e-08,
                1.400723557453085578e-08,
                1.359963456744564062e-08,
                1.320618395624626663e-08,
                1.282631392749099790e-08,
                1.245948074051064306e-08,
                1.210516539294427807e-08,
                1.176287236173383064e-08,
                1.143212841490967143e-08,
                1.111248148981536201e-08,
                1.080349963370601975e-08,
                1.050477000292769649e-08,
                1.021589791713382134e-08,
                9.936505965227879329e-09,
                9.666233159936524683e-09,
                9.404734138121234069e-09,
                9.151678404118765417e-09,
                8.906749613580108207e-09,
                8.669644895433147592e-09,
                8.440074209751528314e-09,
                8.217759739447271341e-09,
                8.002435313838176689e-09,
                7.793845862262596734e-09,
                7.591746896027579067e-09,
                7.395904017082032076e-09,
                7.206092451907339356e-09,
                7.022096609207572525e-09,
                6.843709660070672525e-09,
                6.670733139350239815e-09,
                6.502976567094662141e-09,
                6.340257088919864502e-09,
                6.182399134287978279e-09,
                6.029234091716617416e-09,
                5.880600000000004694e-09,
                5.736341254578562615e-09,
                5.596308328242806460e-09,
                5.460357505406103807e-09,
                5.328350629224346354e-09,
                5.200154860882903444e-09,
                5.075642450409755927e-09,
                4.954690518410645059e-09,
                4.837180848156415731e-09,
                4.722999687485353971e-09,
                4.612037560012460252e-09,
                4.504189085167887361e-09,
                4.399352806611742499e-09,
                4.297431028598741933e-09,
                4.198329659889168192e-09,
                4.101958064825429872e-09,
                4.008228921213689925e-09,
                3.917058084670483675e-09,
                3.828364459111490373e-09,
                3.742069873079058362e-09,
                3.658098961619404502e-09,
                3.576379053436827205e-09,
                3.496840063067233224e-09,
                3.419414387826117027e-09,
                3.344036809299532725e-09,
                3.270644399158766359e-09,
                3.199176429090960073e-09,
                3.129574284648444042e-09,
                3.061781382830327189e-09,
                2.995743093219093450e-09,
                2.931406662504319003e-09,
                2.868721142234071429e-09,
                2.807637319643048083e-09,
                2.748107651413642579e-09,
                2.690086200233916949e-09,
                2.633528574022987267e-09,
                2.578391867701268472e-09,
                2.524634607388390069e-09,
                2.472216696918294117e-09,
                2.421099366565945346e-09,
                2.371245123885467340e-09,
                2.322617706564574080e-09,
                2.275182037204531937e-09,
                2.228904179939665482e-09,
                2.183751298814231663e-09,
                2.139691617838971480e-09,
                2.096694382652698116e-09,
                2.054729823718513124e-09,
                2.013769120987427391e-09,
                1.973784369964985868e-09,
                1.934748549119994927e-09,
                1.896635488577480282e-09,
                1.859419840039862337e-09,
                1.823077047884071958e-09,
                1.787583321383984676e-09,
                1.752915608010162306e-09,
                1.719051567761200866e-09,
                1.685969548482966247e-09,
            ];

            foreach ((BetaPrimeDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-12, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist_a1b1 = [
                0.000000000000000000e+00,
                3.333333333333333148e-01,
                5.000000000000000000e-01,
                5.999999999999999778e-01,
                6.666666666666666297e-01,
                7.142857142857143016e-01,
                7.500000000000000000e-01,
                7.777777777777777901e-01,
                8.000000000000000444e-01,
                8.181818181818182323e-01,
                8.333333333333333703e-01,
                8.461538461538461453e-01,
                8.571428571428570953e-01,
                8.666666666666666963e-01,
                8.750000000000000000e-01,
                8.823529411764705621e-01,
                8.888888888888888395e-01,
                8.947368421052631637e-01,
                9.000000000000000222e-01,
                9.047619047619047672e-01,
                9.090909090909090606e-01,
                9.130434782608695121e-01,
                9.166666666666666297e-01,
                9.200000000000000400e-01,
                9.230769230769231282e-01,
                9.259259259259259300e-01,
                9.285714285714286031e-01,
                9.310344827586206629e-01,
                9.333333333333333481e-01,
                9.354838709677418818e-01,
                9.375000000000000000e-01,
                9.393939393939394478e-01,
                9.411764705882352811e-01,
                9.428571428571428381e-01,
                9.444444444444444198e-01,
                9.459459459459459429e-01,
                9.473684210526315264e-01,
                9.487179487179486781e-01,
                9.499999999999999556e-01,
                9.512195121951219079e-01,
                9.523809523809523281e-01,
                9.534883720930232842e-01,
                9.545454545454545858e-01,
                9.555555555555556024e-01,
                9.565217391304348116e-01,
                9.574468085106383475e-01,
                9.583333333333333703e-01,
                9.591836734693877098e-01,
                9.599999999999999645e-01,
                9.607843137254902244e-01,
                9.615384615384615641e-01,
                9.622641509433962348e-01,
                9.629629629629629095e-01,
                9.636363636363636243e-01,
                9.642857142857143016e-01,
                9.649122807017543879e-01,
                9.655172413793103869e-01,
                9.661016949152542166e-01,
                9.666666666666666741e-01,
                9.672131147540983243e-01,
                9.677419354838709964e-01,
                9.682539682539682557e-01,
                9.687500000000000000e-01,
                9.692307692307692291e-01,
                9.696969696969697239e-01,
                9.701492537313433084e-01,
                9.705882352941176405e-01,
                9.710144927536231707e-01,
                9.714285714285714191e-01,
                9.718309859154929953e-01,
                9.722222222222222099e-01,
                9.726027397260273988e-01,
                9.729729729729730270e-01,
                9.733333333333333837e-01,
                9.736842105263158187e-01,
                9.740259740259740173e-01,
                9.743589743589743390e-01,
                9.746835443037974445e-01,
                9.749999999999999778e-01,
                9.753086419753086433e-01,
                9.756097560975609539e-01,
                9.759036144578313587e-01,
                9.761904761904761640e-01,
                9.764705882352940902e-01,
                9.767441860465115866e-01,
                9.770114942528735913e-01,
                9.772727272727272929e-01,
                9.775280898876403946e-01,
                9.777777777777777457e-01,
                9.780219780219779890e-01,
                9.782608695652174058e-01,
                9.784946236559139976e-01,
                9.787234042553191182e-01,
                9.789473684210526772e-01,
                9.791666666666666297e-01,
                9.793814432989690344e-01,
                9.795918367346938549e-01,
                9.797979797979797789e-01,
                9.799999999999999822e-01,
                9.801980198019801804e-01,
                9.803921568627450567e-01,
                9.805825242718446688e-01,
                9.807692307692307265e-01,
                9.809523809523809090e-01,
                9.811320754716981174e-01,
                9.813084112149532690e-01,
                9.814814814814815103e-01,
                9.816513761467889898e-01,
                9.818181818181818121e-01,
                9.819819819819819440e-01,
                9.821428571428570953e-01,
                9.823008849557521849e-01,
                9.824561403508771384e-01,
                9.826086956521739024e-01,
                9.827586206896551380e-01,
                9.829059829059828557e-01,
                9.830508474576271638e-01,
                9.831932773109243184e-01,
                9.833333333333332815e-01,
                9.834710743801653443e-01,
                9.836065573770491621e-01,
                9.837398373983740063e-01,
                9.838709677419354982e-01,
                9.839999999999999858e-01,
                9.841269841269840724e-01,
                9.842519685039370358e-01,
                9.843750000000000000e-01,
                9.844961240310077244e-01,
                9.846153846153846700e-01,
                9.847328244274808906e-01,
                9.848484848484848619e-01,
                9.849624060150375948e-01,
                9.850746268656715987e-01,
                9.851851851851851638e-01,
                9.852941176470588758e-01,
                9.854014598540146164e-01,
                9.855072463768116409e-01,
                9.856115107913668849e-01,
                9.857142857142857650e-01,
                9.858156028368794122e-01,
                9.859154929577464976e-01,
                9.860139860139860435e-01,
                9.861111111111111605e-01,
                9.862068965517241104e-01,
                9.863013698630136439e-01,
                9.863945578231292366e-01,
                9.864864864864865135e-01,
                9.865771812080537106e-01,
                9.866666666666666918e-01,
                9.867549668874172619e-01,
                9.868421052631578538e-01,
                9.869281045751634451e-01,
                9.870129870129870087e-01,
                9.870967741935483541e-01,
                9.871794871794872250e-01,
                9.872611464968152895e-01,
                9.873417721518987777e-01,
                9.874213836477987449e-01,
                9.875000000000000444e-01,
                9.875776397515527716e-01,
                9.876543209876542662e-01,
                9.877300613496932113e-01,
                9.878048780487804770e-01,
                9.878787878787879118e-01,
                9.879518072289156239e-01,
                9.880239520958083999e-01,
                9.880952380952381375e-01,
                9.881656804733728316e-01,
                9.882352941176471006e-01,
                9.883040935672514626e-01,
                9.883720930232557933e-01,
                9.884393063583815087e-01,
                9.885057471264367956e-01,
                9.885714285714285454e-01,
                9.886363636363636465e-01,
                9.887005649717514055e-01,
                9.887640449438201973e-01,
                9.888268156424581123e-01,
                9.888888888888889284e-01,
                9.889502762430939509e-01,
                9.890109890109890500e-01,
                9.890710382513661081e-01,
                9.891304347826086474e-01,
                9.891891891891891886e-01,
                9.892473118279569988e-01,
                9.893048128342245562e-01,
                9.893617021276596146e-01,
                9.894179894179894186e-01,
                9.894736842105262831e-01,
                9.895287958115183136e-01,
                9.895833333333333703e-01,
                9.896373056994818285e-01,
                9.896907216494845727e-01,
                9.897435897435897800e-01,
                9.897959183673469274e-01,
                9.898477157360405787e-01,
                9.898989898989899450e-01,
                9.899497487437185494e-01,
                9.899999999999999911e-01,
                9.900497512437811398e-01,
                9.900990099009900902e-01,
                9.901477832512315391e-01,
                9.901960784313725839e-01,
                9.902439024390243816e-01,
                9.902912621359223344e-01,
                9.903381642512076866e-01,
                9.903846153846154188e-01,
                9.904306220095693281e-01,
                9.904761904761905100e-01,
                9.905213270142180226e-01,
                9.905660377358490587e-01,
                9.906103286384976281e-01,
                9.906542056074766345e-01,
                9.906976744186046790e-01,
                9.907407407407406996e-01,
                9.907834101382488878e-01,
                9.908256880733945504e-01,
                9.908675799086757996e-01,
                9.909090909090909616e-01,
                9.909502262443439236e-01,
                9.909909909909909720e-01,
                9.910313901345291221e-01,
                9.910714285714286031e-01,
                9.911111111111111649e-01,
                9.911504424778760924e-01,
                9.911894273127753729e-01,
                9.912280701754385692e-01,
                9.912663755458515080e-01,
                9.913043478260870067e-01,
                9.913419913419913021e-01,
                9.913793103448276245e-01,
                9.914163090128755851e-01,
                9.914529914529914834e-01,
                9.914893617021276473e-01,
                9.915254237288135819e-01,
                9.915611814345991482e-01,
                9.915966386554622147e-01,
                9.916317991631798945e-01,
                9.916666666666666963e-01,
                9.917012448132780378e-01,
                9.917355371900826722e-01,
                9.917695473251029181e-01,
                9.918032786885245811e-01,
                9.918367346938775642e-01,
                9.918699186991869476e-01,
                9.919028340080972006e-01,
                9.919354838709677491e-01,
                9.919678714859437862e-01,
                9.919999999999999929e-01,
                9.920318725099601664e-01,
                9.920634920634920917e-01,
                9.920948616600790970e-01,
                9.921259842519685179e-01,
                9.921568627450980671e-01,
                9.921875000000000000e-01,
                9.922178988326848526e-01,
            ];

            ddouble[] expected_dist_a2b1 = [
                0.000000000000000000e+00,
                1.111111111111111049e-01,
                2.500000000000000000e-01,
                3.599999999999999867e-01,
                4.444444444444444198e-01,
                5.102040816326530726e-01,
                5.625000000000000000e-01,
                6.049382716049382935e-01,
                6.400000000000001243e-01,
                6.694214876033058870e-01,
                6.944444444444445308e-01,
                7.159763313609467383e-01,
                7.346938775510203357e-01,
                7.511111111111111738e-01,
                7.656250000000000000e-01,
                7.785467128027681039e-01,
                7.901234567901234129e-01,
                8.005540166204986319e-01,
                8.100000000000000533e-01,
                8.185941043083900803e-01,
                8.264462809917354491e-01,
                8.336483931947068493e-01,
                8.402777777777776791e-01,
                8.464000000000000412e-01,
                8.520710059171598960e-01,
                8.573388203017833220e-01,
                8.622448979591836871e-01,
                8.668252080856123643e-01,
                8.711111111111111693e-01,
                8.751300728407906959e-01,
                8.789062500000000000e-01,
                8.824609733700643499e-01,
                8.858131487889273625e-01,
                8.889795918367346950e-01,
                8.919753086419752730e-01,
                8.948137326515704926e-01,
                8.975069252077561011e-01,
                9.000657462195923442e-01,
                9.024999999999999689e-01,
                9.048185603807257227e-01,
                9.070294784580498204e-01,
                9.091400757166036017e-01,
                9.111570247933884481e-01,
                9.130864197530864645e-01,
                9.149338374291116072e-01,
                9.167043911272070300e-01,
                9.184027777777779011e-01,
                9.200333194502290368e-01,
                9.215999999999999748e-01,
                9.231064975009611873e-01,
                9.245562130177514826e-01,
                9.259522961908152050e-01,
                9.272976680384086290e-01,
                9.285950413223140743e-01,
                9.298469387755102789e-01,
                9.310557094490612418e-01,
                9.322235434007135613e-01,
                9.333524849181269456e-01,
                9.344444444444444109e-01,
                9.355012093523246142e-01,
                9.365244536940687814e-01,
                9.375157470395565351e-01,
                9.384765625000000000e-01,
                9.394082840236686049e-01,
                9.403122130394858669e-01,
                9.411895745154823523e-01,
                9.420415224913494256e-01,
                9.428691451375761368e-01,
                9.436734693877550928e-01,
                9.444554651854791816e-01,
                9.452160493827159726e-01,
                9.459560893225745781e-01,
                9.466764061358656779e-01,
                9.473777777777778741e-01,
                9.480609418282548440e-01,
                9.487265980772474627e-01,
                9.493754109138724528e-01,
                9.500080115366126288e-01,
                9.506249999999999423e-01,
                9.512269471117207331e-01,
                9.518143961927423291e-01,
                9.523878647118595442e-01,
                9.529478458049885914e-01,
                9.534948096885812463e-01,
                9.540292049756624593e-01,
                9.545514599022328905e-01,
                9.550619834710744049e-01,
                9.555611665193787241e-01,
                9.560493827160493341e-01,
                9.565269894940223727e-01,
                9.569943289224953631e-01,
                9.574517285235287778e-01,
                9.578995020371208202e-01,
                9.583379501385042021e-01,
                9.587673611111110494e-01,
                9.591880114783717381e-01,
                9.596001665972511141e-01,
                9.600040812162023984e-01,
                9.603999999999999204e-01,
                9.607881580237230823e-01,
                9.611687812379853257e-01,
                9.615420869073428856e-01,
                9.619082840236685694e-01,
                9.622675736961450177e-01,
                9.626201495194018909e-01,
                9.629661979212158496e-01,
                9.633058984910837230e-01,
                9.636394242908845609e-01,
                9.639669421487603307e-01,
                9.642886129372615356e-01,
                9.646045918367346372e-01,
                9.649150285848538955e-01,
                9.652200677131423934e-01,
                9.655198487712665090e-01,
                9.658145065398334728e-01,
                9.661041712323762409e-01,
                9.663889686871589557e-01,
                9.666690205493961852e-01,
                9.669444444444443842e-01,
                9.672153541424767242e-01,
                9.674818597151303434e-01,
                9.677440676845793233e-01,
                9.680020811654527213e-01,
                9.682560000000000056e-01,
                9.685059208868731506e-01,
                9.687519375038751157e-01,
                9.689941406250000000e-01,
                9.692326182320772920e-01,
                9.694674556213018768e-01,
                9.696987355049239143e-01,
                9.699265381083562731e-01,
                9.701509412629317763e-01,
                9.703720204945420758e-01,
                9.705898491083675417e-01,
                9.708044982698963432e-01,
                9.710160370824232334e-01,
                9.712245326612056751e-01,
                9.714300502044407315e-01,
                9.716326530612245937e-01,
                9.718324027966399603e-01,
                9.720293592541162653e-01,
                9.722235806151890980e-01,
                9.724151234567902646e-01,
                9.726040428061830667e-01,
                9.727903921936572607e-01,
                9.729742237030866159e-01,
                9.731555880204529885e-01,
                9.733345344804288368e-01,
                9.735111111111112159e-01,
                9.736853646769879633e-01,
                9.738573407202215648e-01,
                9.740270836003247501e-01,
                9.741946365322988743e-01,
                9.743600416233090256e-01,
                9.745233399079553660e-01,
                9.746845713822062107e-01,
                9.748437750360520182e-01,
                9.750009888849333617e-01,
                9.751562500000000577e-01,
                9.753095945372477482e-01,
                9.754610577655844494e-01,
                9.756106740938687016e-01,
                9.757584770969660592e-01,
                9.759044995408632239e-01,
                9.760487734068804544e-01,
                9.761913299150203338e-01,
                9.763321995464853131e-01,
                9.764714120654039986e-01,
                9.766089965397924955e-01,
                9.767449813617865573e-01,
                9.768793942671714081e-01,
                9.770122623542383256e-01,
                9.771436121019949628e-01,
                9.772734693877550560e-01,
                9.774018595041322754e-01,
                9.775288071754604236e-01,
                9.776543365736648505e-01,
                9.777784713336038491e-01,
                9.779012345679013452e-01,
                9.780226488812918673e-01,
                9.781427363844946710e-01,
                9.782615187076353358e-01,
                9.783790170132323771e-01,
                9.784952520087655259e-01,
                9.786102439588392210e-01,
                9.787240126969600773e-01,
                9.788365776369398752e-01,
                9.789479577839366176e-01,
                9.790581717451523058e-01,
                9.791672377401935412e-01,
                9.792751736111111605e-01,
                9.793819968321296754e-01,
                9.794877245190775072e-01,
                9.795923734385273418e-01,
                9.796959600166597060e-01,
                9.797985003478574262e-01,
                9.799000102030406278e-01,
                9.800005050377514904e-01,
                9.800999999999999712e-01,
                9.801985099378729416e-01,
                9.802960494069208330e-01,
                9.803926326773277911e-01,
                9.804882737408689986e-01,
                9.805829863176680483e-01,
                9.806767838627580280e-01,
                9.807696795724519800e-01,
                9.808616863905326166e-01,
                9.809528170142624015e-01,
                9.810430839002268755e-01,
                9.811324992700074521e-01,
                9.812210751156995592e-01,
                9.813088232052722404e-01,
                9.813957550877805414e-01,
                9.814818820984316794e-01,
                9.815672153635115471e-01,
                9.816517658051775452e-01,
                9.817355441461157461e-01,
                9.818185609140760439e-01,
                9.819008264462810720e-01,
                9.819823508937164380e-01,
                9.820631442253063836e-01,
                9.821432162319773118e-01,
                9.822225765306122902e-01,
                9.823012345679013047e-01,
                9.823791996240895941e-01,
                9.824564808166276197e-01,
                9.825330871037241121e-01,
                9.826090272878090781e-01,
                9.826843100189036617e-01,
                9.827589437979047382e-01,
                9.828329369797860204e-01,
                9.829062977767135667e-01,
                9.829790342610855713e-01,
                9.830511543684925524e-01,
                9.831226659006033763e-01,
                9.831935765279780082e-01,
                9.832638937928113165e-01,
                9.833336251116051585e-01,
                9.834027777777778478e-01,
                9.834713589642052334e-01,
                9.835393757257018255e-01,
                9.836068350014395278e-01,
                9.836737436173071947e-01,
                9.837401082882132330e-01,
                9.838059356203316952e-01,
                9.838712321132948579e-01,
                9.839360041623309572e-01,
                9.840002580603538496e-01,
                9.840639999999999388e-01,
                9.841272360756179172e-01,
                9.841899722852104349e-01,
                9.842522145323314708e-01,
                9.843139686279372969e-01,
                9.843752402921953637e-01,
                9.844360351562500000e-01,
                9.844963587639480318e-01,
            ];

            ddouble[] expected_dist_a1b2 = [
                0.000000000000000000e+00,
                5.555555555555555802e-01,
                7.500000000000000000e-01,
                8.399999999999999689e-01,
                8.888888888888888395e-01,
                9.183673469387755306e-01,
                9.375000000000000000e-01,
                9.506172839506172867e-01,
                9.599999999999999645e-01,
                9.669421487603305776e-01,
                9.722222222222222099e-01,
                9.763313609467455523e-01,
                9.795918367346938549e-01,
                9.822222222222222188e-01,
                9.843750000000000000e-01,
                9.861591695501730204e-01,
                9.876543209876542662e-01,
                9.889196675900276956e-01,
                9.899999999999999911e-01,
                9.909297052154194541e-01,
                9.917355371900826722e-01,
                9.924385633270321749e-01,
                9.930555555555555802e-01,
                9.936000000000000387e-01,
                9.940828402366863603e-01,
                9.945130315500685381e-01,
                9.948979591836735192e-01,
                9.952437574316289615e-01,
                9.955555555555555269e-01,
                9.958376690946930676e-01,
                9.960937500000000000e-01,
                9.963269054178145456e-01,
                9.965397923875431996e-01,
                9.967346938775509813e-01,
                9.969135802469135665e-01,
                9.970781592403213933e-01,
                9.972299168975069517e-01,
                9.973701512163050120e-01,
                9.974999999999999423e-01,
                9.976204640095180931e-01,
                9.977324263038548358e-01,
                9.978366684694429667e-01,
                9.979338842975206125e-01,
                9.980246913580247403e-01,
                9.981096408317580160e-01,
                9.981892258940696649e-01,
                9.982638888888888395e-01,
                9.983340274885463828e-01,
                9.983999999999999542e-01,
                9.984621299500192615e-01,
                9.985207100591716456e-01,
                9.985760056959772646e-01,
                9.986282578875171900e-01,
                9.986776859504131743e-01,
                9.987244897959183243e-01,
                9.987688519544475341e-01,
                9.988109393579072126e-01,
                9.988509049123814876e-01,
                9.988888888888889372e-01,
                9.989250201558720343e-01,
                9.989594172736732114e-01,
                9.989921894683799763e-01,
                9.990234375000000000e-01,
                9.990532544378698532e-01,
                9.990817263544535809e-01,
                9.991089329472042646e-01,
                9.991349480968858554e-01,
                9.991598403696702047e-01,
                9.991836734693877453e-01,
                9.992065066455068090e-01,
                9.992283950617284471e-01,
                9.992493901294802194e-01,
                9.992695398100803761e-01,
                9.992888888888888932e-01,
                9.993074792243766824e-01,
                9.993253499747005719e-01,
                9.993425378040762252e-01,
                9.993590770709822602e-01,
                9.993750000000000133e-01,
                9.993903368388965536e-01,
                9.994051160023795788e-01,
                9.994193642038031733e-01,
                9.994331065759637367e-01,
                9.994463667820069341e-01,
                9.994591671173607139e-01,
                9.994715286035142920e-01,
                9.994834710743801809e-01,
                9.994950132559020650e-01,
                9.995061728395061573e-01,
                9.995169665499336054e-01,
                9.995274102079395595e-01,
                9.995375187882992174e-01,
                9.995473064735174162e-01,
                9.995567867036011522e-01,
                9.995659722222222099e-01,
                9.995748751195663306e-01,
                9.995835068721365957e-01,
                9.995918783797571594e-01,
                9.996000000000000441e-01,
                9.996078815802372786e-01,
                9.996155324875047876e-01,
                9.996229616363464521e-01,
                9.996301775147928836e-01,
                9.996371882086168004e-01,
                9.996440014239943439e-01,
                9.996506245086906883e-01,
                9.996570644718792975e-01,
                9.996633280026934187e-01,
                9.996694214876032936e-01,
                9.996753510267023524e-01,
                9.996811224489795533e-01,
                9.996867413266504743e-01,
                9.996922129886118835e-01,
                9.996975425330812959e-01,
                9.997027348394768032e-01,
                9.997077945795894705e-01,
                9.997127262280953719e-01,
                9.997175340724525627e-01,
                9.997222222222221788e-01,
                9.997267946178539644e-01,
                9.997312550389679808e-01,
                9.997356071121686893e-01,
                9.997398543184182751e-01,
                9.997439999999999660e-01,
                9.997480473670949941e-01,
                9.997519995039989560e-01,
                9.997558593750000000e-01,
                9.997596298299381568e-01,
                9.997633136094674633e-01,
                9.997669133500378669e-01,
                9.997704315886134507e-01,
                9.997738707671434133e-01,
                9.997772332368011217e-01,
                9.997805212620027859e-01,
                9.997837370242214083e-01,
                9.997868826256059993e-01,
                9.997899600924176067e-01,
                9.997929713782930383e-01,
                9.997959183673469363e-01,
                9.997988028771188640e-01,
                9.998016266613767300e-01,
                9.998043914127829890e-01,
                9.998070987654320563e-01,
                9.998097502972651540e-01,
                9.998123475323700271e-01,
                9.998148919431718573e-01,
                9.998173849525200385e-01,
                9.998198279356785845e-01,
                9.998222222222221678e-01,
                9.998245690978465605e-01,
                9.998268698060941428e-01,
                9.998291255500021402e-01,
                9.998313374936751430e-01,
                9.998335067637876827e-01,
                9.998356344510190841e-01,
                9.998377216114243682e-01,
                9.998397692677455373e-01,
                9.998417784106641282e-01,
                9.998437500000000311e-01,
                9.998456849658577950e-01,
                9.998475842097240829e-01,
                9.998494486055177211e-01,
                9.998512790005948947e-01,
                9.998530762167125996e-01,
                9.998548410509507933e-01,
                9.998565742765964659e-01,
                9.998582766439909619e-01,
                9.998599488813416647e-01,
                9.998615916955017058e-01,
                9.998632057727163680e-01,
                9.998647917793401785e-01,
                9.998663503625246918e-01,
                9.998678821508786285e-01,
                9.998693877551020348e-01,
                9.998708677685950175e-01,
                9.998723227680423875e-01,
                9.998737533139755440e-01,
                9.998751599513123756e-01,
                9.998765432098765116e-01,
                9.998779036048960345e-01,
                9.998792416374834291e-01,
                9.998805577950968804e-01,
                9.998818525519849176e-01,
                9.998831263696128513e-01,
                9.998843796970747766e-01,
                9.998856129714890351e-01,
                9.998868266183793541e-01,
                9.998880210520422196e-01,
                9.998891966759002603e-01,
                9.998903538828430859e-01,
                9.998914930555555802e-01,
                9.998926145668339815e-01,
                9.998937187798916382e-01,
                9.998948060486522182e-01,
                9.998958767180341489e-01,
                9.998969311242237312e-01,
                9.998979695949392621e-01,
                9.998989924496856085e-01,
                9.999000000000000110e-01,
                9.999009925496893381e-01,
                9.999019703950593474e-01,
                9.999029338251352872e-01,
                9.999038831218761691e-01,
                9.999048185603807148e-01,
                9.999057404090866408e-01,
                9.999066489299633931e-01,
                9.999075443786982209e-01,
                9.999084270048762546e-01,
                9.999092970521541446e-01,
                9.999101547584285932e-01,
                9.999110003559985582e-01,
                9.999118340717230158e-01,
                9.999126561271727276e-01,
                9.999134667387776787e-01,
                9.999142661179698521e-01,
                9.999150544713202304e-01,
                9.999158320006733547e-01,
                9.999165989032755553e-01,
                9.999173553719008511e-01,
                9.999181015949714091e-01,
                9.999188377566755603e-01,
                9.999195640370809324e-01,
                9.999202806122449161e-01,
                9.999209876543210251e-01,
                9.999216853316625908e-01,
                9.999223738089231261e-01,
                9.999230532471529154e-01,
                9.999237238038939379e-01,
                9.999243856332703517e-01,
                9.999250388860778660e-01,
                9.999256837098692285e-01,
                9.999263202490376035e-01,
                9.999269486448973954e-01,
                9.999275690357627422e-01,
                9.999281815570238985e-01,
                9.999287863412202881e-01,
                9.999293835181131129e-01,
                9.999299732147546305e-01,
                9.999305555555555447e-01,
                9.999311306623508422e-01,
                9.999316986544635188e-01,
                9.999322596487663084e-01,
                9.999328137597419675e-01,
                9.999333610995418953e-01,
                9.999339017780422001e-01,
                9.999344359028995433e-01,
                9.999349635796045410e-01,
                9.999354849115337229e-01,
                9.999360000000000470e-01,
                9.999365089443025267e-01,
                9.999370118417737485e-01,
                9.999375087878267232e-01,
                9.999379998759997390e-01,
                9.999384851980007705e-01,
                9.999389648437500000e-01,
                9.999394389014216733e-01,
            ];

            ddouble[] expected_dist_a2b2 = [
                0.000000000000000000e+00,
                2.592592592592592449e-01,
                5.000000000000000000e-01,
                6.479999999999999094e-01,
                7.407407407407406996e-01,
                8.017492711370262093e-01,
                8.437500000000000000e-01,
                8.737997256515774858e-01,
                8.960000000000000187e-01,
                9.128474830954170782e-01,
                9.259259259259259300e-01,
                9.362767410104687604e-01,
                9.446064139941690030e-01,
                9.514074074074074794e-01,
                9.570312500000000000e-01,
                9.617341746387135792e-01,
                9.657064471879286405e-01,
                9.690917043300772971e-01,
                9.719999999999999751e-01,
                9.745167908433214343e-01,
                9.767092411720510459e-01,
                9.786307224459603882e-01,
                9.803240740740740700e-01,
                9.818240000000000300e-01,
                9.831588529813382049e-01,
                9.843519788650104685e-01,
                9.854227405247814042e-01,
                9.863873057525933685e-01,
                9.872592592592592808e-01,
                9.880500822396025562e-01,
                9.887695312500000000e-01,
                9.894259398391630489e-01,
                9.900264604111540523e-01,
                9.905772594752186855e-01,
                9.910836762688614021e-01,
                9.915503523976861855e-01,
                9.919813383875200063e-01,
                9.923801817292940974e-01,
                9.927500000000000213e-01,
                9.930935418812844029e-01,
                9.934132383111974329e-01,
                9.937112455507062236e-01,
                9.939894815927874383e-01,
                9.942496570644718812e-01,
                9.944933015533821141e-01,
                9.947217861167564346e-01,
                9.949363425925925597e-01,
                9.951380802216763799e-01,
                9.953279999999999905e-01,
                9.955070071088797379e-01,
                9.956759217114247162e-01,
                9.958354883561597592e-01,
                9.959863841894019965e-01,
                9.961292261457550534e-01,
                9.962645772594752591e-01,
                9.963929522174164166e-01,
                9.965148222559350177e-01,
                9.966306194888474579e-01,
                9.967407407407407050e-01,
                9.968455509491983557e-01,
                9.969453861904602476e-01,
                9.970405563754014544e-01,
                9.971313476562500000e-01,
                9.972180245789713515e-01,
                9.973008320115758218e-01,
                9.973799968746155375e-01,
                9.974557296967230258e-01,
                9.975282260151168146e-01,
                9.975976676384840092e-01,
                9.976642237874778774e-01,
                9.977280521262003044e-01,
                9.977892996964142780e-01,
                9.978481037648313512e-01,
                9.979045925925925653e-01,
                9.979588861350050522e-01,
                9.980110966786628346e-01,
                9.980613294222762111e-01,
                9.981096830068210135e-01,
                9.981562499999999671e-01,
                9.982011173394600423e-01,
                9.982443667387298492e-01,
                9.982860750594190202e-01,
                9.983263146528452703e-01,
                9.983651536739263088e-01,
                9.984026563698793488e-01,
                9.984388833460136059e-01,
                9.984738918106687011e-01,
                9.985077358011487103e-01,
                9.985404663923181934e-01,
                9.985721318893641119e-01,
                9.986027780060819925e-01,
                9.986324480299170192e-01,
                9.986611829748707203e-01,
                9.986890217232833322e-01,
                9.987160011574074403e-01,
                9.987421562816035658e-01,
                9.987675203359144271e-01,
                9.987921249017055469e-01,
                9.988160000000000371e-01,
                9.988391741830785486e-01,
                9.988616746198671903e-01,
                9.988835271755891476e-01,
                9.989047564861174289e-01,
                9.989253860274268648e-01,
                9.989454381805114025e-01,
                9.989649342921024244e-01,
                9.989838947314941819e-01,
                9.990023389437611145e-01,
                9.990202854996242943e-01,
                9.990377521422079132e-01,
                9.990547558309037512e-01,
                9.990713127825479045e-01,
                9.990874385100948496e-01,
                9.991031478589628145e-01,
                9.991184550412071097e-01,
                9.991333736676712984e-01,
                9.991479167782489901e-01,
                9.991620968703843753e-01,
                9.991759259259259673e-01,
                9.991894154364427960e-01,
                9.992025764271018629e-01,
                9.992154194791997845e-01,
                9.992279547514349991e-01,
                9.992401920000000271e-01,
                9.992521405975676174e-01,
                9.992638095512411667e-01,
                9.992752075195312500e-01,
                9.992863428284208815e-01,
                9.992972234865725722e-01,
                9.993078571997308091e-01,
                9.993182513843671400e-01,
                9.993284131806139392e-01,
                9.993383494645285969e-01,
                9.993480668597266581e-01,
                9.993575717484225462e-01,
                9.993668702819099581e-01,
                9.993759683905159008e-01,
                9.993848717930577941e-01,
                9.993935860058309473e-01,
                9.994021163511546124e-01,
                9.994104679654998158e-01,
                9.994186458072222834e-01,
                9.994266546639232196e-01,
                9.994344991594571459e-01,
                9.994421837606068948e-01,
                9.994497127834427452e-01,
                9.994570903993840183e-01,
                9.994643206409772329e-01,
                9.994714074074073640e-01,
                9.994783544697557476e-01,
                9.994851654760169568e-01,
                9.994918439558887480e-01,
                9.994983933253456243e-01,
                9.995048168910073416e-01,
                9.995111178543131247e-01,
                9.995172993155108099e-01,
                9.995233642774709049e-01,
                9.995293156493342268e-01,
                9.995351562500000009e-01,
                9.995408888114650781e-01,
                9.995465159820187129e-01,
                9.995520403293011169e-01,
                9.995574643432335593e-01,
                9.995627904388234564e-01,
                9.995680209588535536e-01,
                9.995731581764578655e-01,
                9.995782042975920323e-01,
                9.995831614634016482e-01,
                9.995880317524933334e-01,
                9.995928171831148790e-01,
                9.995975197152452418e-01,
                9.996021412526022720e-01,
                9.996066836445696158e-01,
                9.996111486880466801e-01,
                9.996155381292261000e-01,
                9.996198536653013722e-01,
                9.996240969461068770e-01,
                9.996282695756955050e-01,
                9.996323731138545554e-01,
                9.996364090775634592e-01,
                9.996403789423956576e-01,
                9.996442841438678562e-01,
                9.996481260787375422e-01,
                9.996519061062523193e-01,
                9.996556255493518339e-01,
                9.996592856958256279e-01,
                9.996628877994279128e-01,
                9.996664330809511556e-01,
                9.996699227292608070e-01,
                9.996733579022918370e-01,
                9.996767397280093004e-01,
                9.996800693053344844e-01,
                9.996833477050378614e-01,
                9.996865759705996224e-01,
                9.996897551190405684e-01,
                9.996928861417225809e-01,
                9.996959700051221143e-01,
                9.996990076515757107e-01,
                9.997019999999999795e-01,
                9.997049479465867083e-01,
                9.997078523654737703e-01,
                9.997107141093933835e-01,
                9.997135340102977219e-01,
                9.997163128799639864e-01,
                9.997190515105786046e-01,
                9.997217506753014460e-01,
                9.997244111288120516e-01,
                9.997270336078368791e-01,
                9.997296188316596721e-01,
                9.997321675026141774e-01,
                9.997346803065617626e-01,
                9.997371579133526032e-01,
                9.997396009772717695e-01,
                9.997420101374722146e-01,
                9.997443860183915509e-01,
                9.997467292301576158e-01,
                9.997490403689801575e-01,
                9.997513200175294212e-01,
                9.997535687453042996e-01,
                9.997557871089872705e-01,
                9.997579756527893435e-01,
                9.997601349087841260e-01,
                9.997622653972303430e-01,
                9.997643676268861412e-01,
                9.997664420953124020e-01,
                9.997684892891671726e-01,
                9.997705096844913264e-01,
                9.997725037469848974e-01,
                9.997744719322758655e-01,
                9.997764146861802814e-01,
                9.997783324449547315e-01,
                9.997802256355412531e-01,
                9.997820946758049221e-01,
                9.997839399747647793e-01,
                9.997857619328168743e-01,
                9.997875609419524245e-01,
                9.997893373859677579e-01,
                9.997910916406697046e-01,
                9.997928240740741046e-01,
                9.997945350465986536e-01,
                9.997962249112506417e-01,
                9.997978940138088078e-01,
                9.997995426930007534e-01,
                9.998011712806739171e-01,
                9.998027801019632177e-01,
                9.998043694754533695e-01,
                9.998059397133362003e-01,
                9.998074911215644178e-01,
                9.998090240000000462e-01,
                9.998105386425599761e-01,
                9.998120353373566305e-01,
                9.998135143668346325e-01,
                9.998149760079048098e-01,
                9.998164205320728692e-01,
                9.998178482055664062e-01,
                9.998192592894569186e-01,
            ];

            ddouble[] expected_dist_a3b4 = [
                0.000000000000000000e+00,
                3.196159122085049931e-01,
                6.562499999999998890e-01,
                8.207999999999999741e-01,
                8.998628257887516524e-01,
                9.402969850997459078e-01,
                9.624023437500000000e-01,
                9.752220848598432967e-01,
                9.830400000000000249e-01,
                9.880150895170981551e-01,
                9.912980109739368828e-01,
                9.935327873963937240e-01,
                9.950955809229147242e-01,
                9.962144307270233146e-01,
                9.970321655273437500e-01,
                9.976408560447822538e-01,
                9.981013884890326260e-01,
                9.984549550682236818e-01,
                9.987300000000000066e-01,
                9.989465304137982171e-01,
                9.991188561951860336e-01,
                9.992573692721229417e-01,
                9.993697220078875398e-01,
                9.994616217599999741e-01,
                9.995373755207632716e-01,
                9.996002689470561142e-01,
                9.996528338532414404e-01,
                9.996970394508120084e-01,
                9.997344307270232822e-01,
                9.997662297019813682e-01,
                9.997934103012084961e-01,
                9.998167542628384474e-01,
                9.998368932679176924e-01,
                9.998543409633741108e-01,
                9.998695175005315461e-01,
                9.998827684826624429e-01,
                9.998943797013812862e-01,
                9.999045886762994995e-01,
                9.999135937499999960e-01,
                9.999215613003218373e-01,
                9.999286314930810882e-01,
                9.999349228960888736e-01,
                9.999405361994309072e-01,
                9.999455572302475836e-01,
                9.999500594075535487e-01,
                9.999541057502887575e-01,
                9.999577505271294298e-01,
                9.999610406176702160e-01,
                9.999640166400000085e-01,
                9.999667138883709949e-01,
                9.999691631158390548e-01,
                9.999713911898335805e-01,
                9.999734216431697131e-01,
                9.999752751387053218e-01,
                9.999769698624191294e-01,
                9.999785218569535727e-01,
                9.999799453054732945e-01,
                9.999812527739281309e-01,
                9.999824554183813774e-01,
                9.999835631629135912e-01,
                9.999845848526683900e-01,
                9.999855283858384292e-01,
                9.999864008277654648e-01,
                9.999872085098042707e-01,
                9.999879571151795155e-01,
                9.999886517537083241e-01,
                9.999892970269707027e-01,
                9.999898970852646451e-01,
                9.999904556774813491e-01,
                9.999909761948637676e-01,
                9.999914617094725067e-01,
                9.999919150080586183e-01,
                9.999923386219469190e-01,
                9.999927348534430882e-01,
                9.999931057992090810e-01,
                9.999934533709891049e-01,
                9.999937793140146747e-01,
                9.999940852233739630e-01,
                9.999943725585938026e-01,
                9.999946426566468372e-01,
                9.999948967435723368e-01,
                9.999951359448708832e-01,
                9.999953612948171422e-01,
                9.999955737448125159e-01,
                9.999957741708880299e-01,
                9.999959633804509362e-01,
                9.999961421183598542e-01,
                9.999963110724018334e-01,
                9.999964708782348444e-01,
                9.999966221238548725e-01,
                9.999967653536366852e-01,
                9.999969010719925722e-01,
                9.999970297466909130e-01,
                9.999971518118663250e-01,
                9.999972676707556962e-01,
                9.999973776981854190e-01,
                9.999974822428366883e-01,
                9.999975816293084074e-01,
                9.999976761600000152e-01,
                9.999977661168291121e-01,
                9.999978517628020924e-01,
                9.999979333434497741e-01,
                9.999980110881420137e-01,
                9.999980852112921870e-01,
                9.999981559134611953e-01,
                9.999982233823706546e-01,
                9.999982877938342618e-01,
                9.999983493126127776e-01,
                9.999984080932013963e-01,
                9.999984642805539448e-01,
                9.999985180107504590e-01,
                9.999985694116128032e-01,
                9.999986186032723268e-01,
                9.999986656986942224e-01,
                9.999987108041615835e-01,
                9.999987540197240454e-01,
                9.999987954396112322e-01,
                9.999988351526172270e-01,
                9.999988732424553994e-01,
                9.999989097880883637e-01,
                9.999989448640334011e-01,
                9.999989785406461218e-01,
                9.999990108843841430e-01,
                9.999990419580518930e-01,
                9.999990718210280960e-01,
                9.999991005294781576e-01,
                9.999991281365510076e-01,
                9.999991546925627306e-01,
                9.999991802451682066e-01,
                9.999992048395203170e-01,
                9.999992285184193808e-01,
                9.999992513224519319e-01,
                9.999992732901206161e-01,
                9.999992944579655374e-01,
                9.999993148606781679e-01,
                9.999993345312068183e-01,
                9.999993535008564471e-01,
                9.999993717993818088e-01,
                9.999993894550739393e-01,
                9.999994064948426464e-01,
                9.999994229442922267e-01,
                9.999994388277941848e-01,
                9.999994541685540694e-01,
                9.999994689886747556e-01,
                9.999994833092161750e-01,
                9.999994971502512708e-01,
                9.999995105309180676e-01,
                9.999995234694694091e-01,
                9.999995359833195874e-01,
                9.999995480890877531e-01,
                9.999995598026391042e-01,
                9.999995711391241882e-01,
                9.999995821130150953e-01,
                9.999995927381398753e-01,
                9.999996030277152892e-01,
                9.999996129943775625e-01,
                9.999996226502112506e-01,
                9.999996320067762179e-01,
                9.999996410751342824e-01,
                9.999996498658729749e-01,
                9.999996583891288537e-01,
                9.999996666546092650e-01,
                9.999996746716132145e-01,
                9.999996824490503533e-01,
                9.999996899954601837e-01,
                9.999996973190289351e-01,
                9.999997044276065505e-01,
                9.999997113287223405e-01,
                9.999997180295994159e-01,
                9.999997245371695653e-01,
                9.999997308580860222e-01,
                9.999997369987364548e-01,
                9.999997429652549563e-01,
                9.999997487635335913e-01,
                9.999997543992328319e-01,
                9.999997598777924379e-01,
                9.999997652044410046e-01,
                9.999997703842052887e-01,
                9.999997754219188684e-01,
                9.999997803222310244e-01,
                9.999997850896142904e-01,
                9.999997897283723347e-01,
                9.999997942426470665e-01,
                9.999997986364258518e-01,
                9.999998029135476196e-01,
                9.999998070777094128e-01,
                9.999998111324722716e-01,
                9.999998150812671183e-01,
                9.999998189273998639e-01,
                9.999998226740566265e-01,
                9.999998263243090602e-01,
                9.999998298811183517e-01,
                9.999998333473404388e-01,
                9.999998367257296739e-01,
                9.999998400189434866e-01,
                9.999998432295457151e-01,
                9.999998463600108245e-01,
                9.999998494127270154e-01,
                9.999998523899999991e-01,
                9.999998552940562169e-01,
                9.999998581270455045e-01,
                9.999998608910448672e-01,
                9.999998635880603670e-01,
                9.999998662200305644e-01,
                9.999998687888290716e-01,
                9.999998712962664404e-01,
                9.999998737440932706e-01,
                9.999998761340019859e-01,
                9.999998784676293884e-01,
                9.999998807465585449e-01,
                9.999998829723205640e-01,
                9.999998851463970384e-01,
                9.999998872702215991e-01,
                9.999998893451815807e-01,
                9.999998913726200200e-01,
                9.999998933538368773e-01,
                9.999998952900910343e-01,
                9.999998971826011829e-01,
                9.999998990325481563e-01,
                9.999999008410753731e-01,
                9.999999026092906140e-01,
                9.999999043382675756e-01,
                9.999999060290464259e-01,
                9.999999076826352473e-01,
                9.999999093000114803e-01,
                9.999999108821225891e-01,
                9.999999124298872832e-01,
                9.999999139441964058e-01,
                9.999999154259140433e-01,
                9.999999168758783030e-01,
                9.999999182949020904e-01,
                9.999999196837745519e-01,
                9.999999210432611862e-01,
                9.999999223741047327e-01,
                9.999999236770265032e-01,
                9.999999249527264933e-01,
                9.999999262018843815e-01,
                9.999999274251599735e-01,
                9.999999286231942008e-01,
                9.999999297966095657e-01,
                9.999999309460105845e-01,
                9.999999320719845652e-01,
                9.999999331751022735e-01,
                9.999999342559180437e-01,
                9.999999353149708892e-01,
                9.999999363527845020e-01,
                9.999999373698680305e-01,
                9.999999383667163011e-01,
                9.999999393438105955e-01,
                9.999999403016186506e-01,
                9.999999412405956578e-01,
                9.999999421611839301e-01,
                9.999999430638141229e-01,
                9.999999439489049013e-01,
                9.999999448168637173e-01,
                9.999999456680868093e-01,
            ];

            foreach ((BetaPrimeDistribution dist, ddouble[] expecteds) in new[]{
                (dist_a1b1, expected_dist_a1b1), (dist_a2b1, expected_dist_a2b1),
                (dist_a1b2, expected_dist_a1b2), (dist_a2b2, expected_dist_a2b2),
                (dist_a3b4, expected_dist_a3b4),
            }) {
                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-12, $"{dist} cdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}