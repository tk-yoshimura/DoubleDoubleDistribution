using DoubleDouble;
using DoubleDoubleStatistic;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleStatisticTest.LinearityDistribution {
    [TestClass()]
    public class CosineDistributionTests {
        readonly CosineDistribution dist1 = new();
        readonly CosineDistribution dist2 = new(mu: 1, sigma: 3);

        CosineDistribution[] Dists => [
            dist1,
            dist2,
        ];

        [TestMethod()]
        public void InfoTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                Console.WriteLine($"Support={dist.Support}");
                Console.WriteLine($"Mu={dist.Mu}");
                Console.WriteLine($"Sigma={dist.Sigma}");
                Console.WriteLine($"Mean={dist.Mean}");
                Console.WriteLine($"Median={dist.Median}");
                Console.WriteLine($"Mode={dist.Mode}");
                Console.WriteLine($"Variance={dist.Variance}");
                Console.WriteLine($"Skewness={dist.Skewness}");
                Console.WriteLine($"Kurtosis={dist.Kurtosis}");
                Console.WriteLine($"Entropy={dist.Entropy}");
            }
        }

        [TestMethod()]
        public void MeanTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mean)) {
                    continue;
                }

                ddouble actual = dist.Mean;
                ddouble expected = IntegrationStatistics.Mean(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-28, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void ModeTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Mode)) {
                    continue;
                }

                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode - 1e-4), $"{dist}\n{dist.Mode}");
                Assert.IsTrue(dist.PDF(dist.Mode) > dist.PDF(dist.Mode + 1e-4), $"{dist}\n{dist.Mode}");
            }
        }

        [TestMethod()]
        public void MedianTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                Assert.IsTrue(ddouble.Abs(dist.CDF(dist.Median) - 0.5) < 1e-20, $"{dist}\n{dist.Median}");
            }
        }

        [TestMethod()]
        public void VarianceTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (!ddouble.IsFinite(dist.Variance)) {
                    continue;
                }

                ddouble actual = dist.Variance;
                ddouble expected = IntegrationStatistics.Variance(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void SkewnessTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (ddouble.IsNaN(dist.Skewness)) {
                    continue;
                }

                ddouble actual = dist.Skewness;
                ddouble expected = IntegrationStatistics.Skewness(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void KurtosisTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                if (!ddouble.IsFinite(dist.Kurtosis)) {
                    continue;
                }

                ddouble actual = dist.Kurtosis;
                ddouble expected = IntegrationStatistics.Kurtosis(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void EntropyTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);

                ddouble actual = dist.Entropy;
                ddouble expected = IntegrationStatistics.Entropy(dist, eps: 1e-28, discontinue_eval_points: 65536);
                Assert.IsTrue(ddouble.Abs(actual - expected) < 1e-20, $"{dist}\n{expected}\n{actual}");
            }
        }

        [TestMethod()]
        public void PDFTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble pdf = dist.PDF(x);

                    Console.WriteLine($"pdf({x})={pdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFLowerTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"cdf({x})={cdf}");
                }
            }
        }

        [TestMethod()]
        public void CDFUpperTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (ddouble x = -4; x <= 4; x += 0.125) {
                    ddouble cdf = dist.CDF(x, Interval.Lower);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"ccdf({x})={ccdf}");

                    Assert.IsTrue(ddouble.Abs(cdf + ccdf - 1) < 1e-28);
                }
            }
        }

        [TestMethod()]
        public void QuantileLowerTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Lower);
                    ddouble cdf = dist.CDF(x, Interval.Lower);

                    Console.WriteLine($"quantile({p})={x}, cdf({x})={cdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - cdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void QuantileUpperTest() {
            foreach (CosineDistribution dist in Dists) {
                Console.WriteLine(dist);
                for (int i = 0; i <= 10; i++) {
                    ddouble p = (ddouble)i / 10;
                    ddouble x = dist.Quantile(p, Interval.Upper);
                    ddouble ccdf = dist.CDF(x, Interval.Upper);

                    Console.WriteLine($"cquantile({p})={x}, ccdf({x})={ccdf}");

                    if (ddouble.IsFinite(x)) {
                        Assert.IsTrue(ddouble.Abs(p - ccdf) < 1e-28);
                    }
                }
            }
        }

        [TestMethod()]
        public void PDFExpectedTest() {
            ddouble[] expected_dist1 = [
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                6.022718974137974968e-04,
                2.407636663901591145e-03,
                5.411745017609492781e-03,
                9.607359798384784710e-03,
                1.498437340272801288e-02,
                2.152983213389558781e-02,
                2.922796740848965236e-02,
                3.806023374435663076e-02,
                4.800535343827844192e-02,
                5.903936782582253073e-02,
                7.113569499986399647e-02,
                8.426519384872749319e-02,
                9.839623425967759796e-02,
                1.134947733186315033e-01,
                1.295244373225205581e-01,
                1.464466094067262691e-01,
                1.642205225764907794e-01,
                1.828033579181773116e-01,
                2.021503477537832938e-01,
                2.222148834901990222e-01,
                2.429486279033892249e-01,
                2.643016315870011512e-01,
                2.862224532848590686e-01,
                3.086582838174551369e-01,
                3.315550733038900022e-01,
                3.548576613727689177e-01,
                3.785099100483680923e-01,
                4.024548389919359037e-01,
                4.266347627723191538e-01,
                4.509914298352197259e-01,
                4.754661628362909509e-01,
                5.000000000000000000e-01,
                5.245338371637090491e-01,
                5.490085701647804406e-01,
                5.733652372276808462e-01,
                5.975451610080642073e-01,
                6.214900899516320187e-01,
                6.451423386272312488e-01,
                6.684449266961099978e-01,
                6.913417161825449186e-01,
                7.137775467151410425e-01,
                7.356983684129989598e-01,
                7.570513720966107751e-01,
                7.777851165098010888e-01,
                7.978496522462166229e-01,
                8.171966420818227439e-01,
                8.357794774235092206e-01,
                8.535533905932737309e-01,
                8.704755626774797195e-01,
                8.865052266813684412e-01,
                9.016037657403225269e-01,
                9.157348061512727844e-01,
                9.288643050001361701e-01,
                9.409606321741774693e-01,
                9.519946465617217246e-01,
                9.619397662556433692e-01,
                9.707720325915103476e-01,
                9.784701678661045232e-01,
                9.850156265972720426e-01,
                9.903926402016152153e-01,
                9.945882549823905627e-01,
                9.975923633360984644e-01,
                9.993977281025862025e-01,
                1.000000000000000000e+00,
                9.993977281025862025e-01,
                9.975923633360984644e-01,
                9.945882549823905627e-01,
                9.903926402016152153e-01,
                9.850156265972720426e-01,
                9.784701678661045232e-01,
                9.707720325915103476e-01,
                9.619397662556433692e-01,
                9.519946465617217246e-01,
                9.409606321741774693e-01,
                9.288643050001361701e-01,
                9.157348061512727844e-01,
                9.016037657403225269e-01,
                8.865052266813684412e-01,
                8.704755626774797195e-01,
                8.535533905932737309e-01,
                8.357794774235092206e-01,
                8.171966420818227439e-01,
                7.978496522462166229e-01,
                7.777851165098010888e-01,
                7.570513720966107751e-01,
                7.356983684129989598e-01,
                7.137775467151410425e-01,
                6.913417161825449186e-01,
                6.684449266961099978e-01,
                6.451423386272312488e-01,
                6.214900899516320187e-01,
                5.975451610080642073e-01,
                5.733652372276808462e-01,
                5.490085701647804406e-01,
                5.245338371637090491e-01,
                5.000000000000000000e-01,
                4.754661628362909509e-01,
                4.509914298352197259e-01,
                4.266347627723191538e-01,
                4.024548389919359037e-01,
                3.785099100483680923e-01,
                3.548576613727689177e-01,
                3.315550733038900022e-01,
                3.086582838174551369e-01,
                2.862224532848590686e-01,
                2.643016315870011512e-01,
                2.429486279033892249e-01,
                2.222148834901990222e-01,
                2.021503477537832938e-01,
                1.828033579181773116e-01,
                1.642205225764907794e-01,
                1.464466094067262691e-01,
                1.295244373225205581e-01,
                1.134947733186315033e-01,
                9.839623425967759796e-02,
                8.426519384872749319e-02,
                7.113569499986399647e-02,
                5.903936782582253073e-02,
                4.800535343827844192e-02,
                3.806023374435663076e-02,
                2.922796740848965236e-02,
                2.152983213389558781e-02,
                1.498437340272801288e-02,
                9.607359798384784710e-03,
                5.411745017609492781e-03,
                2.407636663901591145e-03,
                6.022718974137974968e-04,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,

            ];
            ddouble[] expected_dist2 = [
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                2.231034840636618094e-05,
                8.923542060571924828e-05,
                2.007572991379324989e-04,
                3.568461268994201356e-04,
                5.574601151366136414e-04,
                8.025455546338636790e-04,
                1.092036830092605769e-03,
                1.425856437698269858e-03,
                1.803915005869831216e-03,
                2.226111319186837353e-03,
                2.692332345487084659e-03,
                3.202453266128261426e-03,
                3.756337509404683583e-03,
                4.353836787111061910e-03,
                4.994791134242671828e-03,
                5.679028951821947675e-03,
                6.406367052839663685e-03,
                7.176610711298529559e-03,
                7.989553714345953850e-03,
                8.844978417482404418e-03,
                9.742655802829866193e-03,
                1.068234554044570836e-02,
                1.166379605266465620e-02,
                1.268674458145221257e-02,
                1.375091725875145915e-02,
                1.485602917980401692e-02,
                1.600178447942611146e-02,
                1.718787641121862289e-02,
                1.841398742969067512e-02,
                1.967978927527417807e-02,
                2.098494306220684627e-02,
                2.232909936926021424e-02,
                2.371189833328799998e-02,
                2.513296974557020433e-02,
                2.659193315092702598e-02,
                2.808839794957577671e-02,
                2.962196350170415160e-02,
                3.119221923473081137e-02,
                3.279874475322586830e-02,
                3.444110995146078963e-02,
                3.611887512855827681e-02,
                3.783159110621050342e-02,
                3.957879934893532292e-02,
                4.136003208683711879e-02,
                4.317481244084012820e-02,
                4.502265455036071756e-02,
                4.690306370338365172e-02,
                4.881553646890875869e-02,
                5.075956083173142896e-02,
                5.273461632952144290e-02,
                5.474017419216359315e-02,
                5.677569748332186167e-02,
                5.884064124419045860e-02,
                6.093445263939244183e-02,
                6.305657110498708029e-02,
                6.520642849854656198e-02,
                6.738344925126110718e-02,
                6.958705052203299768e-02,
                7.181664235351700731e-02,
                7.407162783006628060e-02,
                7.635140323754138758e-02,
                7.865535822493867346e-02,
                8.098287596779640829e-02,
                8.333333333333338422e-02,
                8.570610104727664769e-02,
                8.810054386233372170e-02,
                9.051602072826323009e-02,
                9.295188496349982010e-02,
                9.540748442828628217e-02,
                9.788216169926756971e-02,
                1.003752542454981744e-01,
                1.028860946058183790e-01,
                1.054140105675494127e-01,
                1.079583253464610898e-01,
                1.105183577679633017e-01,
                1.130934224494730689e-01,
                1.156828299839077756e-01,
                1.182858871242562782e-01,
                1.209018969691779549e-01,
                1.235301591495798768e-01,
                1.261699700161227067e-01,
                1.288206228276044807e-01,
                1.314814079401724622e-01,
                1.341516129973119864e-01,
                1.368305231205612094e-01,
                1.395174211009019005e-01,
                1.422115875907730420e-01,
                1.449123012966580804e-01,
                1.476188391721922899e-01,
                1.503304766117398994e-01,
                1.530464876443886624e-01,
                1.557661451283094967e-01,
                1.584887209454303447e-01,
                1.612134861963706589e-01,
                1.639397113955855523e-01,
                1.666666666666666852e-01,
                1.693936219377478181e-01,
                1.721198471369627114e-01,
                1.748446123879030256e-01,
                1.775671882050238459e-01,
                1.802868456889447080e-01,
                1.830028567215934432e-01,
                1.857144941611411082e-01,
                1.884210320366752900e-01,
                1.911217457425603006e-01,
                1.938159122324314976e-01,
                1.965028102127721055e-01,
                1.991817203360214117e-01,
                2.018519253931608526e-01,
                2.045127105057288897e-01,
                2.071633633172106914e-01,
                2.098031741837534658e-01,
                2.124314363641554293e-01,
                2.150474462090770367e-01,
                2.176505033494256225e-01,
                2.202399108838602737e-01,
                2.228149755653700270e-01,
                2.253750079868722667e-01,
                2.279193227657839438e-01,
                2.304472387275149914e-01,
                2.329580790878351682e-01,
                2.354511716340658145e-01,
                2.379258489050470327e-01,
                2.403814483698335502e-01,
                2.428173126050701125e-01,
                2.452327894709996070e-01,
                2.476272322860567088e-01,
                2.500000000000000000e-01,
                2.523504573655369621e-01,
                2.546779751083946830e-01,
                2.569819300957919550e-01,
                2.592617055032670481e-01,
                2.615166909798163908e-01,
                2.637462828113003588e-01,
                2.659498840820722076e-01,
                2.681269048347867945e-01,
                2.702767622283462901e-01,
                2.723988806939409146e-01,
                2.744926920891429534e-01,
                2.765576358500114740e-01,
                2.785931591411697217e-01,
                2.805987170038118927e-01,
                2.825737725016019830e-01,
                2.845177968644246325e-01,
                2.864302696299497186e-01,
                2.883106787829726181e-01,
                2.901585208924932213e-01,
                2.919733012464962307e-01,
                2.937545339843980474e-01,
                2.955017422271228322e-01,
                2.972144582047751005e-01,
                2.988922233818725460e-01,
                3.005345885801075090e-01,
                3.021411140986025590e-01,
                3.037113698316291632e-01,
                3.052449353837575763e-01,
                3.067414001824063652e-01,
                3.082003635877631487e-01,
                3.096214350000453530e-01,
                3.110042339640731734e-01,
                3.123483902711264859e-01,
                3.136535440580591749e-01,
                3.149193459036426779e-01,
                3.161454569221147093e-01,
                3.173315488539072415e-01,
                3.184773041535292615e-01,
                3.195824160745818765e-01,
                3.206465887518811231e-01,
                3.216695372806687159e-01,
                3.226509877928876446e-01,
                3.235906775305034677e-01,
                3.244883549158509850e-01,
                3.253437796189874165e-01,
                3.261567226220348226e-01,
                3.269269662804936694e-01,
                3.276543043815113854e-01,
                3.283385421990906994e-01,
                3.289794965462222720e-01,
                3.295769958239286868e-01,
                3.301308800672050903e-01,
                3.306410009878462675e-01,
                3.311072220141465516e-01,
                3.315294183274635209e-01,
                3.319074768956351007e-01,
                3.322412965032407461e-01,
                3.325307877786994881e-01,
                3.327758732181967383e-01,
                3.329764872064339687e-01,
                3.331325760341954378e-01,
                3.332440979127276326e-01,
                3.333110229849269857e-01,
                3.333333333333333703e-01,
                3.333110229849269857e-01,
                3.332440979127276326e-01,
                3.331325760341954378e-01,
                3.329764872064339687e-01,
                3.327758732181967383e-01,
                3.325307877786994881e-01,
                3.322412965032407461e-01,
                3.319074768956351007e-01,
                3.315294183274635209e-01,
                3.311072220141465516e-01,
                3.306410009878462675e-01,
                3.301308800672050903e-01,
                3.295769958239286868e-01,
                3.289794965462222720e-01,
                3.283385421990906994e-01,
                3.276543043815113854e-01,
                3.269269662804936694e-01,
                3.261567226220348226e-01,
                3.253437796189874165e-01,
                3.244883549158509850e-01,
                3.235906775305034677e-01,
                3.226509877928876446e-01,
                3.216695372806687159e-01,
                3.206465887518811231e-01,
                3.195824160745818765e-01,
                3.184773041535292615e-01,
                3.173315488539072415e-01,
                3.161454569221147093e-01,
                3.149193459036426779e-01,
                3.136535440580591749e-01,
                3.123483902711264859e-01,
                3.110042339640731734e-01,
                3.096214350000453530e-01,
                3.082003635877631487e-01,
                3.067414001824063652e-01,
                3.052449353837575763e-01,
                3.037113698316291632e-01,
                3.021411140986025590e-01,
                3.005345885801075090e-01,
                2.988922233818725460e-01,
                2.972144582047751005e-01,
                2.955017422271228322e-01,
                2.937545339843980474e-01,
                2.919733012464962307e-01,
                2.901585208924932213e-01,
                2.883106787829726181e-01,
                2.864302696299497186e-01,
                2.845177968644246325e-01,
                2.825737725016019830e-01,
                2.805987170038118927e-01,
                2.785931591411697217e-01,
                2.765576358500114740e-01,
                2.744926920891429534e-01,
                2.723988806939409146e-01,
                2.702767622283462901e-01,
                2.681269048347867945e-01,
                2.659498840820722076e-01,
                2.637462828113003588e-01,
                2.615166909798163908e-01,
                2.592617055032670481e-01,
                2.569819300957919550e-01,
                2.546779751083946830e-01,
                2.523504573655369621e-01,
                2.500000000000000000e-01,
                2.476272322860567088e-01,
                2.452327894709996070e-01,
                2.428173126050701125e-01,
                2.403814483698335502e-01,
                2.379258489050470327e-01,
                2.354511716340658145e-01,
                2.329580790878351682e-01,
                2.304472387275149914e-01,
                2.279193227657839438e-01,
                2.253750079868722667e-01,
                2.228149755653700270e-01,
                2.202399108838602737e-01,
                2.176505033494256225e-01,
                2.150474462090770367e-01,
                2.124314363641554293e-01,
                2.098031741837534658e-01,
                2.071633633172106914e-01,
                2.045127105057288897e-01,
                2.018519253931608526e-01,
                1.991817203360214117e-01,
                1.965028102127721055e-01,
                1.938159122324314976e-01,
                1.911217457425603006e-01,
                1.884210320366752900e-01,
                1.857144941611411082e-01,
                1.830028567215934432e-01,
                1.802868456889447080e-01,
                1.775671882050238459e-01,
                1.748446123879030256e-01,
                1.721198471369627114e-01,
                1.693936219377478181e-01,
                1.666666666666666852e-01,
                1.639397113955855523e-01,
                1.612134861963706589e-01,
                1.584887209454303447e-01,
                1.557661451283094967e-01,
                1.530464876443886624e-01,
                1.503304766117398994e-01,
                1.476188391721922899e-01,
                1.449123012966580804e-01,
                1.422115875907730420e-01,
                1.395174211009019005e-01,
                1.368305231205612094e-01,
                1.341516129973119864e-01,
                1.314814079401724622e-01,
                1.288206228276044807e-01,
                1.261699700161227067e-01,
                1.235301591495798768e-01,
                1.209018969691779549e-01,
                1.182858871242562782e-01,
                1.156828299839077756e-01,
                1.130934224494730689e-01,
                1.105183577679633017e-01,
                1.079583253464610898e-01,
                1.054140105675494127e-01,
                1.028860946058183790e-01,
                1.003752542454981744e-01,
                9.788216169926756971e-02,
                9.540748442828628217e-02,
                9.295188496349982010e-02,
                9.051602072826323009e-02,
                8.810054386233372170e-02,
                8.570610104727664769e-02,
                8.333333333333338422e-02,
                8.098287596779640829e-02,
                7.865535822493867346e-02,
                7.635140323754138758e-02,
                7.407162783006628060e-02,
                7.181664235351700731e-02,
                6.958705052203299768e-02,
                6.738344925126110718e-02,
                6.520642849854656198e-02,
                6.305657110498708029e-02,
                6.093445263939244183e-02,
                5.884064124419045860e-02,
                5.677569748332186167e-02,
                5.474017419216359315e-02,
                5.273461632952144290e-02,
                5.075956083173142896e-02,
                4.881553646890875869e-02,
                4.690306370338365172e-02,
                4.502265455036071756e-02,
                4.317481244084012820e-02,
                4.136003208683711879e-02,
                3.957879934893532292e-02,
                3.783159110621050342e-02,
                3.611887512855827681e-02,
                3.444110995146078963e-02,
                3.279874475322586830e-02,
                3.119221923473081137e-02,
                2.962196350170415160e-02,
                2.808839794957577671e-02,
                2.659193315092702598e-02,
                2.513296974557020433e-02,
                2.371189833328799998e-02,
                2.232909936926021424e-02,
                2.098494306220684627e-02,
                1.967978927527417807e-02,
                1.841398742969067512e-02,
                1.718787641121862289e-02,
                1.600178447942611146e-02,
                1.485602917980401692e-02,
                1.375091725875145915e-02,
                1.268674458145221257e-02,
                1.166379605266465620e-02,
                1.068234554044570836e-02,
                9.742655802829866193e-03,
                8.844978417482404418e-03,
                7.989553714345953850e-03,
                7.176610711298529559e-03,
                6.406367052839663685e-03,
                5.679028951821947675e-03,
                4.994791134242671828e-03,
                4.353836787111061910e-03,
                3.756337509404683583e-03,
                3.202453266128261426e-03,
                2.692332345487084659e-03,
                2.226111319186837353e-03,
                1.803915005869831216e-03,
                1.425856437698269858e-03,
                1.092036830092605769e-03,
                8.025455546338636790e-04,
                5.574601151366136414e-04,
                3.568461268994201356e-04,
                2.007572991379324989e-04,
                8.923542060571924828e-05,
                2.231034840636618094e-05,
                0.000000000000000000e+00,

            ];

            foreach ((CosineDistribution dist, ddouble[] expecteds) in new[]{
                (dist1, expected_dist1), (dist2, expected_dist2)
            }) {
                for ((ddouble x, int i) = (-4, 0); i < expecteds.Length; x += 1d / 64, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.PDF(x);

                    Console.WriteLine($"{dist} pdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} pdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }

        [TestMethod()]
        public void CDFExpectedTest() {
            ddouble[] expected_dist1 = [
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                3.137084768132273315e-06,
                2.508760881846333439e-05,
                8.461968821009824141e-05,
                2.004109017435708325e-04,
                3.910032950375457285e-04,
                6.747587111168374188e-04,
                1.069814555124257421e-03,
                1.594040099722960702e-03,
                2.264993436453465250e-03,
                3.099879176753186135e-03,
                4.115507004540571931e-03,
                5.328251180214186450e-03,
                6.754011093625145699e-03,
                8.408172961054415084e-03,
                1.030557275847008951e-02,
                1.246046048036174303e-02,
                1.488646581025567482e-02,
                1.759656528561339556e-02,
                2.060305103621622863e-02,
                2.391750117134815862e-02,
                2.755075188711622949e-02,
                3.151287136110518527e-02,
                3.581313549725571865e-02,
                4.046000557939931352e-02,
                4.546110788728455893e-02,
                5.082321532420112226e-02,
                5.655223110046245227e-02,
                6.265317451205526522e-02,
                6.913016884871567291e-02,
                7.598643146056312248e-02,
                8.322426600722215850e-02,
                9.084505690810468215e-02,
                9.884926600722215850e-02,
                1.072364314605631086e-01,
                1.160051688487155896e-01,
                1.251531745120552652e-01,
                1.346772311004624245e-01,
                1.445732153242010876e-01,
                1.548361078872845242e-01,
                1.654600055793993274e-01,
                1.764381354972557325e-01,
                1.877628713611051992e-01,
                1.994257518871161983e-01,
                2.114175011713481656e-01,
                2.237280510362162356e-01,
                2.363465652856133747e-01,
                2.492614658102556557e-01,
                2.624604604803617569e-01,
                2.759305727584701051e-01,
                2.896581729610543943e-01,
                3.036290110936251674e-01,
                3.178282511802141830e-01,
                3.322405070045406084e-01,
                3.468498791767531952e-01,
                3.616399934364534774e-01,
                3.765940400997229709e-01,
                3.916948145551242266e-01,
                4.069247587111168296e-01,
                4.222660032950375508e-01,
                4.377004109017435529e-01,
                4.532096196882101080e-01,
                4.687750876088184748e-01,
                4.843781370847681234e-01,
                5.000000000000000000e-01,
                5.156218629152318211e-01,
                5.312249123911815252e-01,
                5.467903803117899475e-01,
                5.622995890982563916e-01,
                5.777339967049623937e-01,
                5.930752412888831149e-01,
                6.083051854448757734e-01,
                6.234059599002770291e-01,
                6.383600065635465226e-01,
                6.531501208232468603e-01,
                6.677594929954593361e-01,
                6.821717488197858170e-01,
                6.963709889063748326e-01,
                7.103418270389456612e-01,
                7.240694272415298949e-01,
                7.375395395196382431e-01,
                7.507385341897443443e-01,
                7.636534347143866253e-01,
                7.762719489637837089e-01,
                7.885824988286518344e-01,
                8.005742481128838017e-01,
                8.122371286388947453e-01,
                8.235618645027442675e-01,
                8.345399944206006726e-01,
                8.451638921127154758e-01,
                8.554267846757989124e-01,
                8.653227688995375200e-01,
                8.748468254879446793e-01,
                8.839948311512844104e-01,
                8.927635685394368359e-01,
                9.011507339927777860e-01,
                9.091549430918952623e-01,
                9.167757339927778970e-01,
                9.240135685394368359e-01,
                9.308698311512844104e-01,
                9.373468254879447903e-01,
                9.434477688995375200e-01,
                9.491767846757989124e-01,
                9.545388921127154758e-01,
                9.595399944206006726e-01,
                9.641868645027442675e-01,
                9.684871286388948564e-01,
                9.724492481128838017e-01,
                9.760824988286518344e-01,
                9.793969489637837089e-01,
                9.824034347143866253e-01,
                9.851135341897443443e-01,
                9.875395395196382431e-01,
                9.896944272415298949e-01,
                9.915918270389455502e-01,
                9.932459889063748326e-01,
                9.946717488197858170e-01,
                9.958844929954595582e-01,
                9.969001208232468603e-01,
                9.977350065635466336e-01,
                9.984059599002770291e-01,
                9.989301854448757734e-01,
                9.993252412888832259e-01,
                9.996089967049623937e-01,
                9.997995890982565026e-01,
                9.999153803117899475e-01,
                9.999749123911816362e-01,
                9.999968629152318211e-01,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
                1.000000000000000000e+00,
            ];
            ddouble[] expected_dist2 = [
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                0.000000000000000000e+00,
                1.162007682988270049e-07,
                9.295688145411710615e-07,
                3.137084768132187765e-06,
                7.435356011370481820e-06,
                1.452043018080733392e-05,
                2.508760881846333439e-05,
                3.983126122279214126e-05,
                5.944463854923050223e-05,
                8.461968821009824141e-05,
                1.160468686235454261e-04,
                1.544149643611364810e-04,
                2.004109017435694773e-04,
                2.547195649338831330e-04,
                3.180236125774092769e-04,
                3.910032950375457285e-04,
                4.743362722762816059e-04,
                5.686974324282491940e-04,
                6.747587111168374188e-04,
                7.931889115607857399e-04,
                9.246535255193880955e-04,
                1.069814555124253518e-03,
                1.229330335645342298e-03,
                1.403855359238673174e-03,
                1.594040099722960702e-03,
                1.800530838432043684e-03,
                2.023969491189734748e-03,
                2.264993436453458311e-03,
                2.524235344672593091e-03,
                2.802323008907308712e-03,
                3.099879176753186135e-03,
                3.417521383616613923e-03,
                3.755861787385664143e-03,
                4.115507004540571931e-03,
                4.497057947747865915e-03,
                4.901109664981513278e-03,
                5.328251180214173439e-03,
                5.779065335721283135e-03,
                6.254128636040023025e-03,
                6.754011093625145699e-03,
                7.279276076242845693e-03,
                7.830480156143635254e-03,
                8.408172961054415084e-03,
                9.012897027029887626e-03,
                9.645187653202534975e-03,
                1.030557275847007043e-02,
                1.099457274015885715e-02,
                1.171270033470085507e-02,
                1.246046048036174303e-02,
                1.323835018205674584e-02,
                1.404685837829033369e-02,
                1.488646581025567482e-02,
                1.575764489312847863e-02,
                1.666085958959007129e-02,
                1.759656528561339556e-02,
                1.856520866854511481e-02,
                1.956722760751672049e-02,
                2.060305103621622863e-02,
                2.167309883805235843e-02,
                2.277778173374155751e-02,
                2.391750117134812739e-02,
                2.509264921880695332e-02,
                2.630360845895730881e-02,
                2.755075188711622949e-02,
                2.883444281121868430e-02,
                3.015503475455117571e-02,
                3.151287136110518527e-02,
                3.290828630357510443e-02,
                3.434160319402619621e-02,
                3.581313549725567702e-02,
                3.732318644687084019e-02,
                3.887204896410569738e-02,
                4.046000557939931352e-02,
                4.208732835675522976e-02,
                4.375427882090360959e-02,
                4.546110788728453811e-02,
                4.720805579487206277e-02,
                4.899535204185626047e-02,
                5.082321532420108756e-02,
                5.269185347709429840e-02,
                5.460146341930469799e-02,
                5.655223110046245227e-02,
                5.854433145127571625e-02,
                6.057792833669755489e-02,
                6.265317451205526522e-02,
                6.477021158215413854e-02,
                6.692916996336645274e-02,
                6.913016884871564516e-02,
                7.137331617596581745e-02,
                7.365870859872386545e-02,
                7.598643146056310860e-02,
                7.835655877217474752e-02,
                8.076915319155342221e-02,
                8.322426600722215850e-02,
                8.572193712450104641e-02,
                8.826219505482379990e-02,
                9.084505690810468215e-02,
                9.347052838815717024e-02,
                9.613860379116767607e-02,
                9.884926600722215850e-02,
                1.016024865248867926e-01,
                1.043982254388414188e-01,
                1.072364314605630531e-01,
                1.101170419320571803e-01,
                1.130399828426324471e-01,
                1.160051688487155896e-01,
                1.190125032966997676e-01,
                1.220618782488207543e-01,
                1.251531745120552652e-01,
                1.282862616700308211e-01,
                1.314609981179423737e-01,
                1.346772311004624245e-01,
                1.379347967526379781e-01,
                1.412335201437609489e-01,
                1.445732153242010321e-01,
                1.479536853751895475e-01,
                1.513747224615387132e-01,
                1.548361078872845242e-01,
                1.583376121542369175e-01,
                1.618789950234219011e-01,
                1.654600055793993274e-01,
                1.690803822974389914e-01,
                1.727398531135374560e-01,
                1.764381354972557325e-01,
                1.801749365273594972e-01,
                1.839499529702418035e-01,
                1.877628713611051436e-01,
                1.916133680878844836e-01,
                1.955011094778853487e-01,
                1.994257518871161983e-01,
                2.033869417922906098e-01,
                2.073843158854736246e-01,
                2.114175011713481656e-01,
                2.154861150670748793e-01,
                2.195897655047189811e-01,
                2.237280510362162356e-01,
                2.279005609408500388e-01,
                2.321068753352117930e-01,
                2.363465652856133747e-01,
                2.406191929229233861e-01,
                2.449243115597951603e-01,
                2.492614658102556557e-01,
                2.536301917116236537e-01,
                2.580300168487233980e-01,
                2.624604604803617569e-01,
                2.669210336680342133e-01,
                2.714112394068255441e-01,
                2.759305727584700496e-01,
                2.804785209865358619e-01,
                2.850545636936965277e-01,
                2.896581729610543943e-01,
                2.942888134894769969e-01,
                2.989459427429095317e-01,
                3.036290110936251674e-01,
                3.083374619693733387e-01,
                3.130707320023879414e-01,
                3.178282511802141830e-01,
                3.226094429983148437e-01,
                3.274137246144145363e-01,
                3.322405070045405528e-01,
                3.370891951207189985e-01,
                3.419591880502832471e-01,
                3.468498791767531952e-01,
                3.517606563422406296e-01,
                3.566909020113392392e-01,
                3.616399934364534774e-01,
                3.666073028245230292e-01,
                3.715921975050986981e-01,
                3.765940400997229709e-01,
                3.816121886925720186e-01,
                3.866459970023120030e-01,
                3.916948145551242266e-01,
                3.967579868588527181e-01,
                4.018348555782274567e-01,
                4.069247587111168296e-01,
                4.120270307657615816e-01,
                4.171410029389429619e-01,
                4.222660032950375508e-01,
                4.274013569459107487e-01,
                4.325463862316005770e-01,
                4.377004109017435529e-01,
                4.428627482976944529e-01,
                4.480327135352902279e-01,
                4.532096196882101080e-01,
                4.583927779718825479e-01,
                4.635814979278894410e-01,
                4.687750876088184748e-01,
                4.739728537635141681e-01,
                4.791741020226780168e-01,
                4.843781370847681234e-01,
                4.895842629021478487e-01,
                4.947917828674349705e-01,
                5.000000000000000000e-01,
                5.052082171325650295e-01,
                5.104157370978521513e-01,
                5.156218629152318211e-01,
                5.208258979773219277e-01,
                5.260271462364858319e-01,
                5.312249123911815252e-01,
                5.364185020721105035e-01,
                5.416072220281173966e-01,
                5.467903803117899475e-01,
                5.519672864647098276e-01,
                5.571372517023055471e-01,
                5.622995890982563916e-01,
                5.674536137683994230e-01,
                5.725986430540892513e-01,
                5.777339967049623937e-01,
                5.828589970610570381e-01,
                5.879729692342384739e-01,
                5.930752412888831149e-01,
                5.981651444217725988e-01,
                6.032420131411473374e-01,
                6.083051854448757734e-01,
                6.133540029976880525e-01,
                6.183878113074279259e-01,
                6.234059599002770291e-01,
                6.284078024949013574e-01,
                6.333926971754769708e-01,
                6.383600065635465226e-01,
                6.433090979886607608e-01,
                6.482393436577593704e-01,
                6.531501208232468603e-01,
                6.580408119497167529e-01,
                6.629108048792810015e-01,
                6.677594929954594472e-01,
                6.725862753855854637e-01,
                6.773905570016851563e-01,
                6.821717488197858170e-01,
                6.869292679976120031e-01,
                6.916625380306267168e-01,
                6.963709889063748326e-01,
                7.010540572570904683e-01,
                7.057111865105230031e-01,
                7.103418270389456612e-01,
                7.149454363063034723e-01,
                7.195214790134640825e-01,
                7.240694272415300059e-01,
                7.285887605931744559e-01,
                7.330789663319657867e-01,
                7.375395395196382431e-01,
                7.419699831512766020e-01,
                7.463698082883762908e-01,
                7.507385341897443443e-01,
                7.550756884402047842e-01,
                7.593808070770766694e-01,
                7.636534347143866253e-01,
                7.678931246647882070e-01,
                7.720994390591500167e-01,
                7.762719489637837089e-01,
                7.804102344952810189e-01,
                7.845138849329251762e-01,
                7.885824988286518344e-01,
                7.926156841145264309e-01,
                7.966130582077093347e-01,
                8.005742481128838017e-01,
                8.044988905221146513e-01,
                8.083866319121155719e-01,
                8.122371286388948564e-01,
                8.160500470297582520e-01,
                8.198250634726405028e-01,
                8.235618645027442675e-01,
                8.272601468864625440e-01,
                8.309196177025610641e-01,
                8.345399944206006726e-01,
                8.381210049765781545e-01,
                8.416623878457630825e-01,
                8.451638921127154758e-01,
                8.486252775384612868e-01,
                8.520463146248105080e-01,
                8.554267846757990235e-01,
                8.587664798562391066e-01,
                8.620652032473620219e-01,
                8.653227688995375200e-01,
                8.685390018820575708e-01,
                8.717137383299691233e-01,
                8.748468254879446793e-01,
                8.779381217511792457e-01,
                8.809874967033002324e-01,
                8.839948311512844104e-01,
                8.869600171573674974e-01,
                8.898829580679428197e-01,
                8.927635685394369469e-01,
                8.956017745611586367e-01,
                8.983975134751132074e-01,
                9.011507339927777860e-01,
                9.038613962088323239e-01,
                9.065294716118428298e-01,
                9.091549430918952623e-01,
                9.117378049451762001e-01,
                9.142780628754989536e-01,
                9.167757339927778970e-01,
                9.192308468084465778e-01,
                9.216434412278251553e-01,
                9.240135685394368359e-01,
                9.263412914012761901e-01,
                9.286266838240342381e-01,
                9.308698311512844104e-01,
                9.330708300366336028e-01,
                9.352297884178458753e-01,
                9.373468254879447903e-01,
                9.394220716633024937e-01,
                9.414556685487243115e-01,
                9.434477688995375200e-01,
                9.453985365806953922e-01,
                9.473081465229058473e-01,
                9.491767846757989124e-01,
                9.510046479581437673e-01,
                9.527919442051280274e-01,
                9.545388921127154758e-01,
                9.562457211790964529e-01,
                9.579126716432447841e-01,
                9.595399944206006726e-01,
                9.611279510358943234e-01,
                9.626768135531291737e-01,
                9.641868645027442675e-01,
                9.656583968059737622e-01,
                9.670917136964249927e-01,
                9.684871286388948564e-01,
                9.698449652454488312e-01,
                9.711655571887813920e-01,
                9.724492481128838017e-01,
                9.736963915410428161e-01,
                9.749073507811930606e-01,
                9.760824988286519455e-01,
                9.772222182662584355e-01,
                9.783269011619476485e-01,
                9.793969489637837089e-01,
                9.804327723924832760e-01,
                9.814347913314549476e-01,
                9.824034347143866253e-01,
                9.833391404104099287e-01,
                9.842423551068715248e-01,
                9.851135341897443443e-01,
                9.859531416217096611e-01,
                9.867616498179432316e-01,
                9.875395395196382431e-01,
                9.882872996652991571e-01,
                9.890054272598411966e-01,
                9.896944272415298949e-01,
                9.903548123467974529e-01,
                9.909871029729702130e-01,
                9.915918270389455502e-01,
                9.921695198438562624e-01,
                9.927207239237572090e-01,
                9.932459889063748326e-01,
                9.937458713639599761e-01,
                9.942209346642787438e-01,
                9.946717488197858170e-01,
                9.950988903350185266e-01,
                9.955029420522520933e-01,
                9.958844929954595582e-01,
                9.962441382126143719e-01,
                9.965824786163833826e-01,
                9.969001208232468603e-01,
                9.971976769910926297e-01,
                9.974757646553273904e-01,
                9.977350065635466336e-01,
                9.979760305088103411e-01,
                9.981994691615679871e-01,
                9.984059599002770291e-01,
                9.985961446407614073e-01,
                9.987706696643546822e-01,
                9.989301854448757734e-01,
                9.990753464744805967e-01,
                9.992068110884392285e-01,
                9.993252412888832259e-01,
                9.994313025675717332e-01,
                9.995256637277237788e-01,
                9.996089967049623937e-01,
                9.996819763874226217e-01,
                9.997452804350661637e-01,
                9.997995890982565026e-01,
                9.998455850356389174e-01,
                9.998839531313765683e-01,
                9.999153803117899475e-01,
                9.999405553614507669e-01,
                9.999601687387772442e-01,
                9.999749123911816362e-01,
                9.999854795698192023e-01,
                9.999925646439886684e-01,
                9.999968629152318211e-01,
                9.999990704311854106e-01,
                9.999998837992316592e-01,
                1.000000000000000000e+00,
            ];

            foreach ((CosineDistribution dist, ddouble[] expecteds) in new[]{
                (dist1, expected_dist1), (dist2, expected_dist2)
            }) {
                for ((ddouble x, int i) = (-4, 0); i < expecteds.Length; x += 1d / 64, i++) {
                    ddouble expected = expecteds[i];
                    ddouble actual = dist.CDF(x);

                    Console.WriteLine($"{dist} cdf({x})");
                    Console.WriteLine(expected);
                    Console.WriteLine(actual);

                    if (expected > 0) {
                        Assert.IsTrue(ddouble.Abs(expected - actual) / expected < 1e-10, $"{dist} cdf({x})\n{expected}\n{actual}");
                    }
                    else {
                        Assert.AreEqual(0, actual);
                    }
                }
            }
        }
    }
}